"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[1130],{1130:(xt,E,r)=>{r.r(E),r.d(E,{TareasModule:()=>bt});var m=r(177),h=r(9417),D=r(7852),v=r(9664),M=r(7741),b=r(1141),$=r(612),V=r(4799),R=r(7835),U=r(6781),G=r(8150),p=r(2100),k=r(1142),B=r(320),u=r(2242),w=r(1305),O=r(6296),f=r(5473),A=r(1579),Y=r(4714),z=r(563),J=r(9266),x=r(9280),N=r(9998),L=r(3973),Z=r(8542),d=r(8763),H=r(5558),C=r(9437),T=r(7673),W=r(8032),F=r.n(W),S=r(8141),Q=r(3718),K=r.n(Q),X=r(4731),t=r(7019),g=r(5779),I=r(3088);const q=["ckeditor"];function tt(i,s){1&i&&(t.j41(0,"span",2),t.EFF(1,"Registrar Tarea"),t.k0s())}function et(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",27),t.nrm(1,"img",28),t.j41(2,"button",29),t.bIt("click",function(){const a=t.eBV(e).index,l=t.XpG(2);return t.Njj(l.removeImage(a))}),t.EFF(3,"X"),t.k0s()()}if(2&i){const e=s.$implicit,o=s.index;t.R7$(1),t.Mz_("alt","Preview ",o+1,""),t.Y8G("src",e,t.B4B)}}const ot=function(){return["PENDIENTE","EN PROCESO","OBSERVADO","REVISI\xd3N","RETRASADO","APROBADO"]},it=function(){return{height:"90px"}};function rt(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-dropdown",6),t.bIt("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.estado=n)}),t.k0s(),t.j41(4,"small",7),t.EFF(5,"Campo obligatorio *"),t.k0s()(),t.j41(6,"div",5)(7,"span",8),t.nrm(8,"i",9),t.j41(9,"input",10),t.bIt("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.grupo=n)}),t.k0s(),t.j41(10,"label",11),t.EFF(11,"Grupo"),t.k0s()(),t.j41(12,"small",7),t.EFF(13,"Campo obligatorio *"),t.k0s()(),t.j41(14,"div",5)(15,"span",8),t.nrm(16,"i",9),t.j41(17,"input",12),t.bIt("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.responsable=n)}),t.k0s(),t.j41(18,"label",13),t.EFF(19,"Responsable"),t.k0s()(),t.j41(20,"small",7),t.EFF(21,"Campo obligatorio *"),t.k0s()(),t.j41(22,"div",5)(23,"span",8),t.nrm(24,"i",9),t.j41(25,"input",14),t.bIt("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.prioridad=n)}),t.k0s(),t.j41(26,"label",15),t.EFF(27,"Prioridad"),t.k0s()(),t.j41(28,"small",7),t.EFF(29,"Campo obligatorio *"),t.k0s()(),t.j41(30,"div",16)(31,"label",17),t.EFF(32,"Descripci\xf3n"),t.k0s(),t.j41(33,"p-editor",18),t.bIt("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.descripcion=n)}),t.k0s()(),t.j41(34,"div",16)(35,"div",19)(36,"label",20),t.EFF(37,"A\xf1adir Imagen"),t.k0s(),t.j41(38,"input",21),t.bIt("change",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.onFileSelected(n))}),t.k0s(),t.j41(39,"div",22),t.DNE(40,et,4,2,"div",23),t.k0s()()()()(),t.j41(41,"div",24)(42,"button",25),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.Guardaruser())}),t.k0s(),t.j41(43,"button",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeModal())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(3),t.Y8G("options",t.lJ4(9,ot))("ngModel",e.estado),t.R7$(6),t.Y8G("ngModel",e.grupo),t.R7$(8),t.Y8G("ngModel",e.responsable),t.R7$(8),t.Y8G("ngModel",e.prioridad),t.R7$(8),t.Aen(t.lJ4(10,it)),t.Y8G("ngModel",e.descripcion),t.R7$(7),t.Y8G("ngForOf",e.previewImages)}}let P=(()=>{class i{constructor(e,o,n,a,l,y){this.router=e,this.primengConfig=o,this.translate=n,this.ref=a,this.empresaService=l,this.config=y,this.visible=!1,this.id=0,this.estado="",this.nombre="",this.grupo="",this.responsable="",this.prioridad="",this.descripcion="",this.proyectoId=0,this.moduloId=0,this.previewImages=[],this.base64Files=[],this.Editor=K(),this.settings={counter:!1,plugins:[X.A]},this.onBeforeSlide=c=>{const{index:_,prevIndex:j}=c;console.log(_,j)},console.log("this.base64Files",this.base64Files),this.config.data.tarea?(this.id=this.config.data.tarea.id,this.estado=this.config.data.tarea.estado,this.nombre=this.config.data.tarea.nombre,this.grupo=this.config.data.tarea.grupo,this.responsable=this.config.data.tarea.responsable,this.prioridad=this.config.data.tarea.prioridad,this.descripcion=this.config.data.tarea.descripcion,this.proyectoId=this.config.data.proyectoId,this.base64Files=this.config.data.tarea.archivos?.map(c=>c.contenido),this.moduloId=this.config.data.moduloId,console.log("this.base64Files1",this.config.data.tarea),this.previewImages=[...this.base64Files],console.log("this.base64Files1",this.base64Files)):(this.id=0,this.estado="",this.nombre="",this.grupo="",this.responsable="",this.prioridad="",this.descripcion="",this.proyectoId=this.config.data.proyectoId,this.moduloId=this.config.data.moduloId,this.base64Files=[],console.log("this.base64Files2",this.base64Files))}onFileSelected(e){const o=e.target;o.files&&Array.from(o.files).forEach(n=>{const a=new FileReader;a.onload=()=>{const l=a.result;this.previewImages.push(l),this.base64Files.push(l)},a.readAsDataURL(n)})}removeImage(e){this.previewImages.splice(e,1),this.base64Files.splice(e,1)}Guardaruser(){const e={id:this.id,estado:this.estado,nombre:this.nombre,grupo:this.grupo,responsable:this.responsable,prioridad:this.prioridad,descripcion:this.descripcion,archivos:this.base64Files};this.id>0?this.empresaService.actualizarTarea(e,this.proyectoId,this.moduloId,this.id).pipe((0,S.M)(o=>{this.closeModal(),F().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})}),(0,C.W)(o=>(console.error("Error al guardar la oferta laboral",o),(0,T.of)(o)))).subscribe():(this.empresaService.guardarTarea(e,this.proyectoId,this.moduloId).pipe((0,S.M)(o=>{this.closeModal(),F().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})}),(0,C.W)(o=>(console.error("Error al guardar la oferta laboral",o),(0,T.of)(o)))).subscribe(),F().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{}))}closeDialog(){this.visible=!1}closeModal(){this.ref.close({register:!1})}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(d.Ix),t.rXU(g.r1),t.rXU(v.c$),t.rXU(p.Pw),t.rXU(I.O),t.rXU(p.sb))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-registrar-tarea"]],viewQuery:function(o,n){if(1&o&&t.GBs(q,5),2&o){let a;t.mGM(a=t.lsd())&&(n.ckeditor=a.first)}},decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-6"],["placeholder","Seleccione un Estado",3,"options","ngModel","ngModelChange"],[2,"color","brown"],[1,"p-float-label","p-input-icon-left"],[1,"pi","pi-user-edit"],["type","text","id","grupo","pInputText","",3,"ngModel","ngModelChange"],["for","grupo"],["type","text","id","responsable","pInputText","",3,"ngModel","ngModelChange"],["for","responsable"],["type","text","id","prioridad","pInputText","",3,"ngModel","ngModelChange"],["for","prioridad"],[1,"md:col-12"],["for",""],[3,"ngModel","ngModelChange"],[1,"image-uploader"],["for","img-selector",1,"p-button-primary","mr-2","p-button","img-selector"],["hidden","","id","img-selector","type","file","multiple","","accept","image/*",3,"change"],[1,"previews"],["class","preview",4,"ngFor","ngForOf"],[1,"row","mb-5","text-right"],["pButton","","label","Guardar","icon","pi pi-plus","id","btnGuardar",1,"p-button-success","mr-2",3,"click"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],[1,"preview"],[3,"src","alt"],[1,"remove-btn",3,"click"]],template:function(o,n){1&o&&(t.j41(0,"p-panel"),t.DNE(1,tt,2,0,"ng-template",0),t.DNE(2,rt,44,11,"ng-template",1),t.k0s())},dependencies:[m.Sq,f.Z,g.Ei,h.me,h.BC,h.vS,b._f,u.S,G.ms,k.KE],styles:['@import"https://cdn.jsdelivr.net/npm/lightgallery@2.0.0-beta.4/css/lightgallery.css";@import"https://cdn.jsdelivr.net/npm/lightgallery@2.0.0-beta.4/css/lg-zoom.css";.image-uploader[_ngcontent-%COMP%]{display:flex;flex-direction:column}.previews[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.preview[_ngcontent-%COMP%]{position:relative}.preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px;object-fit:cover;border:1px solid #ccc;padding:5px;border-radius:5px}.remove-btn[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;background-color:#ff0000b3;color:#fff;border:none;border-radius:50%;cursor:pointer;padding:2px 5px;font-size:12px}.remove-btn[_ngcontent-%COMP%]:hover{background-color:#ff0000e6}.img-selector[_ngcontent-%COMP%]{max-width:200px;justify-content:center}']})}return i})();function nt(i,s){1&i&&(t.j41(0,"span",2),t.EFF(1,"Imagenes"),t.k0s())}function at(i,s){if(1&i&&(t.j41(0,"a",9),t.nrm(1,"img",10),t.k0s()),2&i){const e=s.$implicit;t.BMQ("href",e,t.B4B),t.R7$(1),t.Y8G("src",e,t.B4B)}}function st(i,s){if(1&i&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"lightgallery",7),t.DNE(5,at,2,2,"a",8),t.k0s()()()()()),2&i){const e=t.XpG();t.R7$(4),t.Y8G("settings",e.settings)("onBeforeSlide",e.onBeforeSlide),t.R7$(1),t.Y8G("ngForOf",e.previewImages)}}let lt=(()=>{class i{constructor(e,o,n,a,l,y){this.router=e,this.primengConfig=o,this.translate=n,this.ref=a,this.empresaService=l,this.config=y,this.previewImages=[],this.settings={counter:!1,plugins:[X.A]},this.onBeforeSlide=c=>{const{index:_,prevIndex:j}=c;console.log(_,j)},this.config.data.tarea&&(this.previewImages=this.config.data.tarea.archivos?.map(c=>c.contenido))}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(d.Ix),t.rXU(g.r1),t.rXU(v.c$),t.rXU(p.Pw),t.rXU(I.O),t.rXU(p.sb))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-galeria"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"md:col-12"],[1,"image-uploader"],[3,"settings","onBeforeSlide"],["class","gallery-item",4,"ngFor","ngForOf"],[1,"gallery-item"],[1,"img-responsive",3,"src"]],template:function(o,n){1&o&&(t.j41(0,"p-panel"),t.DNE(1,nt,2,0,"ng-template",0),t.DNE(2,st,6,3,"ng-template",1),t.k0s())},dependencies:[m.Sq,f.Z,g.Ei,M.Sv],styles:['@import"https://cdn.jsdelivr.net/npm/lightgallery@2.0.0-beta.4/css/lightgallery.css";@import"https://cdn.jsdelivr.net/npm/lightgallery@2.0.0-beta.4/css/lg-zoom.css";.image-uploader[_ngcontent-%COMP%]   lightgallery[_ngcontent-%COMP%]{display:flex;gap:20px;flex-wrap:wrap}.image-uploader[_ngcontent-%COMP%]   lightgallery[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{height:200px;display:inline-flex;border:solid 1px #d2d2d2}']})}return i})();function ct(i,s){1&i&&(t.j41(0,"span",2),t.EFF(1,"Tareas"),t.k0s())}function pt(i,s){if(1&i){const e=t.RV6();t.j41(0,"div",9)(1,"div",10)(2,"span",11),t.nrm(3,"input",12),t.k0s()(),t.j41(4,"div",13)(5,"button",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.navigateToNuevo(0))}),t.k0s()()()}}function dt(i,s){1&i&&(t.j41(0,"tr")(1,"th",15),t.EFF(2,"Acciones"),t.k0s(),t.j41(3,"th",16),t.EFF(4,"ID"),t.k0s(),t.j41(5,"th",15),t.EFF(6,"Descripci\xf3n"),t.k0s(),t.j41(7,"th",16),t.EFF(8,"OP"),t.k0s(),t.j41(9,"th",16),t.EFF(10,"IM"),t.k0s(),t.j41(11,"th",17),t.EFF(12,"Estado"),t.k0s(),t.j41(13,"th",17),t.EFF(14,"Grupo"),t.k0s(),t.j41(15,"th",15),t.EFF(16,"Responsable"),t.k0s()())}const gt=function(){return{color:"var(--primary-color)","font-size":"1.5rem"}},mt=function(i,s,e,o,n,a){return{"estado-pendiente":i,"estado-en-proceso":s,"estado-observado":e,"estado-revision":o,"estado-retrasado":n,"estado-aprobado":a}};function ht(i,s){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td",18)(2,"button",19),t.bIt("click",function(){const a=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.navigateToNuevo(a.id))}),t.nrm(3,"i",20),t.k0s(),t.j41(4,"button",21),t.bIt("click",function(){const a=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.eliminar(a.id))}),t.EFF(5,"X "),t.k0s()(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.nrm(8,"td",22),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td")(12,"button",23),t.bIt("click",function(){const a=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.navigateToGaleria(a.id))}),t.EFF(13,"IM"),t.k0s()(),t.j41(14,"td")(15,"a",24),t.EFF(16),t.k0s()(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.k0s()()}if(2&i){const e=s.$implicit;t.R7$(3),t.Aen(t.lJ4(9,gt)),t.R7$(4),t.JRh(e.id),t.R7$(1),t.Y8G("innerHTML",e.descripcion,t.npT),t.R7$(2),t.JRh(e.prioridad),t.R7$(5),t.Y8G("ngClass",t.l4e(10,mt,"PENDIENTE"===e.estado,"EN PROCESO"===e.estado,"OBSERVADO"===e.estado,"REVISI\xd3N"===e.estado,"RETRASADO"===e.estado,"APROBADO"===e.estado)),t.R7$(1),t.JRh(e.estado),t.R7$(2),t.JRh(e.grupo),t.R7$(2),t.JRh(e.responsable)}}function ut(i,s){if(1&i&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6),t.DNE(4,pt,6,0,"ng-template",7),t.DNE(5,dt,17,0,"ng-template",0),t.DNE(6,ht,21,17,"ng-template",8),t.k0s()()()()),2&i){const e=t.XpG();t.R7$(3),t.Y8G("value",e.tareas)}}let ft=(()=>{class i{constructor(e,o,n,a){this.router=e,this.dialogService=o,this.proyectosService=n,this.route=a,this.tareas=[],this.proyectoId=null,this.moduloId=null}ngOnInit(){this.getTareas()}getTareas(){this.route.paramMap.subscribe(e=>{this.proyectoId=e.get("proyecto_id"),this.moduloId=e.get("modulo_id"),console.log("Proyecto ID:",this.proyectoId,this.moduloId),this.proyectoId&&this.moduloId&&this.proyectosService.getTareas(this.proyectoId,this.moduloId).subscribe(o=>{console.log("Lista de tareas: ",o),this.tareas=o.data})})}navigateToNuevo(e){e>0?this.proyectosService.getTarea(Number(this.proyectoId),Number(this.moduloId),e).subscribe(o=>{this.tarea=o.data,this.ref=this.dialogService.open(P,{width:"60%",styleClass:"custom-dialog-header",data:{tarea:this.tarea,proyectoId:this.proyectoId,moduloId:this.moduloId}}),this.ref.onClose.subscribe(n=>{this.getTareas()})}):(this.tarea=void 0,this.ref=this.dialogService.open(P,{width:"60%",styleClass:"custom-dialog-header",data:{tarea:this.tarea,proyectoId:this.proyectoId,moduloId:this.moduloId}}),this.ref.onClose.subscribe(o=>{this.getTareas()}))}navigateToGaleria(e){this.proyectosService.getTarea(Number(this.proyectoId),Number(this.moduloId),e).subscribe(o=>{this.tarea=o.data,this.ref=this.dialogService.open(lt,{width:"60%",styleClass:"custom-dialog-header",data:{tarea:this.tarea,proyectoId:this.proyectoId}}),this.ref.onClose.subscribe(n=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})})}verTareas(e){}eliminar(e){this.proyectosService.eliminarTarea(Number(this.proyectoId),Number(this.moduloId),e).pipe((0,H.n)(()=>(console.log("Oferta laboral eliminada"),this.proyectosService.getModulos(this.proyectoId))),(0,C.W)(o=>(console.error("Error eliminando oferta laboral:",o),(0,T.of)({data:[]})))).subscribe(o=>{console.log("Lista de ofertas laborales",o),this.getTareas()})}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(d.Ix),t.rXU(p.o3),t.rXU(I.O),t.rXU(d.nX))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-tareas"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-12"],[1,"w-full","custom-search-input",3,"value"],["pTemplate","caption"],["pTemplate","body"],[1,"flex","justify-content-between","flex-wrap","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar Proyecto",1,"w-full"],[1,"mb-2"],["pButton","","label","Nuevo","icon","pi pi-user-plus",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],[2,"min-width","10rem"],[2,"min-width","3rem"],[2,"min-width","5rem"],[1,"text-center","flex","gap-2"],["pButton","","title","Editar rol",1,"p-button-rounded","p-button-text","custom-edit-button",2,"width","fit-content",3,"click"],["aria-hidden","true",1,"pi","pi-user-edit"],["pButton","","title","Eliminar rol",1,"p-button-rounded","p-button-text","custom-edit-button",2,"width","fit-content",3,"click"],[3,"innerHTML"],["pButton","",1,"p-button","p-button-sm","mr-2",3,"click"],["href","",3,"ngClass"]],template:function(o,n){1&o&&(t.j41(0,"p-panel"),t.DNE(1,ct,2,0,"ng-template",0),t.DNE(2,ut,7,1,"ng-template",1),t.k0s())},dependencies:[m.YU,f.Z,g.Ei,b._f,x.XI,u.S],styles:[".p-button-sm[_ngcontent-%COMP%]{margin-right:auto!important;width:auto!important}.estado-pendiente[_ngcontent-%COMP%]{background-color:silver;padding:3px;border-radius:5px;color:#fff}.estado-en-proceso[_ngcontent-%COMP%]{background-color:#00bfff;padding:3px;border-radius:5px;color:#fff}.estado-observado[_ngcontent-%COMP%]{background-color:orange;padding:3px;border-radius:5px;color:#fff}.estado-revision[_ngcontent-%COMP%]{background-color:#ff0;padding:3px;border-radius:5px;color:#fff}.estado-retrasado[_ngcontent-%COMP%]{background-color:red;padding:3px;border-radius:5px;color:#fff}.estado-aprobado[_ngcontent-%COMP%]{background-color:#7cfc00;padding:3px;border-radius:5px;color:#fff}"]})}return i})(),vt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.$C({type:i});static#o=this.\u0275inj=t.G2t({imports:[d.iI.forChild([{path:"",component:ft}]),d.iI]})}return i})(),bt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.$C({type:i});static#o=this.\u0275inj=t.G2t({imports:[m.MD,f.b,h.YN,$.rO,x.bG,Y.wZ,b.tm,J.SW,u.u,w.f,L.d0,z.Z,O.iV,G.kr,A.d,N.MB,R.H,B.e,Z.S,N.MB,x.bG,R.H,V.F,B.e,k.sv,U.P,p.k_,v.h,u.u,O.iV,vt,D.w,M.xz]})}return i})()}}]);