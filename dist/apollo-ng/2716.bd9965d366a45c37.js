"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[2716],{7533:($,A,a)=>{a.d(A,{F:()=>O});var e=a(7019),i=a(2100),t=a(9417),M=a(8774),o=a(7064),y=a(5779),_=a(2242),F=a(5473);function I(R,L){1&R&&(e.j41(0,"span",2),e.EFF(1,"Registrar Foro"),e.k0s())}function w(R,L){if(1&R){const P=e.RV6();e.j41(0,"form",3),e.bIt("ngSubmit",function(){e.eBV(P);const B=e.XpG();return e.Njj(B.saveForo())}),e.j41(1,"div",4)(2,"div",5)(3,"div",6)(4,"span",7),e.nrm(5,"input",8),e.j41(6,"label",9),e.EFF(7,"Titulo"),e.k0s()()(),e.j41(8,"div",6)(9,"span",7),e.nrm(10,"input",10),e.j41(11,"label",9),e.EFF(12,"Descripcion"),e.k0s()()()()(),e.j41(13,"div",4)(14,"div",5)(15,"div",11)(16,"span",7),e.nrm(17,"input",12),e.j41(18,"label",9),e.EFF(19,"Fecha Inicio"),e.k0s()()(),e.j41(20,"div",11)(21,"span",7),e.nrm(22,"input",13),e.j41(23,"label",9),e.EFF(24,"Fecha Fin"),e.k0s()()()()(),e.j41(25,"div",14)(26,"button",15),e.EFF(27,"Guardar"),e.k0s()()()}if(2&R){const P=e.XpG();e.Y8G("formGroup",P.foroForm)}}let O=(()=>{class R{constructor(P,G,B,U,C){this.ref=P,this.fb=G,this.config=B,this.helperService=U,this.foroService=C,this.foroForm=this.fb.group({titulo:[""],descripcion:[""],fechaInicio:[""],fechaFin:[""]})}saveForo(){if(this.foroForm.valid){console.log(this.config.data),this.ref.close(this.foroForm.value);const P={nombre:this.foroForm.get("titulo")?.value,descripcion:this.foroForm.get("descripcion")?.value,fecha_inicio:this.helperService.formatDate(this.foroForm.get("fechaInicio")?.value),fecha_fin:this.helperService.formatDate(this.foroForm.get("fechaFin")?.value),id_curso:this.config.data.data.id,domain_id:this.helperService.getDominioId()};this.foroService.saveForo(P).subscribe(G=>{console.log(G)})}}static#t=this.\u0275fac=function(G){return new(G||R)(e.rXU(i.Pw),e.rXU(t.ok),e.rXU(i.sb),e.rXU(M.V),e.rXU(o.Y))};static#e=this.\u0275cmp=e.VBU({type:R,selectors:[["app-crear-foro-curso"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12","md:col-6"],[1,"p-float-label"],["type","text","pInputText","","formControlName","titulo"],[1,"required"],["type","text","pInputText","","formControlName","descripcion"],[1,"field","col-12","md:6"],["type","date","pInputText","","formControlName","fechaInicio"],["type","date","pInputText","","formControlName","fechaFin"],[1,"grid","grid-cols-1","gap-4"],["type","submit",1,"btn","btn-primary"]],template:function(G,B){1&G&&(e.j41(0,"p-panel"),e.DNE(1,I,2,0,"ng-template",0),e.DNE(2,w,28,1,"ng-template",1),e.k0s())},dependencies:[y.Ei,t.qT,t.me,t.BC,t.cb,_.S,F.Z,t.j4,t.JD]})}return R})()},3157:($,A,a)=>{a.d(A,{p:()=>d});var e=a(9417),i=a(9423),t=a(1710),M=a(5833),o=a(7019),y=a(2100),_=a(3587),F=a(1626);let I=(()=>{class v{constructor(s){this.http=s,this.baseUrl=`${_.c.API_BASE}`,this.urlparametro=`${_.c.API_BASE}`}saveHorario(s){return this.http.post(`${this.baseUrl}horario`,s)}getHorario(s){return this.http.get(`${this.baseUrl}horario/${s}`)}static#t=this.\u0275fac=function(r){return new(r||v)(o.KVO(F.Qq))};static#e=this.\u0275prov=o.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}return v})();var w=a(7325),O=a(8774),R=a(177),L=a(5430),P=a(5779),G=a(612),B=a(1141),U=a(8150),C=a(5473),S=a(6781),m=a(6064);function b(v,l){if(1&v&&(o.j41(0,"span",2),o.EFF(1),o.k0s()),2&v){const s=o.XpG();o.R7$(1),o.SpI("Seleccionar Horario ",s.curso.nombre,"")}}function j(v,l){if(1&v){const s=o.RV6();o.j41(0,"div")(1,"p-checkbox",23),o.bIt("ngModelChange",function(n){const c=o.eBV(s).index,g=o.XpG(3);return o.Njj(g.selectedDays[c]=n)}),o.k0s()()}if(2&v){const s=l.$implicit,r=l.index,n=o.XpG(3);o.R7$(1),o.Y8G("ngModel",n.selectedDays[r])("binary",!0)("label",s)}}function D(v,l){if(1&v){const s=o.RV6();o.j41(0,"div",14)(1,"div",15)(2,"label",16),o.EFF(3,"Fecha de inicio:"),o.k0s(),o.j41(4,"p-calendar",17),o.bIt("ngModelChange",function(n){o.eBV(s);const E=o.XpG(2);return o.Njj(E.replicateStartDate=n)}),o.k0s()(),o.j41(5,"div",15)(6,"label",18),o.EFF(7,"Fecha de fin:"),o.k0s(),o.j41(8,"p-calendar",19),o.bIt("ngModelChange",function(n){o.eBV(s);const E=o.XpG(2);return o.Njj(E.replicateEndDate=n)}),o.k0s()(),o.j41(9,"div",20)(10,"label"),o.EFF(11,"D\xedas de la semana a replicar:"),o.k0s(),o.j41(12,"div",21),o.DNE(13,j,2,3,"div",22),o.k0s()()()}if(2&v){const s=o.XpG(2);o.R7$(4),o.Y8G("ngModel",s.replicateStartDate),o.R7$(4),o.Y8G("ngModel",s.replicateEndDate),o.R7$(5),o.Y8G("ngForOf",s.daysOfWeek)}}function T(v,l){if(1&v){const s=o.RV6();o.j41(0,"button",24),o.bIt("click",function(){o.eBV(s);const n=o.XpG(2);return o.Njj(n.replicateHorario())}),o.k0s(),o.j41(1,"button",25),o.bIt("click",function(){o.eBV(s);const n=o.XpG(2);return o.Njj(n.showReplicateDialog=!1)}),o.k0s()}}const p=function(){return{width:"100%"}},u=function(){return{width:"50vw",height:"auto"}};function h(v,l){if(1&v){const s=o.RV6();o.j41(0,"form",3)(1,"div",4)(2,"label",5),o.EFF(3,"Seleccionar Aula:"),o.k0s(),o.j41(4,"p-dropdown",6),o.bIt("onChange",function(n){o.eBV(s);const E=o.XpG();return o.Njj(E.onAulaChange(n))}),o.k0s()(),o.j41(5,"div",4),o.nrm(6,"full-calendar",7),o.k0s(),o.j41(7,"div",8)(8,"button",9),o.bIt("click",function(){o.eBV(s);const n=o.XpG();return o.Njj(n.saveHorario())}),o.k0s(),o.j41(9,"button",10),o.bIt("click",function(n){o.eBV(s);const E=o.XpG();return o.Njj(E.closeModal(n))}),o.k0s()()(),o.j41(10,"p-dialog",11,12),o.bIt("visibleChange",function(n){o.eBV(s);const E=o.XpG();return o.Njj(E.showReplicateDialog=n)})("onHide",function(){o.eBV(s);const n=o.XpG();return o.Njj(n.showReplicateDialog=!1)}),o.DNE(12,D,14,3,"ng-template",1),o.DNE(13,T,2,0,"ng-template",13),o.k0s()}if(2&v){const s=o.XpG();o.Y8G("formGroup",s.parametroForm),o.R7$(4),o.Aen(o.lJ4(12,p)),o.Y8G("options",s.aulas),o.R7$(2),o.Y8G("options",s.calendarOptions),o.R7$(2),o.Y8G("disabled",!s.parametroForm.valid),o.R7$(2),o.Aen(o.lJ4(13,u)),o.Y8G("draggable",!1)("visible",s.showReplicateDialog)("modal",!0)("header","Replicar Horario")}}let d=(()=>{class v{constructor(s,r,n,E,c,g){this.fb=s,this.ref=r,this.config=n,this.horarioService=E,this.aulaService=c,this.helpersService=g,this.loading=!1,this.aulas=[],this.aulaDisponibilidad=[],this.cursoHorarios=[],this.domain_id=1,this.showReplicateDialog=!1,this.replicateStartDate=new Date,this.replicateEndDate=new Date,this.daysOfWeek=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],this.selectedDays=[!0,!0,!0,!0,!0,!1,!1],this.domain_id=this.helpersService.getDominioId(),this.curso=this.config.data.data,this.parametroForm=this.fb.group({aula_id:["",e.k0.required]}),this.calendarOptions={plugins:[i.A,t.A,M.Ay],initialView:"timeGridWeek",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,select:this.handleDateSelect.bind(this),eventClick:this.handleEventClick.bind(this),eventsSet:this.handleEvents.bind(this)}}ngOnInit(){this.getAulas(),this.getCursoHorarios()}getAulas(){this.aulaService.getAulas(this.domain_id).subscribe(s=>{this.aulas=Array.isArray(s.data)?s.data:[]},s=>{this.helpersService.showErrorMessage("Error al obtener las aulas")})}onAulaChange(s){this.getAulaDisponibilidad(s.value),this.getCursoHorarios()}getAulaDisponibilidad(s){this.aulaService.getDisponibilidad(s).subscribe(r=>{this.aulaDisponibilidad=r.data,this.updateCalendar()},r=>{this.helpersService.showErrorMessage("Error al obtener la disponibilidad del aula")})}getCursoHorarios(){this.horarioService.getHorario(this.curso.id).subscribe(s=>{this.cursoHorarios=s,this.updateCalendar()},s=>{this.helpersService.showErrorMessage("Error al obtener los horarios del curso")})}updateCalendar(){const s=[...this.aulaDisponibilidad.map(r=>{let n=new Date(`${r.fecha}T${r.hora_inicio}`),E=new Date(`${r.fecha}T${r.hora_fin}`);return console.log("Disponibilidad:",n,"-",E,r.id,"aula_id:",r.aula_id),{start:n,end:E,title:"Disponibilidad",backendId:r.id,backgroundColor:"green",borderColor:"green",display:"background",allDay:!1,aula_id:r.aula_id,availability_id:r.id}}),...this.cursoHorarios.map(r=>({title:"Horario del curso",start:new Date(`${r.fecha_inicio}T${r.hora_inicio}`),end:new Date(`${r.fecha_fin}T${r.hora_fin}`),backgroundColor:"blue",allDay:!1}))];this.calendarOptions={...this.calendarOptions,events:s},console.log("Events:",s)}handleDateSelect(s){const{start:r,end:n}=s;if(console.log("Fecha seleccionada:",r,n),this.isWithinAulaDisponibilidad(r,n)){const f={title:"Nuevo horario",start:r,end:n,backgroundColor:"blue",extendedProps:{aula_id:this.parametroForm.value.aula_id,availability_id:this.getAvailabilityId(r,n)}};console.log("Nuevo evento creado:",f),this.calendarOptions.events=[...this.calendarOptions.events,f]}else this.helpersService.showErrorMessage("El horario seleccionado no est\xe1 dentro de la disponibilidad del aula")}getAvailabilityId(s,r){const n=this.aulaDisponibilidad.find(E=>s>=new Date(`${E.fecha}T${E.hora_inicio}`)&&r<=new Date(`${E.fecha}T${E.hora_fin}`));return console.log("Disponibilidad encontrada:",n),n?.id}handleEventClick(s){this.selectedEvent=s.event,this.replicateStartDate=new Date(this.selectedEvent.start),this.replicateEndDate=new Date(this.selectedEvent.start),this.replicateEndDate.setMonth(this.replicateEndDate.getMonth()+1),this.showReplicateDialog=!0}handleEvents(s){}isWithinAulaDisponibilidad(s,r){const n=s.toISOString().split("T")[0];return this.aulaDisponibilidad.filter(c=>c.fecha===n).some(c=>{const g=new Date(`${c.fecha}T${c.hora_inicio}`),f=new Date(`${c.fecha}T${c.hora_fin}`);return console.log("Disponibilidad:",g,"-",f),console.log("Nuevo horario:",s,"-",r),s>=g&&r<=f})}replicateHorario(){if(this.selectedEvent&&this.replicateStartDate&&this.replicateEndDate){console.log("Evento seleccionado para replicar:",this.selectedEvent);const s=[],r=this.selectedEvent.end.getTime()-this.selectedEvent.start.getTime();for(let E=new Date(this.replicateStartDate);E<=this.replicateEndDate;E.setDate(E.getDate()+1)){const c=E.getDay();if(this.selectedDays[0===c?6:c-1]){const g=new Date(E);g.setHours(this.selectedEvent.start.getHours(),this.selectedEvent.start.getMinutes(),0,0);const f=new Date(g.getTime()+r);if(this.isWithinAulaDisponibilidad(g,f)){const x={id:Math.floor(1e4*Math.random()),title:"Horario replicado",start:g,end:f,backgroundColor:"blue",extendedProps:{aula_id:this.selectedEvent.extendedProps?.aula_id,availability_id:this.getAvailabilityId(g,f)}};console.log("Nuevo evento replicado:",x),s.push(x)}}}const n=[...this.calendarOptions.events.filter(E=>"Disponibilidad"===E.title||"background"===E.display),...s];console.log("Eventos actualizados:",n),this.calendarOptions={...this.calendarOptions,events:n},this.showReplicateDialog=!1}}saveHorario(){if(this.parametroForm.valid){const s=this.calendarOptions.events.filter(n=>"Horario del curso"!==n.title&&!n.display).map(n=>({day_id:n.start.getDay(),fecha_inicio:n.start.toISOString().split("T")[0],fecha_fin:n.end.toISOString().split("T")[0],hora_inicio:n.start.toTimeString().split(" ")[0],hora_fin:n.end.toTimeString().split(" ")[0],aula_id:n.aula_id,availability_id:n.extendedProps.availability_id,curso_id:this.curso.id,docente_id:this.curso.docente_id,domain_id:this.domain_id})),r={curso_id:this.curso.id,aula_id:this.parametroForm.value.aula_id,horarios:s};this.loading=!0,this.horarioService.saveHorario(r).subscribe(n=>{this.helpersService.showSuccessMessage("Horario guardado correctamente"),this.ref?.close()},n=>{this.helpersService.showErrorMessage("Error al guardar el horario")}).add(()=>{this.loading=!1})}else this.helpersService.showErrorMessage("Por favor, complete todos los campos requeridos")}closeModal(s){s.preventDefault(),this.ref?.close()}static#t=this.\u0275fac=function(r){return new(r||v)(o.rXU(e.ok),o.rXU(y.Pw),o.rXU(y.sb),o.rXU(I),o.rXU(w.Z),o.rXU(O.V))};static#e=this.\u0275cmp=o.VBU({type:v,selectors:[["app-seleccionar-horario-carrera-tecnica"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[3,"formGroup"],[1,"mb-4"],["for","aula",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","aula_id","optionLabel","nombre","optionValue","id","placeholder","Seleccione un aula",3,"options","onChange"],[3,"options"],[1,"flex","justify-center","mt-4"],["pButton","","type","button","label","Guardar",1,"p-button-success","mr-2",3,"disabled","click"],["pButton","","type","button","label","Cancelar",1,"p-button-secondary",3,"click"],[3,"draggable","visible","modal","header","visibleChange","onHide"],["dd",""],["pTemplate","footer"],[1,"grid"],[1,"col-6"],["for","start",1,"block","mb-2"],["dateFormat","dd-mm-yy","inputId","start","appendTo","body",3,"ngModel","ngModelChange"],["for","end",1,"block","mb-2"],["dateFormat","dd-mm-yy","inputId","end","appendTo","body",3,"ngModel","ngModelChange"],[1,"col-12","mt-3"],[1,"flex","flex-wrap","gap-3","mt-2"],[4,"ngFor","ngForOf"],[3,"ngModel","binary","label","ngModelChange"],["pButton","","label","Replicar","icon","pi pi-check",3,"click"],["pButton","","label","Cancelar","icon","pi pi-times",3,"click"]],template:function(r,n){1&r&&(o.j41(0,"p-panel"),o.DNE(1,b,2,1,"ng-template",0),o.DNE(2,h,14,14,"ng-template",1),o.k0s())},dependencies:[R.Sq,L.Sc,P.Ei,e.qT,e.BC,e.cb,e.vS,G.Vv,B._f,U.ms,C.Z,S.l,e.j4,e.JD,m.x]})}return v})()},2362:($,A,a)=>{a.d(A,{q:()=>U});var e=a(7019),i=a(2100),t=a(1626),M=a(3587);let o=(()=>{class C{constructor(m,b,j){this.http=m,this.httpClientFormData=b,this.handler=j,this.baseUrl=`${M.c.API_BASE}`,this.httpOptions={headers:new t.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new t.Qq(this.handler)}getAsistenciaCurso(m){const b=new t.Lr({"Content-Type":"application/json",Accept:"application/json"}),j=(new t.Nl).set("curso_id",m.curso_id).set("domain_id",m.domain_id).set("fecha",m.fecha);return this.http.get(`${this.baseUrl}asistencia-curso`,{params:j,headers:b})}getFechasCursoHorario(m,b,j){const D=(new t.Nl).set("curso_id",m).set("docente_id",b).set("domain_id",j);return this.http.get(`${this.baseUrl}get-fechas-curso-horario`,{params:D})}updateAsistenciaCurso(m){return this.http.post(`${this.baseUrl}asistencia-curso-marcar`,m)}static#t=this.\u0275fac=function(b){return new(b||C)(e.KVO(t.Qq),e.KVO(t.Qq),e.KVO(t.JV))};static#e=this.\u0275prov=e.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})();var y=a(8774),_=a(177),F=a(5779),I=a(9417),w=a(9280),O=a(5473);function R(C,S){if(1&C&&(e.j41(0,"span",2),e.EFF(1),e.k0s()),2&C){const m=e.XpG();e.R7$(1),e.SpI("Asistencia ",m.cursoNombre,"")}}function L(C,S){if(1&C&&(e.j41(0,"option",12),e.EFF(1),e.k0s()),2&C){const m=S.$implicit;e.Y8G("value",m),e.R7$(1),e.JRh(m)}}function P(C,S){1&C&&(e.j41(0,"tr")(1,"th",13),e.EFF(2,"C\xf3digo"),e.k0s(),e.j41(3,"th",13),e.EFF(4,"Alumno"),e.k0s(),e.j41(5,"th",13),e.EFF(6,"Asistio"),e.k0s()())}function G(C,S){if(1&C){const m=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"input",14),e.bIt("change",function(j){const T=e.eBV(m).$implicit,p=e.XpG(2);return e.Njj(p.onCheckAsistencia(j,T))}),e.k0s()()()}if(2&C){const m=S.$implicit;e.R7$(2),e.JRh(m.codigo),e.R7$(2),e.JRh(m.nombres),e.R7$(2),e.Y8G("checked",m.is_marked)}}function B(C,S){if(1&C){const m=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"label",6),e.EFF(4,"Fecha:"),e.k0s(),e.j41(5,"select",7),e.bIt("change",function(j){e.eBV(m);const D=e.XpG();return e.Njj(D.onFilterDateChange(j))}),e.DNE(6,L,2,2,"option",8),e.k0s(),e.j41(7,"p-table",9,10),e.DNE(9,P,7,0,"ng-template",0),e.DNE(10,G,7,3,"ng-template",11),e.k0s()()()()}if(2&C){const m=e.XpG();e.R7$(6),e.Y8G("ngForOf",m.fechas),e.R7$(1),e.Y8G("value",m.asistenciaCursoList)("rows",10)("loading",m.loading)("rowHover",!0)}}let U=(()=>{class C{constructor(m,b,j,D){this.ref=m,this.config=b,this.asistenciaService=j,this.helpersService=D,this.loading=!1,this.asistenciaCursoList=[],this.fechas=[],this.selectedFecha="",this.initialLoad=!0,this.curso=this.config.data.cursoId,this.domainId=this.helpersService.getDominioId(),this.docente_id=this.config.data.docenteId,this.cursoNombre=this.config.data.cursoNombre,this.fechas=[],console.log("DATA"),console.log(this.curso),console.log(this.domainId),console.log(this.docente_id),this.cargarFechasCursoHorario()}cargarFechasCursoHorario(){this.asistenciaService.getFechasCursoHorario(this.curso,this.docente_id,this.domainId).subscribe(m=>{this.fechas=this.generarRangoFechas(m),this.fechas.length>0&&(this.selectedFecha=this.fechas[0],this.getAsistenciaCurso(this.domainId,this.curso,this.selectedFecha,!0))},m=>{console.error("Error al obtener las fechas del curso horario:",m)})}generarRangoFechas(m){const b=[];return m.forEach(j=>{const D=new Date(j.fecha_inicio),T=new Date(j.fecha_fin);let p=D;for(;p<=T;)b.push(p.toISOString().split("T")[0]),p.setDate(p.getDate()+1)}),b}getAsistenciaCurso(m,b,j,D=!1){console.log("Enviando solicitud al backend con la fecha:",j),this.loading=!0,this.asistenciaService.getAsistenciaCurso({domain_id:m,curso_id:b,fecha:j}).subscribe(p=>{if(console.log("Respuesta de la API:",p),p.horarios&&p.horarios.length>0){new Date(p.horarios[0].fecha_inicio),new Date(p.horarios[0].fecha_fin);const d=[];p.horarios.forEach(v=>{d.includes(v.day_id)||d.push(v.day_id)}),D&&this.fechas.length>0?(this.selectedFecha=this.fechas[0],this.getAsistenciaCurso(m,b,this.selectedFecha)):(this.loading=!1,this.asistenciaCursoList=p.participantes)}else console.error("No se encontraron horarios para el curso."),this.loading=!1},p=>{console.error("Error en la solicitud al backend:",p),this.loading=!1})}onCheckAsistencia(m,b){const j={domain_id:this.domainId??1,curso_id:this.curso,alumno_id:b.alumno_id,fecha:this.selectedFecha,asistio:m.target.checked,docente_id:this.docente_id};console.log("data",j),this.asistenciaService.updateAsistenciaCurso(j).subscribe(()=>{})}onFilterDateChange(m){this.selectedFecha=m.target.value,console.log("Fecha seleccionada:",this.selectedFecha),this.getAsistenciaCurso(this.domainId,this.curso,this.selectedFecha)}static#t=this.\u0275fac=function(b){return new(b||C)(e.rXU(i.Pw),e.rXU(i.sb),e.rXU(o),e.rXU(y.V))};static#e=this.\u0275cmp=e.VBU({type:C,selectors:[["app-marcar-asistencia-curso"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["for","fechaFilter"],["id","fechaFilter",3,"change"],[3,"value",4,"ngFor","ngForOf"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover"],["dt1",""],["pTemplate","body"],[3,"value"],["scope","col",2,"min-width","10rem"],["type","checkbox",3,"checked","change"]],template:function(b,j){1&b&&(e.j41(0,"p-panel"),e.DNE(1,R,2,1,"ng-template",0),e.DNE(2,B,11,5,"ng-template",1),e.k0s())},dependencies:[_.Sq,F.Ei,I.xH,I.y7,w.XI,O.Z]})}return C})()},9010:($,A,a)=>{a.d(A,{z:()=>r});var e=a(7533),i=a(7019),t=a(8032),M=a.n(t),o=a(3074),y=a(2976),_=a(2100),F=a(3088),I=a(5779),w=a(1141),O=a(9280),R=a(2242),L=a(5473),P=a(8542),G=a(177);const B=["filter"],U=["dt1"];function C(n,E){1&n&&(i.j41(0,"span",2),i.EFF(1,"Grupos de evaluaciones"),i.k0s())}function S(n,E){if(1&n){const c=i.RV6();i.j41(0,"div",12)(1,"div",13)(2,"span",14)(3,"input",15,16),i.bIt("input",function(f){i.eBV(c);const x=i.XpG(2);return i.Njj(x.onGlobalFilter(f))}),i.k0s()()()()}}function m(n,E){1&n&&(i.j41(0,"tr")(1,"th",17),i.EFF(2,"ID"),i.k0s(),i.j41(3,"th",17),i.EFF(4,"Nombre del grupo"),i.k0s(),i.j41(5,"th",17),i.EFF(6,"Evaluaciones"),i.k0s(),i.j41(7,"th",17),i.EFF(8,"Promedio por Alumno"),i.k0s()())}function b(n,E){if(1&n){const c=i.RV6();i.j41(0,"tr")(1,"td"),i.EFF(2),i.k0s(),i.j41(3,"td"),i.EFF(4),i.k0s(),i.j41(5,"td")(6,"button",18),i.bIt("click",function(){const x=i.eBV(c).$implicit,V=i.XpG(2);return i.Njj(V.agregarEvaluaciones(x))}),i.k0s()(),i.j41(7,"td"),i.EFF(8),i.nI1(9,"number"),i.k0s()()}if(2&n){const c=E.$implicit;i.R7$(2),i.JRh(c.id),i.R7$(2),i.JRh(c.nombre_del_grupo),i.R7$(4),i.JRh(c.promedio_por_alumno?i.i5U(9,3,c.promedio_por_alumno,"1.2-2"):"0.00")}}function j(n,E){1&n&&(i.j41(0,"tr")(1,"td",19),i.EFF(2,"No se encontraron registros"),i.k0s()())}function D(n,E){1&n&&(i.j41(0,"tr")(1,"td",19),i.EFF(2,"Cargando registros. Por favor espere."),i.k0s()())}function T(n,E){if(1&n&&(i.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),i.DNE(5,S,5,0,"ng-template",8),i.DNE(6,m,9,0,"ng-template",0),i.DNE(7,b,10,6,"ng-template",9),i.DNE(8,j,3,0,"ng-template",10),i.DNE(9,D,3,0,"ng-template",11),i.k0s()()()()),2&n){const c=i.XpG();i.R7$(3),i.Y8G("value",c.grupoEvaluacionesList)("rows",10)("loading",c.loading)("rowHover",!0)("paginator",!0)}}let p=(()=>{class n{constructor(c,g,f){this.dialogService=c,this.grupoEvaluacionesService=g,this.config=f,this.loading=!1,this.miembro=[],this.miembrosActualizados=new i.bkB,this.grupoEvaluacionesList=[],this.originalgrupoEvaluacionesList=[],this.promedioTotal=0,this.porcentajeTotal=0}ngOnInit(){this.grupoEvaluaciones=this.config.data.data||this.config.data,console.log("Datos recibidos en VerGEvAlumnoComponent:",this.grupoEvaluaciones),this.grupoEvaluaciones&&this.grupoEvaluaciones.id?(console.log("ID de curso recibido en VerGrupoEvaluacionesComponent:",this.grupoEvaluaciones.id),this.listarGrupoEvaluaciones()):console.error("No se recibi\xf3 un ID de curso v\xe1lido en VerGrupoEvaluacionesComponent.")}listarGrupoEvaluaciones(){this.grupoEvaluaciones&&this.grupoEvaluaciones.id?(this.grupoEvaluacionesService.getGrupoEvaluaciones({id:this.grupoEvaluaciones.id}).subscribe(c=>{this.grupoEvaluacionesList=c,this.originalgrupoEvaluacionesList=[...c],this.grupoEvaluacionesList.forEach(g=>{this.getPromedioPorAlumno(g.id,this.grupoEvaluaciones.alumnoId)})}),console.log("ID de grupo para obtener evaluaciones:",this.grupoEvaluaciones.id)):console.error("No se pudo listar las evaluaciones porque el ID de grupo es inv\xe1lido o no est\xe1 definido.")}getPromedioPorAlumno(c,g){console.log("Obteniendo promedio para Grupo ID:",c,"Alumno ID:",g),this.grupoEvaluacionesService.getPromedioPorAlumno(g,c).subscribe(f=>{f.success?(console.log("Promedio recibido para Grupo ID:",c,f.promedio),this.grupoEvaluacionesList.forEach(x=>{x.id===c&&(x.promedio_por_alumno=f.promedio)})):console.error("Error al obtener el promedio del alumno para el Grupo ID:",c)},f=>{console.error("Error en la solicitud del promedio para Grupo ID:",c,f)})}calcularTotales(){let c=0,g=0;this.grupoEvaluacionesList.forEach(f=>{c+=f.promedio||0,g+=f.porcentaje||0}),this.promedioTotal=c/this.grupoEvaluacionesList.length,this.porcentajeTotal=g/this.grupoEvaluacionesList.length}navigateAddCurso(){this.ref=this.dialogService.open(o.Y,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"add",idCurso:this.grupoEvaluaciones.id}}),this.ref.onClose.subscribe(c=>{this.listarGrupoEvaluaciones()})}navigateToDetalle(c){this.ref=this.dialogService.open(o.Y,{width:"80%",styleClass:"custom-dialog-header",data:{acciones:"ver",idCurso:this.grupoEvaluaciones.id,data:c}}),this.ref.onClose.subscribe(g=>{this.listarGrupoEvaluaciones()})}navigateToEdit(c){this.ref=this.dialogService.open(o.Y,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"actualizar",idCurso:this.grupoEvaluaciones.id,data:c}}),this.ref.onClose.subscribe(g=>{this.listarGrupoEvaluaciones()})}navigateToDelete(c){M().fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminarlo",customClass:{popup:"custom-swal-popup"},didOpen:()=>{const g=document.querySelector(".swal2-container");g&&g.setAttribute("style","z-index: 2147483647 !important")}}).then(g=>{g.isConfirmed&&this.grupoEvaluacionesService.eliminarGrupoEvaluaciones(c).subscribe(f=>{M().fire({title:"Eliminado",text:"La carrera t\xe9cnica ha sido eliminada.",icon:"success",showClass:{popup:"\n                  background-color: #78CBF2;\n                  color: white;\n                  z-index: 10000!important;\n                "},didOpen:()=>{const x=document.querySelector(".swal2-container");x&&x.setAttribute("style","z-index: 2147483647 !important")}}),this.listarGrupoEvaluaciones()},f=>{M().fire("Error","Hubo un problema al eliminar la carrera t\xe9cnica.","error")})})}onGlobalFilter(c){const g=c.target.value.toLowerCase();this.grupoEvaluacionesList=g?this.originalgrupoEvaluacionesList.filter(f=>f.codigo&&f.codigo.toLowerCase().includes(g)||f.nombres&&f.nombres.toLowerCase().includes(g)||f.cursos&&f.cursos.toLowerCase().includes(g)):[...this.originalgrupoEvaluacionesList]}agregarEvaluaciones(c){this.ref=this.dialogService.open(y.K,{width:"60%",styleClass:"custom-dialog-header",data:{idCurso:this.grupoEvaluaciones.id,data:c,alumnoId:this.grupoEvaluaciones.alumnoId}}),this.ref.onClose.subscribe(g=>{this.listarGrupoEvaluaciones()})}static#t=this.\u0275fac=function(g){return new(g||n)(i.rXU(_.o3),i.rXU(F.O),i.rXU(_.sb))};static#e=this.\u0275cmp=i.VBU({type:n,selectors:[["app-ver-g-ev-alumno"]],viewQuery:function(g,f){if(1&g&&(i.GBs(B,5),i.GBs(U,5)),2&g){let x;i.mGM(x=i.lsd())&&(f.filter=x.first),i.mGM(x=i.lsd())&&(f.tabledt1=x.first)}},inputs:{miembro:"miembro"},outputs:{miembrosActualizados:"miembrosActualizados"},decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar grupos de evaluaciones",1,"w-full",3,"input"],["filter",""],["scope","col",2,"min-width","10rem"],["pButton","","icon","pi pi-plus","pTooltip","Agregar evaluaciones","tooltipPosition","top",1,"p-button-rounded","p-button-info",3,"click"],["colspan","6"]],template:function(g,f){1&g&&(i.j41(0,"p-panel"),i.DNE(1,C,2,0,"ng-template",0),i.DNE(2,T,10,5,"ng-template",1),i.k0s())},dependencies:[I.Ei,w._f,O.XI,R.S,L.Z,P.m,G.QX]})}return n})();var u=a(5489);function h(n,E){if(1&n&&(i.j41(0,"span",2),i.EFF(1),i.k0s()),2&n){const c=i.XpG();i.R7$(1),i.SpI("Seleccionar Alumnos para ",c.cursoNombre,"")}}function d(n,E){if(1&n){const c=i.RV6();i.j41(0,"div",10)(1,"div",11)(2,"span",12)(3,"input",13,14),i.bIt("input",function(f){i.eBV(c);const x=i.XpG(2);return i.Njj(x.onGlobalFilter(f))}),i.k0s()()()()}}function v(n,E){1&n&&(i.j41(0,"tr")(1,"th",15),i.EFF(2," C\xf3digo "),i.k0s(),i.j41(3,"th",15),i.EFF(4," Nombres y Apellidos "),i.k0s(),i.j41(5,"th",15),i.EFF(6," Modales "),i.k0s(),i.j41(7,"th",15),i.EFF(8," Promedio "),i.k0s(),i.j41(9,"th",15),i.EFF(10," Estado "),i.k0s(),i.j41(11,"th",15),i.EFF(12," Celular "),i.k0s(),i.j41(13,"th",15),i.EFF(14," Correo "),i.k0s()())}function l(n,E){if(1&n){const c=i.RV6();i.j41(0,"tr")(1,"td"),i.EFF(2),i.k0s(),i.j41(3,"td"),i.EFF(4),i.k0s(),i.j41(5,"td")(6,"div",16)(7,"button",17),i.bIt("click",function(){const x=i.eBV(c).$implicit,V=i.XpG(2);return i.Njj(V.verEvaluaciones(x))}),i.EFF(8," Ev "),i.k0s()()(),i.j41(9,"td"),i.EFF(10),i.k0s(),i.j41(11,"td"),i.EFF(12),i.k0s(),i.j41(13,"td"),i.EFF(14),i.k0s(),i.j41(15,"td"),i.EFF(16),i.k0s()()}if(2&n){const c=E.$implicit;i.R7$(2),i.JRh(c.codigo),i.R7$(2),i.JRh(c.nombres),i.R7$(6),i.JRh(c.promedio),i.R7$(2),i.JRh(c.estadoAlumno),i.R7$(2),i.JRh(c.celular),i.R7$(2),i.JRh(c.email)}}function s(n,E){if(1&n&&(i.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),i.DNE(5,d,5,0,"ng-template",8),i.DNE(6,v,15,0,"ng-template",0),i.DNE(7,l,17,6,"ng-template",9),i.k0s()()()()),2&n){const c=i.XpG();i.R7$(3),i.Y8G("value",c.cursoAlumnoList)("rows",10)("loading",c.loading)("rowHover",!0)}}let r=(()=>{class n{constructor(c,g,f,x,V){this.ref=c,this.config=g,this.dialogService=f,this.cursoService=x,this.alumnoService=V,this.loading=!1,this.cursoAlumnoList=[],this.originalCursoAlumnoList=[],this.cursoNombre="",this.cursoData=[],this.carrerastecnicasList=[],this.originalCarrerastecnicasList=[],this.curso=this.config.data.cursoId,this.domainId=this.config.data.domainId,this.cursoNombre=this.config.data.cursoNombre,this.getAlumnosCurso(this.domainId??1,this.curso)}getAlumnosCurso(c,g){console.log("domainId",c),this.loading=!0,this.alumnoService.getAlumnosCurso(c,g).subscribe(f=>{console.log("alumnos",f),this.cursoAlumnoList=f,this.originalCursoAlumnoList=[...f],this.cursoAlumnoList.forEach(x=>{this.alumnoService.getPromedioEvaluaciones(g,x.id).subscribe(V=>{x.promedio=V.promedio_general?parseFloat(V.promedio_general).toFixed(2):"Sin evaluaciones"},V=>{console.error("Error al obtener el promedio de evaluaciones",V),x.promedio="Error"})}),this.loading=!1},f=>{console.error("Error al obtener los alumnos",f),this.loading=!1})}onSelectAlumno(c){console.log("alumno cambio seleccionado"),this.alumnoService.updateAlumnoCurso({domain_id:this.domainId??1,curso_id:this.curso,alumno_id:c.id,is_participant:c.is_participant}).subscribe(f=>{this.getAlumnosCurso(this.domainId,this.curso)})}onSelectAll(c){const g=c.target.checked;this.cursoAlumnoList.forEach(f=>{f.is_participant=g,this.onSelectAlumno(f)})}onGlobalFilter(c){const g=c.target.value.toLowerCase();console.log("Filtro Global",g),this.cursoAlumnoList=g?this.originalCursoAlumnoList.filter(f=>f.codigo&&f.codigo.toLowerCase().includes(g)||f.nombres&&f.nombres.toLowerCase().includes(g)||f.email&&f.email.toLowerCase().includes(g)):[...this.originalCursoAlumnoList]}getCursoData(){this.alumnoService.getCursoById(this.curso).subscribe(c=>{c.Exito?this.cursoData=[c.Datos]:console.error("Error al obtener los datos del curso.")})}verEvaluaciones(c){this.alumnoService.getCursoById(this.curso).subscribe(g=>{g.Exito?(this.ref=this.dialogService.open(p,{width:"60%",styleClass:"custom-dialog-header",data:{id:g.Datos.id,alumnoId:c.id}}),this.ref.onClose.subscribe(()=>{this.listarCursos()})):console.error("Error al obtener los datos del curso.")})}verForos(c){this.ref=this.dialogService.open(e.F,{width:"60%",styleClass:"custom-dialog-header",data:{data:c}}),this.ref.onClose.subscribe(()=>{this.listarCursos()})}listarCursos(){8===this.rolId?this.cursoService.getCursosPorDomain(this.domain_id).subscribe(c=>{this.carrerastecnicasList=c,this.originalCarrerastecnicasList=[...c]},c=>{console.error("Error al obtener cursos por dominio",c)}):this.alumnoService.getCursosByDocente(this.config.data.data.id).subscribe(c=>{this.carrerastecnicasList=c,this.originalCarrerastecnicasList=[...c]},c=>{console.error("Error al obtener cursos por docente",c)})}static#t=this.\u0275fac=function(g){return new(g||n)(i.rXU(_.Pw),i.rXU(_.sb),i.rXU(_.o3),i.rXU(u.Y),i.rXU(F.O))};static#e=this.\u0275cmp=i.VBU({type:n,selectors:[["app-seleccionar-alumnos-curso"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar alumnos",1,"w-full",3,"input"],["filter",""],["scope","col",2,"min-width","10rem"],[1,"button-group"],["pButton","","pTooltip","Ver Evaluaciones","tooltipPosition","top",1,"p-button-rounded","p-button-help","button-custom",2,"background","rgb(24, 15, 67)",3,"click"]],template:function(g,f){1&g&&(i.j41(0,"p-panel"),i.DNE(1,h,2,1,"ng-template",0),i.DNE(2,s,8,4,"ng-template",1),i.k0s())},dependencies:[I.Ei,w._f,O.XI,R.S,L.Z,P.m],styles:['@charset "UTF-8";.button-custom[_ngcontent-%COMP%]{width:1rem;height:3rem;background-color:#f0f8ff;background:#2c5f8b;color:#faebd7;border:none;border-radius:inherit;display:flex;justify-content:center;align-items:center;text-align:center}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.custom-swal-popup[_ngcontent-%COMP%], .swal2-popup[_ngcontent-%COMP%]{z-index:2147483647!important}body.swal2-shown[_ngcontent-%COMP%]:not(.swal2-no-backdrop):not(.swal2-toast-shown){z-index:2147483647!important}']})}return n})()},3074:($,A,a)=>{a.d(A,{Y:()=>U});var e=a(9961),i=a(9417),t=a(8032),M=a.n(t),o=a(7019),y=a(2100),_=a(3088),F=a(177),I=a(5779),w=a(1141),O=a(2242),R=a(5473);function L(C,S){if(1&C&&(o.j41(0,"span",2),o.EFF(1),o.k0s()),2&C){const m=o.XpG();o.R7$(1),o.SpI(" ","ver"===m.acciones?"Ver Grupo de Evaluaciones":"actualizar"===m.acciones?"Actualizar Grupo de Evaluaciones":"A\xf1adir Grupo de Evaluaciones"," ")}}function P(C,S){1&C&&o.nrm(0,"button",15)}function G(C,S){1&C&&o.nrm(0,"button",16)}function B(C,S){if(1&C){const m=o.RV6();o.j41(0,"form",3),o.bIt("ngSubmit",function(){o.eBV(m);const j=o.XpG();return o.Njj(j.guardarGrupoEvaluaciones())}),o.j41(1,"div",4)(2,"div",5)(3,"div",6)(4,"span",7),o.nrm(5,"input",8),o.j41(6,"label",9),o.EFF(7,"Nombre de Grupo"),o.k0s()()()()(),o.j41(8,"div",4)(9,"div",10)(10,"div",11),o.DNE(11,P,1,0,"button",12),o.DNE(12,G,1,0,"button",13),o.j41(13,"button",14),o.bIt("click",function(j){o.eBV(m);const D=o.XpG();return o.Njj(D.closeModal(j))}),o.k0s()()()()()}if(2&C){const m=o.XpG();o.Y8G("formGroup",m.parametroForm),o.R7$(5),o.Y8G("readonly","ver"===m.acciones),o.R7$(6),o.Y8G("ngIf","add"===m.acciones),o.R7$(1),o.Y8G("ngIf","actualizar"===m.acciones)}}let U=(()=>{class C{constructor(m,b,j,D){this.fb=m,this.ref=b,this.config=j,this.parametroService=D,this.loading=!1,this.parametroDatos=new e.A7,this.parametro=new e.A7,this.mostrarCursos=!1,this.parametroForm=this.fb.group({nombreGrupo:["",i.k0.required]})}ngOnInit(){this.idCurso=this.config.data.idCurso,this.acciones=this.config.data.acciones,("ver"===this.acciones||"actualizar"===this.acciones)&&this.parametroForm.patchValue({nombreGrupo:this.config.data.data.nombre_del_grupo})}guardarGrupoEvaluaciones(){this.parametroForm.valid?"add"===this.acciones?this.parametroService.guardarGrupoEvaluaciones({nombre_del_grupo:this.parametroForm.value.nombreGrupo,curso_id:this.idCurso}).subscribe(b=>{this.ref?.close(),M().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},b=>{console.error("Error al guardar el parametro",b)}):"actualizar"===this.acciones&&this.parametroService.actualizarGrupoEvaluaciones({nombre_del_grupo:this.parametroForm.value.nombreGrupo,id:this.config.data.data.id}).subscribe(j=>{this.ref?.close(),M().fire({title:"\xa1\xc9xito!",text:"Los Datos se actualizaron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},j=>{console.error("Error al actualizar el parametro",j)}):console.error("Formulario inv\xe1lido")}closeModal(m){m.preventDefault(),this.ref?.close()}static#t=this.\u0275fac=function(b){return new(b||C)(o.rXU(i.ok),o.rXU(y.Pw),o.rXU(y.sb),o.rXU(_.O))};static#e=this.\u0275cmp=o.VBU({type:C,selectors:[["app-agregar-editar-grupo-evaluaciones"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12"],[1,"p-float-label"],["type","text","pInputText","","formControlName","nombreGrupo",3,"readonly"],[1,"required"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","A\xf1adir","iconPos","right","class","p-button-success p-button-sm","type","submit",4,"ngIf"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","class","p-button-warning p-button-sm","type","submit",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["pButton","","icon","pi pi-plus","label","A\xf1adir","iconPos","right","type","submit",1,"p-button-success","p-button-sm"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","type","submit",1,"p-button-warning","p-button-sm"]],template:function(b,j){1&b&&(o.j41(0,"p-panel"),o.DNE(1,L,2,1,"ng-template",0),o.DNE(2,B,14,4,"ng-template",1),o.k0s())},dependencies:[F.bT,I.Ei,i.qT,i.me,i.BC,i.cb,w._f,O.S,R.Z,i.j4,i.JD]})}return C})()},2976:($,A,a)=>{a.d(A,{K:()=>D});var e=a(7019),i=a(247),t=a(8032),M=a.n(t),o=a(8774),y=a(2100),_=a(3088),F=a(8763),I=a(5779),w=a(9280),O=a(2242),R=a(5473),L=a(177);const P=["filter"],G=["dt1"];function B(T,p){1&T&&(e.j41(0,"span",2),e.EFF(1,"Listado de evaluaciones por grupo "),e.k0s())}function U(T,p){if(1&T){const u=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"span",14)(3,"input",15,16),e.bIt("input",function(d){e.eBV(u);const v=e.XpG(2);return e.Njj(v.onGlobalFilter(d))}),e.k0s()()()()}}function C(T,p){1&T&&(e.j41(0,"tr")(1,"th",17),e.EFF(2,"Evaluaciones"),e.k0s(),e.j41(3,"th",17),e.EFF(4,"Nota"),e.k0s(),e.j41(5,"th",17),e.EFF(6,"Fecha y Hora"),e.k0s(),e.j41(7,"th",17),e.EFF(8,"Observaciones"),e.k0s(),e.j41(9,"th",17),e.EFF(10,"Estado"),e.k0s(),e.j41(11,"th",17),e.EFF(12,"Modalidad"),e.k0s()())}function S(T,p){if(1&T&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s()()),2&T){const u=p.$implicit,h=e.XpG(2);e.R7$(2),e.JRh(u.nombre),e.R7$(2),e.JRh(e.i5U(5,6,u.nota,"1.2-2")),e.R7$(3),e.JRh(u.fecha_y_hora_programo),e.R7$(2),e.JRh(u.observaciones),e.R7$(2),e.JRh(u.estado_nombre),e.R7$(2),e.JRh(h.getModalidad(u.modalidad))}}function m(T,p){1&T&&(e.j41(0,"tr")(1,"td",18),e.EFF(2,"No se encontraron registros"),e.k0s()())}function b(T,p){1&T&&(e.j41(0,"tr")(1,"td",18),e.EFF(2,"Cargando registros. Por favor espere."),e.k0s()())}function j(T,p){if(1&T&&(e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),e.DNE(5,U,5,0,"ng-template",8),e.DNE(6,C,13,0,"ng-template",0),e.DNE(7,S,14,9,"ng-template",9),e.DNE(8,m,3,0,"ng-template",10),e.DNE(9,b,3,0,"ng-template",11),e.k0s()()()()),2&T){const u=e.XpG();e.R7$(3),e.Y8G("value",u.grupoEvaluacionesList)("rows",10)("loading",u.loading)("rowHover",!0)("paginator",!0)}}let D=(()=>{class T{constructor(u,h,d,v,l){this.helpersService=u,this.dialogService=h,this.grupoEvaluacionesService=d,this.router=v,this.config=l,this.loading=!1,this.miembro=[],this.miembrosActualizados=new e.bkB,this.grupoEvaluacionesList=[],this.originalgrupoEvaluacionesList=[],this.promedioTotal=0,this.porcentajeTotal=0}ngOnInit(){console.log("this.config.data",this.config.data);const u=this.config.data.alumnoId,h=this.config.data.data.id;console.log("alumnoId , grupoId",u,h),this.grupoEvaluaciones=this.config.data.data||this.config.data,this.getNotasPorAlumnoYGrupo(u,h)}listarGrupoEvaluaciones(){this.grupoEvaluaciones&&this.grupoEvaluaciones.id?(this.grupoEvaluacionesService.getGrupoEvaluaciones({id:this.grupoEvaluaciones.id}).subscribe(u=>{console.log("Datos de evaluaciones recibidos:",u),this.grupoEvaluacionesList=u,this.originalgrupoEvaluacionesList=[...u]}),console.log("ID de grupo para obtener evaluaciones:",this.grupoEvaluaciones.id)):console.error("No se pudo listar las evaluaciones porque el ID de grupo es inv\xe1lido o no est\xe1 definido.")}getPromedioPorAlumno(u,h){this.grupoEvaluacionesService.getPromedioPorAlumno(u,h).subscribe(d=>{d.success?this.grupoEvaluacionesList.forEach(v=>{v.promedio_por_alumno=d.promedio}):console.error("Error al obtener el promedio del alumno")},d=>{console.error("Error en la solicitud del promedio:",d)})}getNotasPorAlumnoYGrupo(u,h){this.loading=!0,this.grupoEvaluacionesService.getNotasPorAlumnoYGrupo(u,h).subscribe(d=>{console.log("Datos recibidos de la API:",d),d.success?this.grupoEvaluacionesList=d.notas:console.error("Error al obtener las notas"),this.loading=!1},d=>{console.error("Error en la solicitud",d),this.loading=!1})}getModalidad(u){return 0===u?"Presencial":"Remoto"}calcularTotales(){let u=0,h=0;this.grupoEvaluacionesList.forEach(d=>{u+=d.promedio||0,h+=d.porcentaje||0}),this.promedioTotal=u/this.grupoEvaluacionesList.length,this.porcentajeTotal=h/this.grupoEvaluacionesList.length}navigateAddCurso(){this.ref=this.dialogService.open(i.d,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"registrar",idGrupoEvaluaciones:this.grupoEvaluaciones.id}}),this.ref.onClose.subscribe(()=>{this.listarGrupoEvaluaciones()})}navigateToEdit(u){u&&u.id?(this.ref=this.dialogService.open(i.d,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"actualizar",idEvaluacion:u.id,data:u}}),this.ref.onClose.subscribe(h=>{this.listarGrupoEvaluaciones()})):console.error("Evaluaci\xf3n no v\xe1lida o sin ID",u)}navigateToDelete(u){M().fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminarlo",customClass:{popup:"custom-swal-popup"},didOpen:()=>{const h=document.querySelector(".swal2-container");h&&h.setAttribute("style","z-index: 2147483647 !important")}}).then(h=>{h.isConfirmed&&this.grupoEvaluacionesService.eliminarListadoDeEvaluacionesPorGrupo(u).subscribe(d=>{M().fire({title:"Eliminado",text:"La carrera t\xe9cnica ha sido eliminada.",icon:"success",showClass:{popup:"\n                background-color: #78CBF2;\n                color: white;\n                z-index: 10000!important;\n              "},didOpen:()=>{const v=document.querySelector(".swal2-container");v&&v.setAttribute("style","z-index: 2147483647 !important")}}),this.listarGrupoEvaluaciones()},d=>{M().fire("Error","Hubo un problema al eliminar la carrera t\xe9cnica.","error")})})}onGlobalFilter(u){const h=u.target.value.toLowerCase();this.grupoEvaluacionesList=h?this.originalgrupoEvaluacionesList.filter(d=>d.codigo&&d.codigo.toLowerCase().includes(h)||d.nombres&&d.nombres.toLowerCase().includes(h)||d.cursos&&d.cursos.toLowerCase().includes(h)):[...this.originalgrupoEvaluacionesList]}static#t=this.\u0275fac=function(h){return new(h||T)(e.rXU(o.V),e.rXU(y.o3),e.rXU(_.O),e.rXU(F.Ix),e.rXU(y.sb))};static#e=this.\u0275cmp=e.VBU({type:T,selectors:[["app-ver-lis-eval-grupo-alumno"]],viewQuery:function(h,d){if(1&h&&(e.GBs(P,5),e.GBs(G,5)),2&h){let v;e.mGM(v=e.lsd())&&(d.filter=v.first),e.mGM(v=e.lsd())&&(d.tabledt1=v.first)}},inputs:{miembro:"miembro"},outputs:{miembrosActualizados:"miembrosActualizados"},decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar por listado de evaluaciones por grupo",1,"w-full",3,"input"],["filter",""],["scope","col",2,"min-width","10rem"],["colspan","12"]],template:function(h,d){1&h&&(e.j41(0,"p-panel"),e.DNE(1,B,2,0,"ng-template",0),e.DNE(2,j,10,5,"ng-template",1),e.k0s())},dependencies:[I.Ei,w.XI,O.S,R.Z,L.QX]})}return T})()},4960:($,A,a)=>{a.d(A,{Z:()=>h});var e=a(8032),i=a.n(e),t=a(7019),M=a(2100),o=a(3088),y=a(8774),_=a(4789),F=a(177),I=a(9417),w=a(1141),O=a(5779),R=a(2242),L=a(8150),P=a(5473),G=a(1142);function B(d,v){1&d&&(t.j41(0,"span"),t.EFF(1,"Registro de Unidad Did\xe1ctica"),t.k0s())}function U(d,v){1&d&&(t.j41(0,"span"),t.EFF(1,"Visualizar Unidad Didactica"),t.k0s())}function C(d,v){1&d&&(t.j41(0,"span"),t.EFF(1,"Editar Unidad Didactica"),t.k0s())}function S(d,v){1&d&&(t.j41(0,"span"),t.EFF(1,"Duplicar Unidad Didactica"),t.k0s())}function m(d,v){if(1&d&&(t.j41(0,"span",2),t.DNE(1,B,2,0,"span",3),t.DNE(2,U,2,0,"span",3),t.DNE(3,C,2,0,"span",3),t.DNE(4,S,2,0,"span",3),t.k0s()),2&d){const l=t.XpG();t.R7$(1),t.Y8G("ngIf","add"===l.acciones),t.R7$(1),t.Y8G("ngIf","ver"===l.acciones),t.R7$(1),t.Y8G("ngIf","editar"===l.acciones),t.R7$(1),t.Y8G("ngIf","duplicar"===l.acciones)}}function b(d,v){if(1&d){const l=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7)(4,"p-dropdown",32),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG(2);return t.Njj(n.carreraSeleccionada=r)}),t.k0s(),t.j41(5,"label",33),t.EFF(6,"Carrera Profesional"),t.k0s(),t.j41(7,"small",13),t.EFF(8,"Campo obligatorio *"),t.k0s()()()()()}if(2&d){const l=t.XpG(2);t.R7$(4),t.Y8G("options",l.carrerasList)("ngModel",l.carreraSeleccionada)}}function j(d,v){if(1&d){const l=t.RV6();t.j41(0,"button",34),t.bIt("click",function(){t.eBV(l);const r=t.XpG(2);return t.Njj(r.GuardarCurso())}),t.k0s()}}function D(d,v){if(1&d){const l=t.RV6();t.j41(0,"button",35),t.bIt("click",function(){t.eBV(l);const r=t.XpG(2);return t.Njj(r.editarCurso())}),t.k0s()}}function T(d,v){if(1&d){const l=t.RV6();t.j41(0,"button",36),t.bIt("click",function(){t.eBV(l);const r=t.XpG(2);return t.Njj(r.GuardarCursoDuplicado())}),t.k0s()}}const p=function(){return{height:"90px"}};function u(d,v){if(1&d){const l=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"span",7)(4,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.codigo=r)}),t.k0s(),t.j41(5,"label",9),t.EFF(6,"C\xf3digo"),t.k0s()()(),t.j41(7,"div",6)(8,"span",7)(9,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.nombreCurso=r)}),t.k0s(),t.j41(10,"label",9),t.EFF(11,"Nombre de la Unidad Didactica"),t.k0s()()()()(),t.j41(12,"div",4)(13,"div",5)(14,"div",10)(15,"span",7)(16,"p-dropdown",11),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.ciclo=r)}),t.k0s(),t.j41(17,"label",12),t.EFF(18,"Ciclo "),t.k0s(),t.j41(19,"small",13),t.EFF(20,"Campo obligatorio * "),t.k0s()()(),t.j41(21,"div",6)(22,"span",7)(23,"p-dropdown",14),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.areaFormacion=r)}),t.k0s(),t.j41(24,"label",15),t.EFF(25,"M\xf3dulo "),t.k0s(),t.j41(26,"small",13),t.EFF(27,"Campo obligatorio * "),t.k0s()()()()(),t.j41(28,"div",4)(29,"div",5)(30,"div",10)(31,"span",7)(32,"p-dropdown",16),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.moduloFormativo=r)}),t.k0s(),t.j41(33,"label",17),t.EFF(34,"Competencia "),t.k0s(),t.j41(35,"small",13),t.EFF(36,"Campo obligatorio * "),t.k0s()()(),t.j41(37,"div",6)(38,"span",7)(39,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.cantidadCreditos=r)}),t.k0s(),t.j41(40,"label",9),t.EFF(41,"Cantidad de cr\xe9ditos"),t.k0s()()()()(),t.j41(42,"div",4)(43,"div",5)(44,"div",6)(45,"span",7)(46,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.porcentajeCreditos=r)}),t.k0s(),t.j41(47,"label",9),t.EFF(48,"% de cr\xe9ditos"),t.k0s()()(),t.j41(49,"div",6)(50,"span",7)(51,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.cantidadHoras=r)}),t.k0s(),t.j41(52,"label",9),t.EFF(53,"Horas Te\xf3ricas"),t.k0s()()(),t.j41(54,"div",6)(55,"span",7)(56,"input",8),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.horasPracticas=r)}),t.k0s(),t.j41(57,"label",9),t.EFF(58,"Horas Practicas"),t.k0s()()()()(),t.j41(59,"div",18)(60,"div",5)(61,"div",19)(62,"label"),t.EFF(63,"Digite el syllabus"),t.k0s(),t.j41(64,"p-editor",20),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.syllabus=r)}),t.k0s()()()(),t.j41(65,"div",18)(66,"div",5)(67,"div",19)(68,"label"),t.EFF(69,"Digite el tema"),t.k0s(),t.j41(70,"p-editor",20),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.tema=r)}),t.k0s()()()(),t.j41(71,"div",4)(72,"div",5)(73,"div",10)(74,"span",7)(75,"p-dropdown",21),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.asignacionDocentes=r)}),t.k0s(),t.j41(76,"label",22),t.EFF(77,"Asignaci\xf3n de docentes "),t.k0s(),t.j41(78,"small",13),t.EFF(79,"Campo obligatorio * "),t.k0s()()(),t.j41(80,"div",6)(81,"span",7)(82,"p-dropdown",23),t.bIt("ngModelChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.estado=r)})("onChange",function(r){t.eBV(l);const n=t.XpG();return t.Njj(n.onPlanDeEstudioChange(r))}),t.k0s(),t.j41(83,"label",24),t.EFF(84,"Plan de Estudios"),t.k0s(),t.j41(85,"small",13),t.EFF(86,"Campo obligatorio *"),t.k0s()()()(),t.DNE(87,b,9,2,"div",25),t.k0s(),t.j41(88,"div",4)(89,"div",26)(90,"div",27),t.DNE(91,j,1,0,"button",28),t.DNE(92,D,1,0,"button",29),t.DNE(93,T,1,0,"button",30),t.j41(94,"button",31),t.bIt("click",function(){t.eBV(l);const r=t.XpG();return t.Njj(r.closeModal())}),t.k0s()()()()}if(2&d){const l=t.XpG();t.R7$(4),t.Y8G("ngModel",l.codigo)("disabled","ver"===l.acciones),t.R7$(5),t.Y8G("ngModel",l.nombreCurso)("disabled","ver"===l.acciones),t.R7$(7),t.Y8G("options",l.ciclos)("ngModel",l.ciclo)("disabled","ver"===l.acciones),t.R7$(7),t.Y8G("options",l.areasFormacion)("ngModel",l.areaFormacion)("disabled","ver"===l.acciones),t.R7$(9),t.Y8G("options",l.modulosFormativos)("ngModel",l.moduloFormativo)("disabled","ver"===l.acciones),t.R7$(7),t.Y8G("ngModel",l.cantidadCreditos)("disabled","ver"===l.acciones),t.R7$(7),t.Y8G("ngModel",l.porcentajeCreditos)("disabled","ver"===l.acciones),t.R7$(5),t.Y8G("ngModel",l.cantidadHoras)("disabled","ver"===l.acciones),t.R7$(5),t.Y8G("ngModel",l.horasPracticas)("disabled","ver"===l.acciones),t.R7$(8),t.Aen(t.lJ4(39,p)),t.Y8G("ngModel",l.syllabus)("readonly","ver"===l.acciones),t.R7$(6),t.Aen(t.lJ4(40,p)),t.Y8G("ngModel",l.tema)("readonly","ver"===l.acciones),t.R7$(5),t.Y8G("options",l.asignacionesDocentes)("ngModel",l.asignacionDocentes)("disabled","ver"===l.acciones),t.R7$(7),t.Y8G("options",l.estados)("ngModel",l.estado)("disabled","ver"===l.acciones),t.R7$(5),t.Y8G("ngIf","duplicar"===l.acciones),t.R7$(4),t.Y8G("ngIf","add"===l.acciones),t.R7$(1),t.Y8G("ngIf","editar"===l.acciones),t.R7$(1),t.Y8G("ngIf","duplicar"===l.acciones)}}let h=(()=>{class d{constructor(l,s,r,n,E){this.ref=l,this.parametroService=s,this.config=r,this.helperService=n,this.commonService=E,this.id=0,this.cantidadTotalCreditos=0,this.codigo="",this.nombreCurso="",this.ciclo={},this.ciclos=[],this.areaFormacion={},this.areasFormacion=[],this.moduloFormativo={},this.modulosFormativos=[],this.cantidadCreditos=0,this.porcentajeCreditos=0,this.cantidadHoras=0,this.horasPracticas=0,this.syllabus="",this.tema="",this.asignacionDocentes={},this.asignacionesDocentes=[],this.estados=[],this.estado={},this.acciones="",this.domain_id=1,this.subscriptions=[],this.curso={},this.carreraSeleccionada={},this.carrerasList=[]}ngOnInit(){"add"!==this.config.data.acciones&&(this.idCurso=this.config.data.data.id),this.cantidadTotalCreditos=this.config.data.total_creditos,this.acciones=this.config.data.acciones,this.domain_id=this.helperService.getDominioId(),this.carrera_id=this.curso.carrera_id,"editar"===this.acciones||"ver"===this.acciones||"duplicar"===this.acciones?this.obtenerDatosCurso(this.idCurso).then(()=>{this.codigo=this.curso.codigo,this.nombreCurso=this.curso.nombre,this.ciclo=this.curso.ciclo_id,this.areaFormacion=this.curso.area_de_formacion_id,this.moduloFormativo=this.curso.modulo_formativo_id,this.cantidadCreditos=this.curso.cantidad_de_creditos,this.porcentajeCreditos=this.curso.porcentaje_de_creditos,this.cantidadHoras=this.curso.cantidad_de_horas,this.horasPracticas=this.curso.horas_practicas,this.syllabus=this.curso.syllabus,this.carrera_id=this.curso.carrera_id,this.tema=this.curso.tema,this.asignacionDocentes=this.curso.docente_id,this.estado=this.curso.estado_id,"duplicar"===this.acciones&&this.getCarrerasDropdown(this.estado)}):(this.codigo="",this.nombreCurso="",this.ciclo={},this.areaFormacion={},this.moduloFormativo={},this.cantidadCreditos=0,this.porcentajeCreditos=0,this.cantidadHoras=0,this.horasPracticas=0,this.syllabus="",this.tema="",this.asignacionDocentes={},this.carrera_id=null,this.estado=null),Promise.all([this.listarModulosFormativos(),this.listarAreasFormacion(),this.listarCiclos(),this.listarEstados(),this.listarDocentes(this.domain_id)]).then(()=>{})}ngAfterViewInit(){}GuardarCurso(){const l={codigo:this.codigo,nombreCurso:this.nombreCurso,cicloId:this.ciclo,areaFormacionId:this.areaFormacion,moduloFormativoId:this.moduloFormativo,cantidadCreditos:this.cantidadCreditos,porcentajeCreditos:this.porcentajeCreditos,cantidadHoras:this.cantidadHoras,horasPracticas:this.horasPracticas,syllabus:this.syllabus,tema:this.tema,asignacionDocentesId:this.asignacionDocentes,carreraId:this.config.data.id,estadoId:this.estado,domain_id:this.domain_id};console.log("curso",l),l&&this.parametroService.guardarCurso(l).subscribe(s=>{this.closeModal(),i().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},s=>{})}getCarrerasDropdown(l){this.commonService.getCarrerasDropdownByPlanDeEstudio(l).subscribe(s=>{this.carrerasList=s.map(r=>({name:r.nombres,value:r.id}))},s=>{})}onPlanDeEstudioChange(l){const s=l.value;this.carreraSeleccionada=null,this.carrerasList=[],s&&this.getCarrerasDropdown(s)}GuardarCursoDuplicado(){const l={id:void 0,codigo:this.codigo,nombreCurso:this.nombreCurso,cicloId:this.ciclo,areaFormacionId:this.areaFormacion,moduloFormativoId:this.moduloFormativo,cantidadCreditos:this.cantidadCreditos,porcentajeCreditos:this.porcentajeCreditos,cantidadHoras:this.cantidadHoras,horasPracticas:this.horasPracticas,syllabus:this.syllabus,tema:this.tema,asignacionDocentesId:this.asignacionDocentes,carreraId:this.carreraSeleccionada,estadoId:this.estado,domain_id:this.domain_id};l&&this.parametroService.guardarCurso(l).subscribe(s=>{this.closeModal(),i().fire({title:"\xa1\xc9xito!",text:"El curso duplicado se guard\xf3 correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},s=>{})}editarCurso(){const l={codigo:this.codigo,nombreCurso:this.nombreCurso,cicloId:this.ciclo,areaFormacionId:this.areaFormacion,moduloFormativoId:this.moduloFormativo,cantidadCreditos:this.cantidadCreditos,porcentajeCreditos:this.porcentajeCreditos,cantidadHoras:this.cantidadHoras,horasPracticas:this.horasPracticas,syllabus:this.syllabus,tema:this.tema,asignacionDocentesId:this.asignacionDocentes?this.asignacionDocentes.value:null,carreraId:this.carrera_id,estadoId:this.estado,cursoId:this.config.data.data.id,domain_id:this.domain_id};console.log("Curso a actualizar",l),l?this.parametroService.actualizarCurso(l).subscribe(s=>{this.closeModal(),i().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},s=>{console.error("Error al actualizar el curso",s)}):console.error("Formulario inv\xe1lido")}onCantidadCreditosChange(l){this.porcentajeCreditos=0===this.cantidadTotalCreditos||null==this.cantidadTotalCreditos?100:l/this.cantidadTotalCreditos*100}obtenerDatosCurso(l){return new Promise((s,r)=>{this.parametroService.getCursoById(l).subscribe(n=>{this.curso=n.Datos,s()},n=>r(n))})}listarModulosFormativos(){return new Promise((l,s)=>{this.parametroService.getModulosFormativos().subscribe(r=>{this.modulosFormativos=r,l()},r=>s(r))})}listarAreasFormacion(){return new Promise((l,s)=>{this.parametroService.getAreasDeFormacion().subscribe(r=>{this.areasFormacion=r,l()},r=>s(r))})}listarCiclos(){return new Promise((l,s)=>{this.parametroService.getCiclos().subscribe(r=>{this.ciclos=r,l()},r=>s(r))})}listarEstados(){return new Promise((l,s)=>{this.parametroService.getEstadoDeCurso().subscribe(r=>{this.estados=r,l()},r=>s(r))})}listarDocentes(l){return new Promise((s,r)=>{this.commonService.getDocentesDropdown(this.domain_id).subscribe(n=>{this.asignacionesDocentes=n.map(E=>({label:E.nombres,value:E.id})),s()},n=>r(n))})}closeModal(){this.ref.close({register:!1})}syllabusChange(l){}static#t=this.\u0275fac=function(s){return new(s||d)(t.rXU(M.Pw),t.rXU(o.O),t.rXU(M.sb),t.rXU(y.V),t.rXU(_.h))};static#e=this.\u0275cmp=t.VBU({type:d,selectors:[["app-reg-cursos"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[4,"ngIf"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12","md:col-6"],[1,"p-float-label"],["type","text","pInputText","",3,"ngModel","disabled","ngModelChange"],[1,"required"],[1,"field","md:col-6"],["inputId","dropdownCiclo","optionLabel","nombre","optionValue","id",3,"options","ngModel","disabled","ngModelChange"],["for","dropdownCiclo"],[2,"color","brown"],["inputId","dropdownAreaFormacion","optionLabel","nombre","optionValue","id",3,"options","ngModel","disabled","ngModelChange"],["for","dropdownAreaFormacion"],["inputId","dropdownModuloFormativo","optionLabel","nombre","optionValue","id",3,"options","ngModel","disabled","ngModelChange"],["for","dropdownModuloFormativo"],[1,"row","mt-2"],[1,"field","col-12","md:col-12"],[3,"ngModel","readonly","ngModelChange"],["inputId","dropdownAsignacionDocentes","optionLabel","label","optionValue","value",3,"options","ngModel","disabled","ngModelChange"],["for","dropdownAsignacionDocentes"],["inputId","dropdownEstado","optionLabel","nombre","optionValue","id",3,"options","ngModel","disabled","ngModelChange","onChange"],["for","dropdownEstado"],["class","row",4,"ngIf"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","class","p-button-success p-button-sm",3,"click",4,"ngIf"],["pButton","","icon","pi pi-pencil","label","Editar Unidad Didactica","iconPos","right","class","p-button-warning p-button-sm",3,"click",4,"ngIf"],["pButton","","icon","pi pi-copy","label","Duplicar Unidad Didactica","iconPos","right","class","p-button-secondary p-button-sm",3,"click",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["inputId","dropdownCarreraId","optionLabel","name","optionValue","value",3,"options","ngModel","ngModelChange"],["for","dropdownCarreraId"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right",1,"p-button-success","p-button-sm",3,"click"],["pButton","","icon","pi pi-pencil","label","Editar Unidad Didactica","iconPos","right",1,"p-button-warning","p-button-sm",3,"click"],["pButton","","icon","pi pi-copy","label","Duplicar Unidad Didactica","iconPos","right",1,"p-button-secondary","p-button-sm",3,"click"]],template:function(s,r){1&s&&(t.j41(0,"p-panel"),t.DNE(1,m,5,4,"ng-template",0),t.DNE(2,u,95,41,"ng-template",1),t.k0s())},dependencies:[F.bT,I.me,I.BC,I.vS,w._f,O.Ei,R.S,L.ms,P.Z,G.KE]})}return d})()},247:($,A,a)=>{a.d(A,{d:()=>j});var e=a(8032),i=a.n(e),t=a(7019),M=a(2100),o=a(3587),y=a(1626);let _=(()=>{class D{constructor(p){this.http=p,this.baseUrl=`${o.c.API_BASE}`,this.urlparametro=`${o.c.API_BASE}`}obtenerEvaluacionPorId(p){return this.http.get(`${this.baseUrl}evaluacion/${p}`)}crearEvaluacion(p){return this.http.post(`${this.baseUrl}evaluaciones`,p)}actualizarEvaluacion(p,u){return this.http.put(`${this.baseUrl}evaluacion/${p}`,u)}obtenerEvaluacionesPorGrupo(p){return this.http.get(`${this.baseUrl}/${p}`)}eliminarEvaluacion(p){return this.http.delete(`${this.baseUrl}/${p}`)}static#t=this.\u0275fac=function(u){return new(u||D)(t.KVO(y.Qq))};static#e=this.\u0275prov=t.jDH({token:D,factory:D.\u0275fac,providedIn:"root"})}return D})();var F=a(5779),I=a(8774),w=a(177),O=a(9417),R=a(612),L=a(1141),P=a(2242),G=a(1305),B=a(8150),U=a(5473);function C(D,T){if(1&D&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&D){const p=t.XpG();t.R7$(1),t.SpI(" ","registrar"===p.acciones?"Registrar Evaluaci\xf3n":"Actualizar Evaluaci\xf3n"," ")}}function S(D,T){if(1&D){const p=t.RV6();t.j41(0,"button",29),t.bIt("click",function(){t.eBV(p);const h=t.XpG(2);return t.Njj(h.guardarEvaluacion())}),t.k0s()}}function m(D,T){if(1&D){const p=t.RV6();t.j41(0,"button",30),t.bIt("click",function(){t.eBV(p);const h=t.XpG(2);return t.Njj(h.actualizarEvaluacion())}),t.k0s()}}function b(D,T){if(1&D){const p=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6)(4,"input",7),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.nombre=h)}),t.k0s(),t.j41(5,"label",8),t.EFF(6,"Nombre"),t.k0s()()()()(),t.j41(7,"div",3)(8,"div",4)(9,"div",9)(10,"span",6)(11,"p-calendar",10),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.fechaRegistro=h)}),t.k0s(),t.j41(12,"label",11),t.EFF(13,"Fecha de la noticia"),t.k0s()()(),t.j41(14,"div",9)(15,"span",6)(16,"p-calendar",12),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.horaprogramada=h)})("onSelect",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.capturarHora(h))}),t.k0s(),t.j41(17,"label",13),t.EFF(18,"Hora programada"),t.k0s()(),t.j41(19,"small",14),t.EFF(20,"Campo obligatorio *"),t.k0s()()(),t.j41(21,"div",3)(22,"div",4)(23,"div",15)(24,"span",6)(25,"textarea",16),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.observaciones=h)}),t.k0s(),t.j41(26,"label",17),t.EFF(27,"Observaciones"),t.k0s()()()()()(),t.j41(28,"div",3)(29,"div",4)(30,"div",18)(31,"span",6)(32,"p-dropdown",19),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.estado=h)}),t.k0s(),t.j41(33,"label",20),t.EFF(34,"Estados"),t.k0s()()()()(),t.j41(35,"div",3)(36,"div",4)(37,"div",18)(38,"span",6)(39,"p-dropdown",21),t.bIt("ngModelChange",function(h){t.eBV(p);const d=t.XpG();return t.Njj(d.modalidad=h)}),t.k0s(),t.j41(40,"label",22),t.EFF(41,"Modalidad"),t.k0s()()()()(),t.j41(42,"div",23)(43,"div",24)(44,"div",25),t.DNE(45,S,1,0,"button",26),t.DNE(46,m,1,0,"button",27),t.j41(47,"button",28),t.bIt("click",function(){t.eBV(p);const h=t.XpG();return t.Njj(h.closeModal())}),t.k0s()()()()}if(2&D){const p=t.XpG();t.R7$(4),t.Y8G("ngModel",p.nombre),t.R7$(7),t.Y8G("ngModel",p.fechaRegistro)("showTime",!1)("showSeconds",!1),t.R7$(5),t.Y8G("ngModel",p.horaprogramada)("showTime",!0)("showSeconds",!1)("timeOnly",!0),t.R7$(9),t.Y8G("ngModel",p.observaciones),t.R7$(7),t.Y8G("options",p.estados)("ngModel",p.estado),t.R7$(7),t.Y8G("options",p.tipModalidad)("ngModel",p.modalidad),t.R7$(6),t.Y8G("ngIf","registrar"===p.acciones),t.R7$(1),t.Y8G("ngIf","actualizar"===p.acciones)}}let j=(()=>{class D{constructor(p,u,h,d,v){this.ref=p,this.evaluacionesService=u,this.messageService=h,this.config=d,this.helpersService=v,this.loading=!1,this.tipEvaluacion=[{name:"Oral",value:65},{name:"Escrito",value:44},{name:"Recuperaci\xf3n",value:45}],this.estados=[{name:"Pendiente",value:1},{name:"En Proceso",value:2},{name:"Culminado",value:3}],this.tipModalidad=[{name:"Presencial",value:0},{name:"Remoto",value:1}]}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),console.log(this.domain_id),this.config&&this.config.data&&(this.acciones=this.config.data.acciones,"registrar"===this.acciones&&(this.grupoDeEvaluacionesId=this.config.data.idGrupoEvaluaciones),"actualizar"===this.acciones)&&this.cargarDatosParaEditar(this.config.data.idEvaluacion)}capturarHora(p){if(p&&p instanceof Date){const u=p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});console.log("Hora seleccionada:",u),this.horaprogramada=p}}cargarDatosParaEditar(p){this.evaluacionesService.obtenerEvaluacionPorId(p).subscribe(u=>{console.log("Datos obtenidos del backend:",u);const h=u;this.nombre=h.nombre,this.tipoEvaluacion=h.tipo_evaluacion_id,this.estado=h.estado_id,this.observaciones=h.observaciones,this.fechaRegistro=new Date(h.fecha_y_hora_programo),this.grupoDeEvaluacionesId=h.grupo_de_evaluaciones_id,this.modalidad=h.modalidad,this.porcentajeAsignado=h.porcentaje_asignado;const d=new Date(h.fecha_y_hora_programo),v=new Date;v.setHours(d.getHours()),v.setMinutes(d.getMinutes()),v.setSeconds(0),this.horaprogramada=v},u=>{console.error("Error al obtener la evaluaci\xf3n:",u)})}guardarEvaluacion(){let p=null;this.fechaRegistro&&this.horaprogramada&&(p=`${this.fechaRegistro.toISOString().slice(0,10)} ${this.horaprogramada.toTimeString().slice(0,8)}`);const u={nombre:this.nombre,tipo_evaluacion_id:Number(this.tipoEvaluacion),fecha_y_hora_programo:p,observaciones:this.observaciones||null,estado_id:Number(this.estado),modalidad:this.modalidad,domain_id:this.domain_id,grupo_de_evaluaciones_id:this.grupoDeEvaluacionesId||null,porcentaje_asignado:this.porcentajeAsignado||0};console.log("Datos enviados:",u),this.loading=!0,this.evaluacionesService.crearEvaluacion(u).subscribe(h=>{this.loading=!1,i().fire({title:"Registrado",text:"La evaluaci\xf3n ha sido registrada exitosamente.",icon:"success",confirmButtonText:"Aceptar",showClass:{popup:"\n                            background-color: #78CBF2;\n                            color: white;\n                            z-index: 10000!important;\n                        "},didOpen:()=>{const d=document.querySelector(".swal2-container");d&&d.setAttribute("style","z-index: 2147483647 !important")}}).then(d=>{(d.isConfirmed||d.isDismissed)&&this.ref&&this.ref.close()})},h=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Error al registrar la evaluaci\xf3n. Por favor intenta de nuevo."})})}actualizarEvaluacion(){let p=null;this.fechaRegistro&&this.horaprogramada&&(p=`${this.fechaRegistro.toISOString().slice(0,10)} ${this.horaprogramada.toTimeString().slice(0,8)}`);const u={nombre:this.nombre,tipo_evaluacion_id:Number(this.tipoEvaluacion),fecha_y_hora_programo:p,observaciones:this.observaciones||null,modalidad:this.modalidad,estado_id:Number(this.estado),domain_id:this.domain_id,grupo_de_evaluaciones_id:this.grupoDeEvaluacionesId||null,porcentaje_asignado:this.porcentajeAsignado||0};console.log("Datos enviados para actualizar:",u),this.evaluacionesService.actualizarEvaluacion(this.config.data.idEvaluacion,u).subscribe(h=>{i().fire({title:"Actualizado",text:"La evaluaci\xf3n ha sido actualizada exitosamente.",icon:"success",confirmButtonText:"Aceptar"}),this.ref.close()},h=>{console.error("Error al actualizar la evaluaci\xf3n:",h)})}closeModal(){this.ref.close({register:!1})}static#t=this.\u0275fac=function(u){return new(u||D)(t.rXU(M.Pw),t.rXU(_),t.rXU(F.bg),t.rXU(M.sb),t.rXU(I.V))};static#e=this.\u0275cmp=t.VBU({type:D,selectors:[["app-reg-evaluacion-docente"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","col-12","md:col-6"],[1,"p-float-label"],["type","text","pInputText","",3,"ngModel","ngModelChange"],[1,"required"],[1,"field","md:col-3"],["inputId","calendar","dateFormat","dd-mm-yy",3,"ngModel","showTime","showSeconds","ngModelChange"],["for","calendar"],["inputId","horaprogramada","dateFormat","dd-mm-yy",3,"ngModel","showTime","showSeconds","timeOnly","ngModelChange","onSelect"],["for","horaprogramada"],[2,"color","brown"],[1,"field","col-12"],["pInputTextarea","","rows","3",3,"ngModel","ngModelChange"],["for","observaciones"],[1,"field","md:col-6"],["inputId","dropdownEstado","optionLabel","name","optionValue","value",3,"options","ngModel","ngModelChange"],["for","dropdownEstado"],["inputId","dropdownModalidad","optionLabel","name","optionValue","value",3,"options","ngModel","ngModelChange"],["for","dropdownModalidad"],[1,"row"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","Guardar Evaluaci\xf3n","iconPos","right","class","p-button-success p-button-sm",3,"click",4,"ngIf"],["pButton","","icon","pi pi-refresh","label","Actualizar Evaluaci\xf3n","iconPos","right","class","p-button-warning p-button-sm",3,"click",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["pButton","","icon","pi pi-plus","label","Guardar Evaluaci\xf3n","iconPos","right",1,"p-button-success","p-button-sm",3,"click"],["pButton","","icon","pi pi-refresh","label","Actualizar Evaluaci\xf3n","iconPos","right",1,"p-button-warning","p-button-sm",3,"click"]],template:function(u,h){1&u&&(t.j41(0,"p-panel"),t.DNE(1,C,2,1,"ng-template",0),t.DNE(2,b,48,15,"ng-template",1),t.k0s())},dependencies:[w.bT,O.me,O.BC,O.vS,R.Vv,L._f,F.Ei,P.S,G.Z,B.ms,U.Z],styles:[".p-inputtext[_ngcontent-%COMP%]{width:-1px}.grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-right:-1rem;margin-left:-1rem;margin-top:-1rem;gap:6rem;row-gap:0rem}"]})}return D})()},9961:($,A,a)=>{a.d(A,{A7:()=>M,AF:()=>y,GE:()=>o});class M{constructor(){this.nuIdParametro=null,this.txNombre="",this.txAbreviatura="",this.nuItemNro=null,this.txItemDescripcion=null,this.isSelected=null,this.txUseCreado=null,this.txUseModificado=null}}class o{constructor(){this.id=null,this.codigo="",this.nombre="",this.descripcion="",this.costo=null,this.recursos=null,this.estado=null,this.txUseCreado=null,this.txUseModificado=null,this.domain_id=null,this.user_id=null}}class y{constructor(){this.id=null,this.codigo="",this.nombre="",this.horas=0,this.sylabus=null,this.temas=null,this.estado=null,this.fecha=null,this.idDocente=0,this.docente=null,this.idEstado=null,this.etapa=null,this.txUseCreado=null,this.txUseModificado=null}}},7325:($,A,a)=>{a.d(A,{Z:()=>M});var e=a(1626),i=a(3587),t=a(7019);let M=(()=>{class o{constructor(_,F,I){this.http=_,this.httpClientFormData=F,this.handler=I,this.baseUrl=`${i.c.API_BASE}`,this.urlparametro=`${i.c.API_BASE}`,this.httpOptions={headers:new e.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new e.Qq(this.handler)}saveAula(_){return this.http.post(`${this.baseUrl}aulas`,_)}getAulas(_){return this.http.get(`${this.baseUrl}aulas/${_}`)}deleteAula(_){return this.http.delete(`${this.baseUrl}aulas/${_}`)}saveDisponibilidad(_){return this.http.post(`${this.baseUrl}aulas/disponibilidad`,_)}getDisponibilidad(_){return this.http.get(`${this.baseUrl}aulas/disponibilidad/${_}`)}deleteDisponibilidad(_){return this.http.delete(`${this.baseUrl}aulas/disponibilidad/${_}`)}static#t=this.\u0275fac=function(F){return new(F||o)(t.KVO(e.Qq),t.KVO(e.Qq),t.KVO(e.JV))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},4789:($,A,a)=>{a.d(A,{h:()=>M});var e=a(1626),i=a(3587),t=a(7019);let M=(()=>{class o{constructor(_,F,I){this.http=_,this.httpClientFormData=F,this.handler=I,this.baseUrl=`${i.c.API_BASE}`,this.urlparametro=`${i.c.API_BASE}`,this.httpOptions={headers:new e.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new e.Qq(this.handler)}getCarrerasDropdown(_){return this.http.get(`${this.baseUrl}carreras-dropdown/${_}`)}getCarrerasDropdownByPlanDeEstudio(_){return this.http.get(`${this.baseUrl}carreras-dropdown/${_}`)}getCiclosDropdown(_){return this.http.get(`${this.baseUrl}ciclos-dropdown/${_}`)}getRolesDropdown(){return this.http.get(`${this.baseUrl}roles-dropdown`)}getDocentesDropdown(_){return this.http.get(`${this.baseUrl}docentes-dropdown/${_}`)}getInstitutionsDropdown(){return this.http.get(`${this.baseUrl}institutions-dropdown`)}static#t=this.\u0275fac=function(F){return new(F||o)(t.KVO(e.Qq),t.KVO(e.Qq),t.KVO(e.JV))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},5489:($,A,a)=>{a.d(A,{Y:()=>M});var e=a(1626),i=a(3587),t=a(7019);let M=(()=>{class o{constructor(_,F,I){this.http=_,this.httpClientFormData=F,this.handler=I,this.baseUrl=`${i.c.API_BASE}`,this.urlparametro=`${i.c.API_BASE}`,this.httpOptions={headers:new e.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new e.Qq(this.handler)}getCursosPorAlumno(_){return this.http.get(`${this.baseUrl}cursos-alumno/${_}`)}getCursosPorDomain(_){return this.http.get(`${this.baseUrl}cursos/domain/${_}`,this.httpOptions)}updateCursoEstado(_){return this.http.put(`${this.baseUrl}curso/estado`,_)}static#t=this.\u0275fac=function(F){return new(F||o)(t.KVO(e.Qq),t.KVO(e.Qq),t.KVO(e.JV))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()},7064:($,A,a)=>{a.d(A,{Y:()=>M});var e=a(1626),i=a(3587),t=a(7019);let M=(()=>{class o{constructor(_,F,I){this.http=_,this.httpClientFormData=F,this.handler=I,this.baseUrl=`${i.c.API_BASE}`,this.urlparametro=`${i.c.API_BASE}`,this.httpOptions={headers:new e.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new e.Qq(this.handler)}saveForo(_){return this.http.post(`${this.baseUrl}foros`,_)}getForos(_,F,I){return this.http.get(`${this.baseUrl}foros/${_}/${F}/${I}`)}sendResponse(_){return this.http.post(`${this.baseUrl}foros/message`,_)}static#t=this.\u0275fac=function(F){return new(F||o)(t.KVO(e.Qq),t.KVO(e.Qq),t.KVO(e.JV))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})()}}]);