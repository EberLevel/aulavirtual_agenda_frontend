"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[6497],{8878:(P,c,a)=>{a.r(c),a.d(c,{HorarioModule:()=>J});var p=a(177),d=a(9417),g=a(8763),M=a(9423),T=a(5833),j=a(1710),e=a(7019),h=a(6653),D=a(8774),v=a(6064),m=a(6781),b=a(5779),u=a(1305),f=a(612),E=a(2242),_=a(8150),C=a(6554);function F(o,l){if(1&o&&(e.j41(0,"span",8),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(1),e.JRh("display"===t.view?t.changedEvent.title:"new"===t.view?"Nuevo Evento":"Editar Evento")}}function k(o,l){if(1&o&&(e.j41(0,"div")(1,"div",10)(2,"div",11)(3,"div",12),e.EFF(4,"Inicio"),e.k0s(),e.j41(5,"p",13),e.nrm(6,"i",14),e.j41(7,"span"),e.EFF(8),e.k0s()()(),e.j41(9,"div",11)(10,"div",12),e.EFF(11,"Fin"),e.k0s(),e.j41(12,"p",13),e.nrm(13,"i",14),e.j41(14,"span"),e.EFF(15),e.k0s()()(),e.j41(16,"div",15)(17,"div",12),e.EFF(18,"Color"),e.k0s(),e.j41(19,"p",13),e.nrm(20,"span",16),e.j41(21,"span"),e.EFF(22),e.k0s()()()()()),2&o){const t=e.XpG(2);e.R7$(8),e.JRh(t.changedEvent.start.toISOString().slice(0,10)),e.R7$(7),e.JRh(t.changedEvent.end.toISOString().slice(0,10)),e.R7$(5),e.xc7("background-color",t.changedEvent.tag.color),e.R7$(2),e.JRh(t.changedEvent.tag.name)}}function S(o,l){if(1&o&&(e.j41(0,"div",38),e.nrm(1,"div",39),e.j41(2,"div"),e.EFF(3),e.k0s()()),2&o){const t=e.XpG(4);e.R7$(1),e.xc7("background-color",t.changedEvent.tag.color),e.R7$(2),e.JRh(t.changedEvent.tag.name)}}function I(o,l){if(1&o&&e.DNE(0,S,4,3,"div",37),2&o){const t=e.XpG(3);e.Y8G("ngIf",t.changedEvent.tag)}}function G(o,l){if(1&o&&(e.j41(0,"div",38),e.nrm(1,"div",39),e.j41(2,"div"),e.EFF(3),e.k0s()()),2&o){const t=l.$implicit;e.R7$(1),e.xc7("background-color",t.color),e.R7$(2),e.JRh(t.name)}}function R(o,l){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"div",17)(2,"div",18)(3,"label",19),e.EFF(4,"T\xedtulo"),e.k0s(),e.j41(5,"span",20),e.nrm(6,"i",21),e.j41(7,"input",22),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.title=i)}),e.k0s()()(),e.j41(8,"div",18)(9,"label",23),e.EFF(10,"Ubicaci\xf3n"),e.k0s(),e.j41(11,"span",20),e.nrm(12,"i",24),e.j41(13,"input",25),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.location=i)}),e.k0s()()(),e.j41(14,"div",26)(15,"label",27),e.EFF(16,"Descripci\xf3n del evento"),e.k0s(),e.j41(17,"textarea",28),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.description=i)}),e.k0s()(),e.j41(18,"div",18)(19,"label",29),e.EFF(20,"Fecha de Inicio"),e.k0s(),e.j41(21,"p-calendar",30),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.start=i)}),e.k0s()(),e.j41(22,"div",18)(23,"label",31),e.EFF(24,"Fecha Fin"),e.k0s(),e.j41(25,"p-calendar",32),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.end=i)}),e.k0s()(),e.j41(26,"div",26)(27,"label",33),e.EFF(28,"Color"),e.k0s(),e.j41(29,"p-dropdown",34),e.bIt("ngModelChange",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.changedEvent.tag=i)}),e.DNE(30,I,1,1,"ng-template",35),e.DNE(31,G,4,3,"ng-template",36),e.k0s()()()()}if(2&o){const t=e.XpG(2),n=e.sdS(4);e.R7$(7),e.Y8G("ngModel",t.changedEvent.title),e.R7$(6),e.Y8G("ngModel",t.changedEvent.location),e.R7$(4),e.Y8G("rows",5)("ngModel",t.changedEvent.description),e.R7$(4),e.Y8G("appendTo",n)("maxDate",t.changedEvent.end)("showTime",!0)("required",!0)("ngModel",t.changedEvent.start),e.R7$(4),e.Y8G("appendTo",n)("minDate",t.changedEvent.start)("showTime",!0)("required",!0)("ngModel",t.changedEvent.end),e.R7$(4),e.Y8G("appendTo",n)("options",t.tags)("ngModel",t.changedEvent.tag)}}function $(o,l){if(1&o&&(e.DNE(0,k,23,5,"div",9),e.DNE(1,R,32,17,"div",9)),2&o){const t=e.XpG();e.Y8G("ngIf","display"===t.view),e.R7$(1),e.Y8G("ngIf","display"!==t.view)}}function H(o,l){}const w=function(){return{width:"36rem"}},N=function(){return{"960px":"75vw","640px":"90vw"}};let O=(()=>{class o{constructor(t,n){this.eventService=t,this.helpersService=n,this.events=[],this.today="",this.calendarOptions={initialView:"dayGridMonth"},this.showDialog=!1,this.clickedEvent=null,this.dateClicked=!1,this.edit=!1,this.tags=[],this.view="",this.courseStyles={}}ngOnInit(){this.today=(new Date).toISOString().split("T")[0];const t={docente_id:this.helpersService.getDocenteId()??1,domain_id:this.helpersService.getDominioId()};this.eventService.getEventsDocente(t).subscribe(n=>{this.events=this.getEventsDocente(n),this.calendarOptions={...this.calendarOptions,events:this.events},this.tags=this.events.map(i=>{if(!this.tags.includes(i.tag))return i.tag}).filter(i=>void 0!==i)}),this.calendarOptions={plugins:[M.A,j.A,T.Ay],height:720,initialDate:this.today,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:n=>this.onEventClick(n),select:n=>this.onDateSelect(n),events:this.events}}getEventsDocente(t){return console.log(t),t.map(n=>{const i=Array.isArray(n.horarios)?n.horarios:JSON.parse(n.horarios);return this.generateEventDetails(i,n.nombre)}).flat()}generateEventDetails(t,n){const i=[],r=this.getCourseStyles(n);return t.forEach(s=>{const x=new Date(`${s.fecha_inicio}T${s.hora_inicio}`),U=new Date(`${s.fecha_fin}T${s.hora_fin}`),y=s.day_id;i.push({day_name:this.getDayName(y),date:this.addDays(x,y).toISOString().split("T")[0],start:x,end:U,tag:{color:r.backgroundColor,name:n},title:n,borderColor:r.borderColor,backgroundColor:r.backgroundColor,textColor:r.textColor,extendedProps:{docente:s.docente_name,aulaUbicacion:s.aula_ubication,aulaName:s.aula_name}})}),i}getCourseStyles(t){if(this.courseStyles[t])return this.courseStyles[t];const n=this.generateStyles();return this.courseStyles[t]=n,n}getDayName(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t%7]}addDays(t,n){const i=new Date(t);return i.setDate(i.getDate()+n),i}generateStyles(){const n=["#f9e79f","#a3e4d7","#abebc6","#f5b041","#ec7063","#cacfd2"],i=["#000000"],r=n[Math.floor(Math.random()*n.length)];return{backgroundColor:r,borderColor:r,textColor:i[Math.floor(Math.random()*i.length)]}}onEventClick(t){this.clickedEvent=t.event;let n=t.event.toPlainObject({collapseExtendedProps:!0,collapseColor:!0});this.view="display",this.showDialog=!0,console.log(n),this.changedEvent={...n,...this.clickedEvent},this.changedEvent.start=this.clickedEvent.start,this.changedEvent.end=this.clickedEvent.end?this.clickedEvent.end:this.clickedEvent.start}onDateSelect(t){}handleSave(){this.validate()&&(this.showDialog=!1,this.clickedEvent={...this.changedEvent,backgroundColor:this.changedEvent.tag.color,borderColor:this.changedEvent.tag.color,textColor:"#212121"},this.events=this.clickedEvent.hasOwnProperty("id")?this.events.map(t=>t.id.toString()===this.clickedEvent.id.toString()?t=this.clickedEvent:t):[...this.events,{...this.clickedEvent,id:Math.floor(1e4*Math.random())}],this.calendarOptions={...this.calendarOptions,events:this.events},this.clickedEvent=null)}onEditClick(){this.view="edit"}delete(){this.events=this.events.filter(t=>t.id.toString()!==this.clickedEvent.id.toString()),this.calendarOptions={...this.calendarOptions,events:this.events},this.showDialog=!1}validate(){let{start:t,end:n}=this.changedEvent;return t&&n}static#e=this.\u0275fac=function(n){return new(n||o)(e.rXU(h.U),e.rXU(D.V))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["ng-component"]],decls:8,vars:9,consts:[[1,"card"],[3,"options"],["bdColor","rgba(0,0,0,0.5)","size","large","color","#fff","type","ball-spin"],[3,"visible","breakpoints","modal","closable","visibleChange","onHide"],["dd",""],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"text-900","font-semibold","text-xl"],[4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"text-900","font-semibold","mb-2"],[1,"flex","align-items-center","m-0"],[1,"pi","pi-fw","pi-clock","text-700","mr-2"],[1,"col-12"],[1,"inline-flex","flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"],[1,"grid","p-fluid","formgrid"],[1,"col-12","md:col-6","field"],["for","title",1,"text-900","font-semibold"],[1,"p-input-icon-left"],[1,"pi","pi-pencil"],["id","title","type","text","pInputText","","placeholder","T\xedtulo",3,"ngModel","ngModelChange"],["for","location",1,"text-900","font-semibold"],[1,"pi","pi-map-marker"],["id","location","type","text","pInputText","","placeholder","Ubicaci\xf3n",3,"ngModel","ngModelChange"],[1,"col-12","field"],["for","description",1,"text-900","font-semibold"],["id","description","type","text","pInputTextarea","",2,"resize","none",3,"rows","ngModel","ngModelChange"],["for","start",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","start",3,"appendTo","maxDate","showTime","required","ngModel","ngModelChange"],["for","end",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","end",3,"appendTo","minDate","showTime","required","ngModel","ngModelChange"],["for","company-color",1,"text-900","font-semibold"],["inputId","company-color","optionLabel","name",3,"appendTo","options","ngModel","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"]],template:function(n,i){1&n&&(e.j41(0,"div",0),e.nrm(1,"full-calendar",1)(2,"ngx-spinner",2),e.j41(3,"p-dialog",3,4),e.bIt("visibleChange",function(s){return i.showDialog=s})("onHide",function(){return i.view=""}),e.DNE(5,F,2,1,"ng-template",5),e.DNE(6,$,2,2,"ng-template",6),e.DNE(7,H,0,0,"ng-template",7),e.k0s()()),2&n&&(e.R7$(1),e.Y8G("options",i.calendarOptions),e.R7$(2),e.Aen(e.lJ4(7,w)),e.Y8G("visible",i.showDialog)("breakpoints",e.lJ4(8,N))("modal",!0)("closable",!0))},dependencies:[p.bT,d.me,d.BC,d.YS,d.vS,v.x,m.l,b.Ei,u.Z,f.Vv,E.S,_.ms,C.et]})}return o})(),X=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.$C({type:o});static#n=this.\u0275inj=e.G2t({imports:[g.iI.forChild([{path:"",component:O}]),g.iI]})}return o})();var Y=a(1141),V=a(563),B=a(9998);let J=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.$C({type:o});static#n=this.\u0275inj=e.G2t({providers:[h.U],imports:[p.MD,d.YN,X,v.E,m.P,u.f,Y.tm,f.rO,E.u,_.kr,B.MB,V.Z,C.PO]})}return o})()}}]);