"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[1548],{1548:(Ce,R,r)=>{r.r(R),r.d(R,{ListaRolesModule:()=>je});var m=r(177),_=r(8763),M=r(8032),g=r.n(M),e=r(7019),f=r(5779),j=r(9664),u=r(2100),b=r(3088),h=r(5473),d=r(9417),C=r(1141),x=r(2242);function O(t,a){1&t&&(e.j41(0,"span",2),e.EFF(1,"Registrar institutos"),e.k0s())}function F(t,a){if(1&t){const i=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6),e.nrm(4,"i",7),e.j41(5,"input",8),e.bIt("ngModelChange",function(n){e.eBV(i);const s=e.XpG();return e.Njj(s.nombre=n)}),e.k0s(),e.j41(6,"label",9),e.EFF(7,"Nombre del rol"),e.k0s()(),e.j41(8,"small",10),e.EFF(9,"Campo obligatorio *"),e.k0s()()()(),e.j41(10,"div",11)(11,"button",12),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.Guardaruser())}),e.k0s(),e.j41(12,"button",13),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.closeModal())}),e.k0s()()}if(2&t){const i=e.XpG();e.R7$(5),e.Y8G("ngModel",i.nombre)}}let S=(()=>{class t{constructor(i,o,n,s,l,c){this.router=i,this.primengConfig=o,this.translate=n,this.ref=s,this.rolService=l,this.config=c,this.visible=!1,this.id=0,this.nombre="",this.config.data?(this.id=this.config.data.id,this.nombre=this.config.data.nombre):(this.id=0,this.nombre="")}Guardaruser(){const i={nombre:this.nombre};this.id>0?this.rolService.actualizarRol(i,this.id).subscribe(o=>{this.closeModal(),g().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{this.router.navigate([this.router.url])})},o=>{console.error("Error al guardar el rol",o)}):(this.rolService.guardarRol(i).subscribe(o=>{this.closeModal(),g().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{this.router.navigate([this.router.url])})},o=>{console.error("Error al guardar el rol",o)}),g().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{}))}closeDialog(){this.visible=!1}closeModal(){this.ref.close({register:!1})}static#e=this.\u0275fac=function(o){return new(o||t)(e.rXU(_.Ix),e.rXU(f.r1),e.rXU(j.c$),e.rXU(u.Pw),e.rXU(b.O),e.rXU(u.sb))};static#o=this.\u0275cmp=e.VBU({type:t,selectors:[["app-registra-rol"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-6"],[1,"p-float-label","p-input-icon-left"],[1,"pi","pi-user-edit"],["type","text","id","director","pInputText","",3,"ngModel","ngModelChange"],["for","director"],[2,"color","brown"],[1,"row","mb-5","text-right"],["pButton","","label","Guardar","icon","pi pi-plus","id","btnGuardar",1,"p-button-success","mr-2",3,"click"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"p-panel"),e.DNE(1,O,2,0,"ng-template",0),e.DNE(2,F,13,1,"ng-template",1),e.k0s())},dependencies:[h.Z,f.Ei,d.me,d.BC,d.vS,C._f,x.S]})}return t})();var v=r(9280),E=r(8150),k=r(8774);function D(t,a){if(1&t){const i=e.RV6();e.j41(0,"p-dropdown",5),e.bIt("ngModelChange",function(n){e.eBV(i);const s=e.XpG(2);return e.Njj(s.selectedInstitucion=n)})("onChange",function(n){e.eBV(i);const s=e.XpG(2);return e.Njj(s.onInstitucionChange(n))}),e.k0s()}if(2&t){const i=e.XpG(2);e.Y8G("options",i.instituciones)("ngModel",i.selectedInstitucion)}}function B(t,a){if(1&t&&(e.j41(0,"div",2)(1,"span",3),e.EFF(2,"Asignar permiso"),e.k0s(),e.DNE(3,D,1,2,"p-dropdown",4),e.k0s()),2&t){const i=e.XpG();e.R7$(3),e.Y8G("ngIf",!i.domain_id)}}function $(t,a){1&t&&e.eu8(0)}const V=function(t,a){return{$implicit:t,grupo:a}};function X(t,a){if(1&t&&(e.qex(0),e.DNE(1,$,1,0,"ng-container",24),e.bVm()),2&t){const i=a.$implicit,o=e.XpG(2).$implicit,n=e.sdS(12);e.R7$(1),e.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",e.l_i(2,V,i,o))}}function U(t,a){if(1&t&&(e.j41(0,"div",22),e.DNE(1,X,2,5,"ng-container",23),e.k0s()),2&t){const i=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",i.permisos)}}const y=function(t){return{"rotate-icon":t}};function w(t,a){if(1&t){const i=e.RV6();e.j41(0,"button",14),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit;return e.Njj(n.isExpanded=!n.isExpanded)}),e.qSk(),e.j41(1,"svg",15)(2,"g",16)(3,"g"),e.nrm(4,"path",30),e.k0s()()()()}if(2&t){const i=e.XpG().$implicit;e.R7$(1),e.Y8G("ngClass",e.eq3(1,y,i.isExpanded))}}function Y(t,a){1&t&&e.eu8(0)}function z(t,a){if(1&t&&(e.qex(0),e.DNE(1,Y,1,0,"ng-container",24),e.bVm()),2&t){const i=a.$implicit,o=e.XpG(2).grupo;e.XpG();const n=e.sdS(12);e.R7$(1),e.Y8G("ngTemplateOutlet",n)("ngTemplateOutletContext",e.l_i(2,V,i,o))}}function J(t,a){if(1&t&&(e.j41(0,"div",31),e.DNE(1,z,2,5,"ng-container",23),e.k0s()),2&t){const i=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",i.hijos)}}function Z(t,a){if(1&t){const i=e.RV6();e.j41(0,"div",25)(1,"div",26),e.DNE(2,w,5,3,"button",27),e.j41(3,"input",18),e.bIt("ngModelChange",function(n){const l=e.eBV(i).$implicit;return e.Njj(l.seleccionado=n)})("change",function(n){const s=e.eBV(i),l=s.$implicit,c=s.grupo,P=e.XpG(3);return e.Njj(P.onCheckboxChange(l.id,n,c,l.proyecto_id))}),e.k0s(),e.j41(4,"span",28),e.EFF(5),e.k0s()(),e.DNE(6,J,2,1,"div",29),e.k0s()}if(2&t){const i=a.$implicit;e.R7$(2),e.Y8G("ngIf",i.hijos&&i.hijos.length>0),e.R7$(1),e.Y8G("ngModel",i.seleccionado),e.R7$(2),e.JRh(i.nombre),e.R7$(1),e.Y8G("ngIf",i.hijos&&i.hijos.length>0&&i.isExpanded)}}function H(t,a){if(1&t){const i=e.RV6();e.j41(0,"div",12)(1,"div",13)(2,"button",14),e.bIt("click",function(){const s=e.eBV(i).$implicit;return e.Njj(s.expanded=!s.expanded)}),e.qSk(),e.j41(3,"svg",15)(4,"g",16)(5,"g"),e.nrm(6,"path",17),e.k0s()()()(),e.joV(),e.j41(7,"input",18),e.bIt("ngModelChange",function(n){const l=e.eBV(i).$implicit;return e.Njj(l.seleccionado=n)})("change",function(){const s=e.eBV(i).$implicit,l=e.XpG(2);return e.Njj(l.seleccionarGrupo(s))}),e.k0s(),e.j41(8,"span",19),e.EFF(9),e.k0s()(),e.DNE(10,U,2,1,"div",20),e.DNE(11,Z,7,4,"ng-template",null,21,e.C5r),e.k0s()}if(2&t){const i=a.$implicit;e.R7$(3),e.Y8G("ngClass",e.eq3(4,y,i.expanded)),e.R7$(4),e.Y8G("ngModel",i.seleccionado),e.R7$(2),e.JRh(i.nombre),e.R7$(1),e.Y8G("ngIf",i.expanded)}}function W(t,a){if(1&t){const i=e.RV6();e.j41(0,"div",6)(1,"div",7)(2,"div",8),e.DNE(3,H,13,6,"div",9),e.j41(4,"div",10)(5,"button",11),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.guardarPermisos())}),e.EFF(6," Guardar "),e.k0s()()()()()}if(2&t){const i=e.XpG();e.R7$(3),e.Y8G("ngForOf",i.permisosAgrupados)}}let K=(()=>{class t{constructor(i,o,n,s,l,c,P){this.router=i,this.primengConfig=o,this.translate=n,this.ref=s,this.permisoService=l,this.config=c,this.helpersService=P,this.visible=!1,this.nombre="",this.permisosAgrupados=[],this.instituciones=[],this.permisosSeleccionados=new Set,this.proyectos=[],this.domain_id=this.helpersService.getDominioId(),this.permisoService.getPermisos(this.domain_id).subscribe(p=>{this.permisos=p,this.organizarPermisosPorGrupo()}),this.permisoService.getEmpresasDropdown().subscribe(p=>{this.instituciones=p}),this.idRol=c.data,this.domain_id&&this.permisoService.getRolPermisos(this.idRol,this.domain_id).subscribe(p=>{this.permisosSeleccionados=new Set(p.map(L=>({permiso_id:L.id,proyecto_id:L.proyect_id??null}))),this.organizarPermisosPorGrupo()}),this.permisoService.getProyectos().subscribe(p=>{this.proyectos=p.data,this.organizarPermisosPorGrupo()})}toggleGrupo(i){i.expanded=!i.expanded}onInstitucionChange(i){this.selectedInstitucion=i.value,this.permisoService.getRolPermisos(this.idRol,this.selectedInstitucion??1).subscribe(o=>{this.permisosSeleccionados=new Set(o.map(n=>({permiso_id:n.id,proyecto_id:n.proyecto_id??null}))),this.organizarPermisosPorGrupo()})}onCheckboxChange(i,o,n,s=null){if(null===i)return void console.warn(`Permiso con ID nulo detectado en el grupo ${n.nombre}`);const l=o.target.checked,c=this.findPermisoById(n.permisos,i);c&&this.togglePermisoSeleccion(c,l,s),this.verificarSeleccionGrupo(n)}togglePermisoSeleccion(i,o,n=null){if(i.seleccionado=o,i.hijos&&i.hijos.length>0&&i.hijos.forEach(s=>{this.togglePermisoSeleccion(s,o,n??null)}),null!==i.id)if(o)this.permisosSeleccionados.add({permiso_id:i.id,proyecto_id:n??null});else{const s={permiso_id:i.id,proyecto_id:n??null};this.permisosSeleccionados.forEach(l=>{l.permiso_id===s.permiso_id&&l.proyecto_id===s.proyecto_id&&this.permisosSeleccionados.delete(l)})}}verificarSeleccionGrupo(i){i.seleccionado=i.permisos.every(o=>this.verificarSeleccionPermiso(o))}verificarSeleccionPermiso(i){return i.hijos&&i.hijos.length>0?i.hijos.every(o=>this.verificarSeleccionPermiso(o)):i.seleccionado}ngOnInit(){this.organizarPermisosPorGrupo()}findPermisoById(i,o){if(null===o)return console.warn("Intento de b\xfasqueda de un permiso con ID nulo"),null;for(const n of i){if(n.id===o)return n;if(n.hijos&&n.hijos.length>0){const s=this.findPermisoById(n.hijos,o);if(s)return s}}return null}toggleGroup(i){i.isExpanded=!i.isExpanded}guardarPermisos(){const i={id:this.idRol,idPermisos:Array.from(this.permisosSeleccionados),domain_id:this.domain_id??this.selectedInstitucion};console.log(i),this.permisoService.guardarRolPermisos(i).subscribe(o=>{this.closeModal(),g().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{})},o=>{console.error("Error al guardar el rol",o)})}seleccionarGrupo(i){i.permisos.forEach(o=>{this.togglePermisoSeleccion(o,i.seleccionado),o.hijos&&o.hijos.length>0&&o.hijos.forEach(n=>{this.togglePermisoSeleccion(n,i.seleccionado)})})}organizarPermisosPorGrupo(){const i={Seguridad:{nombre:"Seguridad",id:null,seleccionado:!1,permisos:[{id:null,nombre:"Configuraci\xf3n",seleccionado:!1,hijos:[]},{id:null,nombre:"Roles y Permisos",seleccionado:!1,permisosInternos:[{id:null,nombre:"Crear Rol",seleccionado:!1},{id:null,nombre:"Editar Rol",seleccionado:!1},{id:null,nombre:"Eliminar Rol",seleccionado:!1},{id:null,nombre:"Asignar Permiso",seleccionado:!1},{id:null,nombre:"Ver Roles",seleccionado:!1}],isExpanded:!1},{id:10,nombre:"Usuarios",seleccionado:!1,hijos:[{id:11,nombre:"Nuevo",seleccionado:!1},{id:12,nombre:"Ver",seleccionado:!1},{id:13,nombre:"Editar",seleccionado:!1},{id:14,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1},EstructuraOrganica:{nombre:"ESTRUCTURA ORG\xc1NICA",id:null,seleccionado:!1,permisos:[{id:null,nombre:"Mantenimientos",seleccionado:!1,hijos:[]},{id:null,nombre:"Instituciones",seleccionado:!1,hijos:[{id:17,nombre:"Nuevo",seleccionado:!1},{id:18,nombre:"Ver",seleccionado:!1},{id:null,nombre:"Editar",seleccionado:!1},{id:null,nombre:"Eliminar",seleccionado:!1},{id:21,nombre:"\xc1REAS",seleccionado:!1,hijos:[{id:22,nombre:"Nuevo",seleccionado:!1},{id:23,nombre:"Ver",seleccionado:!1},{id:24,nombre:"Editar",seleccionado:!1},{id:25,nombre:"Eliminar",seleccionado:!1},{id:26,nombre:"PUESTOS Y PERFILES",seleccionado:!1,hijos:[{id:27,nombre:"Nuevo",seleccionado:!1},{id:28,nombre:"Ver",seleccionado:!1},{id:29,nombre:"Editar",seleccionado:!1},{id:30,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1}],isExpanded:!1},{id:95,nombre:"Banco de CV",seleccionado:!1,hijos:[{id:96,nombre:"Nuevo",seleccionado:!1},{id:97,nombre:"Ver",seleccionado:!1},{id:98,nombre:"Editar",seleccionado:!1},{id:99,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1},{id:100,nombre:"Bolsa de Trabajo",seleccionado:!1,hijos:[{id:101,nombre:"Nuevo",seleccionado:!1},{id:102,nombre:"Ver",seleccionado:!1},{id:103,nombre:"Editar",seleccionado:!1},{id:104,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1},AulaVirtual:{nombre:"AULA VIRTUAL",id:null,seleccionado:!1,permisos:[{id:null,nombre:"MANTENIMIENTOS",seleccionado:!1,hijos:[],isExpanded:!1},{id:null,nombre:"CARRERAS T\xc9CNICAS",seleccionado:!1,hijos:[{id:33,nombre:"Nuevo",seleccionado:!1},{id:34,nombre:"Editar",seleccionado:!1},{id:35,nombre:"Ver",seleccionado:!1},{id:36,nombre:"Eliminar",seleccionado:!1},{id:37,nombre:"CURSO",seleccionado:!1,hijos:[{id:38,nombre:"Nuevo",seleccionado:!1},{id:39,nombre:"Editar",seleccionado:!1},{id:40,nombre:"Ver",seleccionado:!1},{id:41,nombre:"Eliminar",seleccionado:!1},{id:42,nombre:"SYLLABUS",seleccionado:!1,hijos:[{id:43,nombre:"Ver",seleccionado:!1}],isExpanded:!1},{id:44,nombre:"ALUMNOS",seleccionado:!1,hijos:[{id:45,nombre:"Ver",seleccionado:!1},{id:46,nombre:"Asignar",seleccionado:!1}],isExpanded:!1},{id:47,nombre:"HORARIOS",seleccionado:!1,hijos:[{id:48,nombre:"Ver",seleccionado:!1},{id:49,nombre:"Programar",seleccionado:!1}],isExpanded:!1},{id:50,nombre:"ASISTENCIA",seleccionado:!1,hijos:[{id:51,nombre:"Ver",seleccionado:!1},{id:52,nombre:"Programar",seleccionado:!1}],isExpanded:!1},{id:53,nombre:"TEMAS",seleccionado:!1,hijos:[{id:54,nombre:"Ver",seleccionado:!1}],isExpanded:!1},{id:55,nombre:"GRUPOS DE EVALUACIONES",seleccionado:!1,hijos:[{id:56,nombre:"Nuevo",seleccionado:!1},{id:57,nombre:"Editar",seleccionado:!1},{id:58,nombre:"Ver",seleccionado:!1},{id:59,nombre:"Eliminar",seleccionado:!1},{id:60,nombre:"EVALUACIONES DE GRUPO",seleccionado:!1,hijos:[{id:61,nombre:"Nuevo",seleccionado:!1},{id:62,nombre:"Editar",seleccionado:!1},{id:63,nombre:"Ver",seleccionado:!1},{id:64,nombre:"Eliminar",seleccionado:!1},{id:65,nombre:"PREGUNTAS",seleccionado:!1,hijos:[{id:66,nombre:"Nuevo",seleccionado:!1},{id:67,nombre:"Editar",seleccionado:!1},{id:68,nombre:"Ver",seleccionado:!1},{id:69,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1}],isExpanded:!1}],isExpanded:!1}],isExpanded:!1},{id:null,nombre:"ALUMNOS",seleccionado:!1,hijos:[{id:null,nombre:"Datos Personales",seleccionado:!1,hijos:[{id:72,nombre:"Nuevo",seleccionado:!1},{id:73,nombre:"Editar",seleccionado:!1},{id:74,nombre:"Ver",seleccionado:!1},{id:75,nombre:"Eliminar",seleccionado:!1}]},{id:76,nombre:"Documentos de Gesti\xf3n",seleccionado:!1,hijos:[{id:77,nombre:"Nuevo",seleccionado:!1},{id:78,nombre:"Editar",seleccionado:!1},{id:79,nombre:"Ver",seleccionado:!1},{id:80,nombre:"Eliminar",seleccionado:!1}]},{id:81,nombre:"Avance Curricular",seleccionado:!1,hijos:[{id:82,nombre:"Editar",seleccionado:!1},{id:83,nombre:"Ver",seleccionado:!1}]},{id:84,nombre:"Cursos",seleccionado:!1},{id:85,nombre:"Horarios",seleccionado:!1}],isExpanded:!1},{id:null,nombre:"DOCENTES",seleccionado:!1,hijos:[{id:null,nombre:"Datos Personales",seleccionado:!1,hijos:[{id:88,nombre:"Nuevo",seleccionado:!1},{id:89,nombre:"Editar",seleccionado:!1},{id:90,nombre:"Ver",seleccionado:!1},{id:91,nombre:"Eliminar",seleccionado:!1}]},{id:92,nombre:"Horarios",seleccionado:!1,hijos:[{id:93,nombre:"Editar",seleccionado:!1}]},{id:94,nombre:"Cursos",seleccionado:!1}],isExpanded:!1},{id:null,nombre:"CAPACITACIONES",seleccionado:!1,hijos:[{id:33,nombre:"Nuevo",seleccionado:!1},{id:34,nombre:"Editar",seleccionado:!1},{id:35,nombre:"Ver",seleccionado:!1},{id:36,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1},Proyectos:{nombre:"PROYECTOS",id:null,seleccionado:!1,permisos:[{id:23,nombre:"NUEVO",seleccionado:!1,hijos:[],isExpanded:!1},{id:22,nombre:"EDITAR",seleccionado:!1,hijos:[],isExpanded:!1},{id:21,nombre:"VER",seleccionado:!1,hijos:[],isExpanded:!1},{id:24,nombre:"ELIMINAR",seleccionado:!1,hijos:[],isExpanded:!1},{id:null,nombre:"LISTADO DE PROYECTOS",seleccionado:!1,hijos:this.proyectos.map(o=>({id:o.id,nombre:o.nombre,seleccionado:!1,hijos:[{id:null,nombre:"TAREAS",seleccionado:!1,hijos:[{id:25,nombre:"NUEVO",seleccionado:this.buscarPermiso(25,o.id),hijos:[],isExpanded:!1,proyecto_id:o.id},{id:26,nombre:"EDITAR",seleccionado:this.buscarPermiso(26,o.id),hijos:[],isExpanded:!1,proyecto_id:o.id},{id:27,nombre:"VER",seleccionado:this.buscarPermiso(27,o.id),hijos:[],isExpanded:!1,proyecto_id:o.id},{id:28,nombre:"ELIMINAR",seleccionado:this.buscarPermiso(28,o.id),hijos:[],isExpanded:!1,proyecto_id:o.id}]}],isExpanded:!1})),isExpanded:!1}],isExpanded:!1},AgendaVirtual:{nombre:"AGENDA VIRTUAL",id:null,seleccionado:!1,permisos:[{id:null,nombre:"CANDIDATOS",seleccionado:!1,hijos:[{id:29,nombre:"Nuevo",seleccionado:!1},{id:30,nombre:"Ver",seleccionado:!1},{id:31,nombre:"Editar",seleccionado:!1},{id:32,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1},{id:null,nombre:"CIUDADES",seleccionado:!1,hijos:[{id:33,nombre:"Nuevo",seleccionado:!1},{id:34,nombre:"Ver",seleccionado:!1},{id:35,nombre:"Editar",seleccionado:!1},{id:36,nombre:"Eliminar",seleccionado:!1}],isExpanded:!1}],isExpanded:!1}};this.permisos.forEach(o=>{switch(o.nombre){case"ver_modulo_seguridad":i.Seguridad.id=o.id,i.Seguridad.seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_seguridad_configuracion":i.Seguridad.permisos[0].id=o.id,i.Seguridad.permisos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"roles_crearRol":i.Seguridad.permisos[1].permisosInternos[0].id=o.id,i.Seguridad.permisos[1].permisosInternos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"roles_editarRol":i.Seguridad.permisos[1].permisosInternos[1].id=o.id,i.Seguridad.permisos[1].permisosInternos[1].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"roles_eliminarRol":i.Seguridad.permisos[1].permisosInternos[2].id=o.id,i.Seguridad.permisos[1].permisosInternos[2].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"roles_asignarPermiso":i.Seguridad.permisos[1].permisosInternos[3].id=o.id,i.Seguridad.permisos[1].permisosInternos[3].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_seguridad_roles":i.Seguridad.permisos[1].permisosInternos[4].id=o.id,i.Seguridad.permisos[1].permisosInternos[4].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_alumno":i.AulaVirtual.permisos[2].id=o.id,i.AulaVirtual.permisos[2].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_mantenimientos":i.AulaVirtual.permisos[0].id=o.id,i.AulaVirtual.permisos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_capacitaciones":i.AulaVirtual.permisos[4].id=o.id,i.AulaVirtual.permisos[4].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_modulo_estructura_organica":i.EstructuraOrganica.id=o.id,i.EstructuraOrganica.seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_docente_datos_personales":i.AulaVirtual.permisos[3].hijos[0].id=o.id,i.AulaVirtual.permisos[3].hijos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_modulo_aulaVirtual":i.AulaVirtual.id=o.id,i.AulaVirtual.seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_carreras":i.AulaVirtual.permisos[1].id=o.id,i.AulaVirtual.permisos[1].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_alumno_datos_personales":i.AulaVirtual.permisos[2].hijos[0].id=o.id,i.AulaVirtual.permisos[2].hijos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"aula_virtual_docente":i.AulaVirtual.permisos[3].id=o.id,i.AulaVirtual.permisos[3].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"nuevo_modulo_proyecto":i.Proyectos.permisos[0].id=o.id,i.Proyectos.permisos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"editar_modulo_proyecto":i.Proyectos.permisos[1].id=o.id,i.Proyectos.permisos[1].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_modulo_proyecto":i.Proyectos.permisos[2].id=o.id,i.Proyectos.permisos[2].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"eliminar_modulo_proyecto":i.Proyectos.permisos[3].id=o.id,i.Proyectos.permisos[3].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"nuevo_modulo_candidatos":i.AgendaVirtual.permisos[0].hijos[0].id=o.id,i.AgendaVirtual.permisos[0].hijos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_modulo_candidatos":i.AgendaVirtual.permisos[0].hijos[1].id=o.id,i.AgendaVirtual.permisos[0].hijos[1].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"editar_modulo_candidatos":i.AgendaVirtual.permisos[0].hijos[2].id=o.id,i.AgendaVirtual.permisos[0].hijos[2].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"eliminar_modulo_candidatos":i.AgendaVirtual.permisos[0].hijos[3].id=o.id,i.AgendaVirtual.permisos[0].hijos[3].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"nuevo_modulo_ciudades":i.AgendaVirtual.permisos[1].hijos[0].id=o.id,i.AgendaVirtual.permisos[1].hijos[0].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"ver_modulo_ciudades":i.AgendaVirtual.permisos[1].hijos[1].id=o.id,i.AgendaVirtual.permisos[1].hijos[1].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"editar_modulo_ciudades":i.AgendaVirtual.permisos[1].hijos[2].id=o.id,i.AgendaVirtual.permisos[1].hijos[2].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null);break;case"eliminar_modulo_ciudades":i.AgendaVirtual.permisos[1].hijos[3].id=o.id,i.AgendaVirtual.permisos[1].hijos[3].seleccionado=this.buscarPermiso(o.id,o.proyecto_id??null)}}),i.Proyectos.permisos[4].hijos.forEach(o=>{console.log("permisos",this.permisosSeleccionados),console.log("tareas de proyectos",o.hijos[0].hijos)}),this.permisosAgrupados=Object.values(i),this.propagateSelection(this.permisosAgrupados),this.permisosAgrupados.forEach(o=>{this.verificarSeleccionGrupo(o)})}buscarPermiso(i,o){for(const n of this.permisosSeleccionados)if(n.permiso_id===i&&(n.proyecto_id??null)===o)return!0;return!1}propagateSelection(i){i.forEach(o=>{o.seleccionado&&o.hijos&&o.hijos.length>0&&this.togglePermisoSeleccion(o,!0),o.hijos&&o.hijos.length>0&&this.propagateSelection(o.hijos)})}closeDialog(){this.visible=!1}closeModal(){this.ref.close({register:!1})}static#e=this.\u0275fac=function(o){return new(o||t)(e.rXU(_.Ix),e.rXU(f.r1),e.rXU(j.c$),e.rXU(u.Pw),e.rXU(b.O),e.rXU(u.sb),e.rXU(k.V))};static#o=this.\u0275cmp=e.VBU({type:t,selectors:[["app-lista-permisos"]],standalone:!0,features:[e.aNF],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"d-flex","justify-content-between"],[1,"text-primary","font-semibold","text-xl"],["optionLabel","name","optionValue","domain_id","placeholder","Seleccione una instituci\xf3n",3,"options","ngModel","ngModelChange","onChange",4,"ngIf"],["optionLabel","name","optionValue","domain_id","placeholder","Seleccione una instituci\xf3n",3,"options","ngModel","ngModelChange","onChange"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["class","mb-3",4,"ngFor","ngForOf"],[1,"float-rigth"],["pButton","","label","Guardar",1,"p-button-primary","mr-2",2,"color","#ffffff","background","#6366f1","border","1px solid #6366f1","padding","0.75rem 1.25rem","font-size","1rem","transition","background-color 0.2s, color 0.2s,\n                                    border-color 0.2s, box-shadow 0.2s","border-radius","10px","cursor","pointer",3,"click"],[1,"mb-3"],[1,"d-flex","align-items-center","grupo-header"],["type","button",1,"btn","btn-link","p-0","ml-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 307.053 307.053",3,"ngClass"],["id","_x34_86._Down"],["d","M302.445,80.796l-11.101-11.103c-6.123-6.131-16.074-6.131-22.209,0L153.67,183.707L37.907,67.959\n                                                c-6.134-6.13-16.08-6.13-22.209,0L4.597,79.06c-6.129,6.133-6.129,16.067,0,22.201l137.83,137.829\n                                                c6.129,6.136,16.067,6.136,22.203,0l137.815-136.096C308.589,96.864,308.589,86.926,302.445,80.796z"],["type","checkbox",1,"checkbox",3,"ngModel","ngModelChange","change"],[1,"font-semibold","text-lg"],["class","grupo-content",4,"ngIf"],["renderPermisos",""],[1,"grupo-content"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-flex","flex-column","opcionesCheck"],[1,"d-flex","align-items-center","backgroundPurple"],["type","button","class","btn btn-link p-0 ml-2",3,"click",4,"ngIf"],[1,"ml-2"],["class","pl-3 border-left grupo-content",4,"ngIf"],["d","M302.445,80.796l-11.101-11.103c-6.123-6.131-16.074-6.131-22.209,0L153.67,183.707L37.907,67.959\n                                                            c-6.134-6.13-16.08-6.13-22.209,0L4.597,79.06c-6.129,6.133-6.129,16.067,0,22.201l137.83,137.829\n                                                            c6.129,6.136,16.067,6.136,22.203,0l137.815-136.096C308.589,96.864,308.589,86.926,302.445,80.796z"],[1,"pl-3","border-left","grupo-content"]],template:function(o,n){1&o&&(e.j41(0,"p-panel"),e.DNE(1,B,4,1,"ng-template",0),e.DNE(2,W,7,1,"ng-template",1),e.k0s())},dependencies:[m.MD,m.YU,m.Sq,m.bT,m.T3,h.b,h.Z,f.Ei,E.kr,E.ms,d.YN,d.Zm,d.BC,d.vS,v.bG],styles:['@charset "UTF-8";.grupo-header[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;margin-bottom:2px;background:#eef2fe;border-radius:7px;padding:5px;gap:5px}.grupo-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:21px;margin:0;height:21px}.grupo-content[_ngcontent-%COMP%]{padding-left:20px}.rotate-icon[_ngcontent-%COMP%]{transform:rotate(180deg);transition:transform .3s ease-in-out}.btn-link[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0;border:none;background:none;margin-left:5px;margin-right:5px}.btn-link[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;fill:#6366f1}.opcionesCheck[_ngcontent-%COMP%]{display:flex;cursor:pointer;margin-bottom:2px;border-radius:7px}.d-flex[_ngcontent-%COMP%]{display:flex}.backgroundPurple[_ngcontent-%COMP%]{background:#eef2fe;margin:2px;padding:3px;border-radius:4px}.checkbox[_ngcontent-%COMP%]{position:relative;width:20px;height:20px;margin:0;cursor:pointer;appearance:none;-webkit-appearance:none;-moz-appearance:none;background-color:#fff;border:2px solid #B0BEC5;border-radius:4px;outline:none;transition:background-color .3s,border-color .3s}.checkbox[_ngcontent-%COMP%]:checked{background-color:#6366f1;border-color:#6366f1}.checkbox[_ngcontent-%COMP%]:checked:after{content:"";position:absolute;top:2px;left:6px;width:4px;height:8px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}input[type=checkbox][_ngcontent-%COMP%]:checked{background-color:#6366f1;border-color:#6366f1}']})}return t})();function Q(t,a){1&t&&(e.j41(0,"span",2),e.EFF(1,"Buscar rol"),e.k0s())}function q(t,a){if(1&t){const i=e.RV6();e.j41(0,"div",16)(1,"button",17),e.bIt("click",function(){e.eBV(i);const n=e.XpG(3);return e.Njj(n.navigateToNuevo(0))}),e.k0s()()}}function ee(t,a){if(1&t&&(e.j41(0,"div",11)(1,"div",12)(2,"span",13),e.nrm(3,"input",14),e.k0s()(),e.DNE(4,q,2,0,"div",15),e.k0s()),2&t){const i=e.XpG(2);e.R7$(4),e.Y8G("ngIf",i.tienePermiso("roles_crearRol"))}}function oe(t,a){1&t&&(e.j41(0,"tr")(1,"th",18),e.EFF(2,"Acciones"),e.k0s(),e.j41(3,"th",18),e.EFF(4,"ID"),e.k0s(),e.j41(5,"th",18),e.EFF(6,"Nombre"),e.k0s(),e.j41(7,"th",18),e.EFF(8,"Fecha"),e.k0s(),e.j41(9,"th",18),e.EFF(10,"Asignar permisos"),e.k0s()())}const T=function(){return{color:"var(--primary-color)","font-size":"1.5rem"}};function ie(t,a){if(1&t){const i=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.navigateToNuevo(n.id))}),e.nrm(1,"i",23),e.k0s()}2&t&&(e.R7$(1),e.Aen(e.lJ4(2,T)))}function te(t,a){if(1&t){const i=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.eliminar(n.id))}),e.EFF(1,"X "),e.k0s()}}function ne(t,a){if(1&t){const i=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.listaPermisos(n.id))}),e.nrm(1,"i",23),e.k0s()}2&t&&(e.R7$(1),e.Aen(e.lJ4(2,T)))}function se(t,a){if(1&t&&(e.j41(0,"tr")(1,"td",19),e.DNE(2,ie,2,3,"button",20),e.DNE(3,te,2,0,"button",21),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.DNE(11,ne,2,3,"button",20),e.k0s()()),2&t){const i=a.$implicit,o=e.XpG(2);e.R7$(2),e.Y8G("ngIf",o.tienePermiso("roles_editarRol")),e.R7$(1),e.Y8G("ngIf",o.tienePermiso("roles_eliminarRol")),e.R7$(2),e.JRh(i.id),e.R7$(2),e.JRh(i.nombre),e.R7$(2),e.JRh(i.fecha),e.R7$(2),e.Y8G("ngIf",o.tienePermiso("roles_asignarPermiso"))}}function re(t,a){1&t&&(e.j41(0,"tr")(1,"td",25),e.EFF(2,"No se encontraron registros"),e.k0s()())}function ae(t,a){1&t&&(e.j41(0,"tr")(1,"td",25),e.EFF(2," Cargando registros. Por favor espere. "),e.k0s()())}function le(t,a){if(1&t&&(e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6),e.DNE(4,ee,5,1,"ng-template",7),e.DNE(5,oe,11,0,"ng-template",0),e.DNE(6,se,12,6,"ng-template",8),e.DNE(7,re,3,0,"ng-template",9),e.DNE(8,ae,3,0,"ng-template",10),e.k0s()()()()),2&t){const i=e.XpG();e.R7$(3),e.Y8G("value",i.roles)}}let ce=(()=>{class t{constructor(i,o,n,s,l){this.router=i,this.dialogService=o,this.rolService=n,this.permisoService=s,this.helpersService=l,this.roles=[],this.rol=[],this.domain_id=this.helpersService.getDominioId(),this.rolService.getRoles(this.domain_id).subscribe(c=>{console.log("Lista de Roles",c),this.roles=c})}navigateToNuevo(i){i>0?this.rolService.getRol(i).subscribe(o=>{console.log("Lista de Roles",o),this.rol=o,this.ref=this.dialogService.open(S,{width:"60%",styleClass:"custom-dialog-header",data:this.rol}),this.ref.onClose.subscribe(n=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"}),console.log(this.rol)}):(this.ref=this.dialogService.open(S,{width:"60%",styleClass:"custom-dialog-header"}),this.ref.onClose.subscribe(o=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"}))}eliminar(i){g().fire({title:"Eliminar rol",text:"Est\xe1s segurdo de eliminar el rol?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar!"}).then(o=>{o.isConfirmed&&this.rolService.eliminarRol(i).subscribe(n=>{console.log("rol eliminado:",n),this.rolService.getRoles(this.domain_id).subscribe(s=>{console.log("Lista de Roles",s),this.roles=s})},n=>{console.error("Error eliminando ciclo:",n)})})}listaPermisos(i){this.ref=this.dialogService.open(K,{width:"60%",styleClass:"custom-dialog-header",data:i}),this.ref.onClose.subscribe(o=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})}tienePermiso(i){return this.permisoService.tienePermiso(i)}static#e=this.\u0275fac=function(o){return new(o||t)(e.rXU(_.Ix),e.rXU(u.o3),e.rXU(b.O),e.rXU(b.O),e.rXU(k.V))};static#o=this.\u0275cmp=e.VBU({type:t,selectors:[["app-lista-postulantes"]],decls:4,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-12"],[1,"w-full","custom-search-input",3,"value"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar miembro",1,"w-full"],["class","mb-2",4,"ngIf"],[1,"mb-2"],["pButton","","label","Nuevo","icon","pi pi-user-plus",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],[2,"min-width","10rem"],[1,"text-center","flex","gap-2"],["style","width: fit-content","pButton","","class","p-button-rounded p-button-text custom-edit-button","title","Editar rol",3,"click",4,"ngIf"],["style","width: fit-content","pButton","","class","p-button-rounded p-button-text custom-edit-button","title","Eliminar rol",3,"click",4,"ngIf"],["pButton","","title","Editar rol",1,"p-button-rounded","p-button-text","custom-edit-button",2,"width","fit-content",3,"click"],["aria-hidden","true",1,"pi","pi-user-edit"],["pButton","","title","Eliminar rol",1,"p-button-rounded","p-button-text","custom-edit-button",2,"width","fit-content",3,"click"],["colspan","6"]],template:function(o,n){1&o&&(e.j41(0,"p-panel"),e.DNE(1,Q,2,0,"ng-template",0),e.DNE(2,le,9,1,"ng-template",1),e.k0s(),e.nrm(3,"div"))},dependencies:[m.bT,h.Z,f.Ei,C._f,v.XI,x.S],styles:[".selects_content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%], .selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid rgb(136,133,133);border-radius:10px;margin-top:.4rem;width:14.5rem;padding:.8rem 1rem;outline:none}"]})}return t})(),de=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#o=this.\u0275mod=e.$C({type:t});static#i=this.\u0275inj=e.G2t({imports:[_.iI.forChild([{path:"",component:ce}]),_.iI]})}return t})();var me=r(612),pe=r(4714),ue=r(9266),_e=r(1305),ge=r(3973),fe=r(563),A=r(6296),he=r(1579),N=r(9998),I=r(7835),G=r(320),be=r(8542),xe=r(4799),ve=r(1142),Ee=r(6781);let je=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#o=this.\u0275mod=e.$C({type:t});static#i=this.\u0275inj=e.G2t({imports:[m.MD,h.b,E.kr,de,d.YN,me.rO,v.bG,pe.wZ,C.tm,ue.SW,x.u,_e.f,ge.d0,fe.Z,A.iV,E.kr,he.d,N.MB,I.H,G.e,be.S,N.MB,v.bG,I.H,xe.F,G.e,ve.sv,Ee.P,u.k_,j.h,x.u,A.iV]})}return t})()}}]);