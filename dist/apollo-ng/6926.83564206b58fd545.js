"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[6926],{6926:(Q,h,o)=>{o.r(h),o.d(h,{ListaEgresadosModule:()=>J});var I=o(177),c=o(9417),M=o(9664),S=o(1141),B=o(612),F=o(4799),g=o(7835),y=o(6781),L=o(8150),d=o(2100),P=o(1142),m=o(320),p=o(2242),E=o(1305),f=o(6296),x=o(5473),A=o(1579),R=o(4714),U=o(563),X=o(9266),v=o(9280),C=o(9998),V=o(3973),T=o(8542),z=o(7434),j=o(1506),G=o(2274),H=o(2171),N=o(7170),$=o(7682),O=o(8763),Y=o(8032),l=o.n(Y),s=o(7019),D=o(4655),b=o(8774);let u=(()=>{class a{constructor(i,t,e,n,r,K){this.fb=i,this.ref=t,this.config=e,this.candidatoService=n,this.helpersService=r,this.cd=K,this.generoOptions=[{label:"Masculino",value:"M"},{label:"Femenino",value:"F"}],this.docIdentidadOptions=[],this.ocupacionOptions=[],this.estadoActualOptions=[],this.identificationDocuments=[],this.estadoCivilOptions=[],this.gradoInstruccionOptions=[],this.profesionOptions=[],this.acciones=this.config.data.acciones,this.rolId=this.helpersService.getRolId(),this.config.data.ciudad_id?console.log("Ciudad ID recibido:",this.config.data.ciudad_id):console.log("No se recibi\xf3 el Ciudad ID."),8===this.rolId?this.postulanteId=this.config.data.postulanteId:8!==this.rolId&&(this.rolId=21),this.postulanteForm=this.fb.group({code:[{value:"",disabled:!0}],codigo_puesto_asignado:[""],nombre:[""],genero:[""],telefono:[""],fecha_nacimiento:[""],edad:[{value:"",disabled:!0}],email:["",[c.k0.email]],contrasena:["",c.k0.required],doc_identidad:[""],numero_documento:["",c.k0.required],estado_civil:[""],numero_hijos:[0],grado_instruccion:[""],profesion:[""],ocupacion_actual:[""],imagen:[""],estado_actual:[""],fecha_afiliacion:[""]})}onFileChange(i){const t=i.files[0];if(t){const e=new FileReader;e.onload=n=>{const r=n.target.result.split(",")[1];this.postulanteForm.patchValue({imagen:r,nombre_archivo:t.name})},e.readAsDataURL(t)}}calculateAge(i){const t=new Date(i),e=new Date;let n=e.getFullYear()-t.getFullYear();const r=e.getMonth()-t.getMonth();return(r<0||0===r&&e.getDate()<t.getDate())&&n--,isNaN(n)?null:n}loadDropdownOptions(){this.candidatoService.getDataCreate(this.domain_id).subscribe(i=>{this.identificationDocuments=i.identification_documents||[],this.estadoCivilOptions=i.marital_statuses||[],this.gradoInstruccionOptions=i.education_degrees||[],this.profesionOptions=i.professions||[],this.estadoActualOptions=i.current_states||[],this.ocupacionOptions=i.ocupacion_actual||[],this.postulanteForm.patchValue({code:i.code,doc_identidad:this.identificationDocuments.length>0?this.identificationDocuments[0].id:null,estado_civil:this.estadoCivilOptions.length>0?this.estadoCivilOptions[0].id:null,grado_instruccion:this.gradoInstruccionOptions.length>0?this.gradoInstruccionOptions[0].id:null,profesion:this.profesionOptions.length>0?this.profesionOptions[0].id:null,estado_actual:this.estadoActualOptions.length>0?this.estadoActualOptions[0].id:null,ocupacion_actual:this.ocupacionOptions.length>0?this.ocupacionOptions[0].id:null})})}ngOnInit(){this.rolId=this.helpersService.getRolId(),this.domain_id=this.helpersService.getDominioId(),this.loadDropdownOptions(),("ver"===this.acciones||"actualizar"===this.acciones)&&this.candidatoService.getCandidatoById(this.config.data.data.id).subscribe(t=>{console.log(t),this.postulanteForm.patchValue({nombre:t.cvBank.names||"",codigo_puesto_asignado:t.cvBank.position_code||"",genero:t.cvBank.sex||"",telefono:t.cvBank.phone||"",fecha_nacimiento:this.convertToDate(t.cvBank.date_birth)||"",edad:this.calculateAge(t.cvBank.date_birth)||"",email:t.cvBank.email||"",doc_identidad:t.cvBank.identification_document_id||"",numero_documento:t.cvBank.identification_number||"",estado_civil:t.cvBank.marital_status_id||"",numero_hijos:t.cvBank.number_children||"",grado_instruccion:t.cvBank.education_degree_id||"",profesion:t.cvBank.profession_id||"",ocupacion_actual:t.cvBank.ocupacion_actual_id||"",estado_actual:t.cvBank.estado_actual_id||"",fecha_afiliacion:this.convertToDate(t.cvBank.date_affiliation)||""})}),this.postulanteForm.get("fecha_nacimiento")?.valueChanges.subscribe(i=>{const t=this.calculateAge(i);this.postulanteForm.get("edad")?.setValue(t||"",{emitEvent:!1})})}convertToDate(i){return i?new Date(i):null}formatDate(i){const t=new Date(i);return`${t.getFullYear()}-${("0"+(t.getMonth()+1)).slice(-2)}-${("0"+t.getDate()).slice(-2)}`}guardarPostulante(){if(this.postulanteForm.valid){this.postulanteForm.get("code")?.enable();const i={identification_number:this.postulanteForm.value.numero_documento,password:this.postulanteForm.value.contrasena,domain_id:this.domain_id,ciudad_id:this.config.data.ciudad_id};console.log("Datos mapeados enviados al backend:",i),"actualizar"===this.acciones?this.candidatoService.actualizarCandidato(this.config.data.data.id,i).subscribe(e=>{this.ref?.close(),l().fire("\xa1\xc9xito!","Los datos se actualizaron correctamente","success")},e=>{console.error("Error en la solicitud:",e),l().fire("Error","Hubo un problema al actualizar el registro","error")}):this.candidatoService.guardarCandidato(i).subscribe(t=>{this.ref?.close(),l().fire("\xa1\xc9xito!","Los datos se registraron correctamente","success")},t=>{console.error("Error en la solicitud:",t),l().fire("Error","Hubo un problema al registrar el postulante","error")})}else console.error("Formulario inv\xe1lido")}closeModal(i){i.preventDefault(),this.ref?.close()}static#t=this.\u0275fac=function(t){return new(t||a)(s.rXU(c.ok),s.rXU(d.Pw),s.rXU(d.sb),s.rXU(D.X),s.rXU(b.V),s.rXU(s.gRc))};static#i=this.\u0275cmp=s.VBU({type:a,selectors:[["app-ae-lista-egresados"]],decls:0,vars:0,template:function(t,e){},styles:["input[_ngcontent-%COMP%], p-dropdown[_ngcontent-%COMP%]{width:100%;display:flex}"]})}return a})(),Z=(()=>{class a{constructor(i,t,e,n){this.dialogService=i,this.helpersService=t,this.candidatoService=e,this.config=n,this.loading=!1,this.candidatoList=[],this.originalCandidatoList=[]}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),this.candidato_id=this.helpersService.getPostulanteId();const i=this.config.data.ciudad;i&&(this.ciudad_id=i.id,console.log("Ciudad recibida:",i)),this.listarPostulantesSegunRol()}listarPostulantesSegunRol(){this.ciudad_id?(this.loading=!0,this.candidatoService.getCandidatosByCiudad(this.ciudad_id).subscribe(i=>{this.candidatoList=i.data,this.originalCandidatoList=[...i.data],this.loading=!1},i=>{console.error("Error al obtener los candidatos:",i),this.loading=!1})):console.error("Ciudad ID no proporcionada.")}navigateAddPostulante(){this.ref=this.dialogService.open(u,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"add",ciudad_id:this.ciudad_id}}),this.ref.onClose.subscribe(()=>{this.listarPostulantesSegunRol()})}navigateToDetalle(i){this.ref=this.dialogService.open(u,{width:"80%",styleClass:"custom-dialog-header",data:{acciones:"ver",data:i}})}navigateToEdit(i){this.ref=this.dialogService.open(u,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"actualizar",data:i,postulanteId:i.id,ciudad_id:this.ciudad_id}}),this.ref.onClose.subscribe(()=>{this.listarPostulantesSegunRol()})}navigateToDelete(i){l().fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminarlo"}).then(t=>{t.isConfirmed&&this.candidatoService.eliminarCandidato(i).subscribe(()=>{l().fire("Eliminado","El registro ha sido eliminado.","success"),this.listarPostulantesSegunRol()},e=>{l().fire("Error","Hubo un problema al eliminar el registro.","error")})})}onGlobalFilter(i){const t=i.target.value.toLowerCase();this.candidatoList=t?this.originalCandidatoList.filter(e=>e.nombre.toLowerCase().includes(t)):[...this.originalCandidatoList]}static#t=this.\u0275fac=function(t){return new(t||a)(s.rXU(d.o3),s.rXU(b.V),s.rXU(D.X),s.rXU(d.sb))};static#i=this.\u0275cmp=s.VBU({type:a,selectors:[["app-lista-egresados"]],decls:0,vars:0,template:function(t,e){},styles:[".selects_content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%], .selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid rgb(136,133,133);border-radius:10px;margin-top:.4rem;width:14.5rem;padding:.8rem 1rem;outline:none}"]})}return a})(),W=(()=>{class a{static#t=this.\u0275fac=function(t){return new(t||a)};static#i=this.\u0275mod=s.$C({type:a});static#o=this.\u0275inj=s.G2t({imports:[O.iI.forChild([{path:"",component:Z}]),O.iI]})}return a})(),J=(()=>{class a{static#t=this.\u0275fac=function(t){return new(t||a)};static#i=this.\u0275mod=s.$C({type:a});static#o=this.\u0275inj=s.G2t({imports:[I.MD,c.X1,W,x.b,c.YN,B.rO,v.bG,R.wZ,S.tm,X.SW,p.u,E.f,V.d0,U.Z,f.iV,L.kr,A.d,C.MB,g.H,m.e,T.S,C.MB,v.bG,g.H,F.F,m.e,P.sv,y.P,d.k_,M.h,p.u,f.iV,G.o,H.InformacionAcademicaModule,z.CapacitacionPostulanteModule,j.ExperienciaLaboralModule,$.ReferenciasLaboralesModule,N.ReferenciasFamiliaresModule]})}return a})()}}]);