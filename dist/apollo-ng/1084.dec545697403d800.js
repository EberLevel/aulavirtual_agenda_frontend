"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[1084],{1084:(R,h,n)=>{n.r(h),n.d(h,{ForoAlumnosRoutingModule:()=>Q});var p=n(8763),u=n(5473),c=n(9417),v=n(612),m=n(9280),C=n(4714),l=n(1141),g=n(9266),f=n(2242),_=n(1305),M=n(3973),x=n(563),O=n(6296),$=n(8150),T=n(1579),E=n(9998),j=n(7835),D=n(320),P=n(8542),I=n(4799),y=n(1142),F=n(6781),A=n(2100),G=n(9664),e=n(7019),S=n(7064),k=n(8774),Y=n(5779),b=n(177);function U(o,d){1&o&&(e.j41(0,"span",6),e.EFF(1,"Foros"),e.k0s())}function B(o,d){if(1&o&&(e.j41(0,"li",31)(1,"div",32)(2,"span",33),e.EFF(3),e.k0s(),e.j41(4,"span",34),e.EFF(5),e.nI1(6,"date"),e.k0s()(),e.nrm(7,"p",35),e.k0s()),2&o){const t=d.$implicit;e.R7$(3),e.JRh(t.alumno),e.R7$(2),e.JRh(e.i5U(6,3,t.fecha,"dd/MM/yyyy HH:mm")),e.R7$(2),e.Y8G("innerHTML",t.respuesta,e.npT)}}function H(o,d){if(1&o&&(e.j41(0,"ul",29),e.DNE(1,B,8,6,"li",30),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",t.subrespuestas)}}function V(o,d){if(1&o){const t=e.RV6();e.j41(0,"li",22)(1,"div",23)(2,"span",24),e.EFF(3),e.k0s(),e.j41(4,"span",25),e.EFF(5),e.nI1(6,"date"),e.k0s()(),e.nrm(7,"p",26),e.j41(8,"button",27),e.bIt("click",function(){const a=e.eBV(t).$implicit,i=e.XpG().$implicit,Z=e.XpG(2);return e.Njj(Z.selectForo(i,a))}),e.k0s(),e.DNE(9,H,2,1,"ul",28),e.k0s()}if(2&o){const t=d.$implicit,s=e.XpG().$implicit,r=e.XpG(2);e.R7$(3),e.JRh(t.alumno),e.R7$(2),e.JRh(e.i5U(6,5,t.fecha,"dd/MM/yyyy HH:mm")),e.R7$(2),e.Y8G("innerHTML",t.respuesta,e.npT),e.R7$(1),e.Y8G("disabled",r.isExpired(s.fecha_fin)),e.R7$(1),e.Y8G("ngIf",t.subrespuestas&&t.subrespuestas.length>0)}}function L(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",12)(1,"h3",13),e.EFF(2),e.k0s(),e.nrm(3,"p",14),e.j41(4,"div",15),e.nrm(5,"i",16),e.j41(6,"span",17),e.EFF(7),e.nI1(8,"date"),e.nI1(9,"date"),e.k0s(),e.j41(10,"span",18),e.EFF(11),e.k0s()(),e.j41(12,"ul",19),e.DNE(13,V,10,8,"li",20),e.k0s(),e.j41(14,"button",21),e.bIt("click",function(){const a=e.eBV(t).$implicit,i=e.XpG(2);return e.Njj(i.selectForo(a))}),e.k0s()()}if(2&o){const t=d.$implicit,s=e.XpG(2);e.R7$(2),e.JRh(t.foro_name),e.R7$(1),e.Y8G("innerHTML",t.foro_pregunta,e.npT),e.R7$(4),e.Lme("Inicio: ",e.i5U(8,8,t.fecha_inicio,"dd/MM/yyyy")," | Fin: ",e.i5U(9,11,t.fecha_fin,"dd/MM/yyyy"),""),e.R7$(3),e.Y8G("ngClass",s.getDaysRemainingClass(t.fecha_fin)),e.R7$(1),e.SpI(" (",s.getDaysRemaining(t.fecha_fin),") "),e.R7$(2),e.Y8G("ngForOf",t.respuestas),e.R7$(1),e.Y8G("disabled",s.isExpired(t.fecha_fin))}}function N(o,d){if(1&o&&(e.j41(0,"div",7)(1,"div",8)(2,"h2",9),e.EFF(3),e.k0s(),e.j41(4,"h3",10),e.EFF(5),e.k0s()(),e.DNE(6,L,15,14,"div",11),e.k0s()),2&o){const t=d.$implicit;e.R7$(3),e.SpI("Unidad Didactica: ",t.curso_name,""),e.R7$(2),e.SpI("Docente: ",t.docente_name,""),e.R7$(1),e.Y8G("ngForOf",t.foros)}}function X(o,d){if(1&o&&(e.j41(0,"div",36)(1,"h4",37),e.EFF(2,"Respondiendo a:"),e.k0s(),e.nrm(3,"p",38),e.j41(4,"p",39),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&o){const t=e.XpG();e.R7$(3),e.Y8G("innerHTML",t.selectedRespuesta.respuesta,e.npT),e.R7$(2),e.Lme("",t.selectedRespuesta.alumno," - ",e.i5U(6,3,t.selectedRespuesta.fecha,"dd/MM/yyyy HH:mm"),"")}}function w(o,d){if(1&o){const t=e.RV6();e.j41(0,"button",40),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.submitResponse())}),e.k0s(),e.j41(1,"button",41),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.cancelResponse())}),e.k0s()}}const J=function(){return{width:"60vw"}},K=function(){return{"960px":"75vw","640px":"100vw"}},W=function(){return{height:"320px"}};let z=(()=>{class o{constructor(t,s){this.foroService=t,this.helperService=s,this.foros=[],this.selectedForo=null,this.newResponse="",this.selectedRespuesta=null}ngOnInit(){this.domain_id=this.helperService.getDominioId(),this.getForos()}getForos(){this.foroService.getForos(this.domain_id,this.helperService.getAlumnoId(),this.helperService.getDocenteId()).subscribe(t=>{this.foros=t.map(s=>({...s,foros:s.foros.map(r=>({...r,respuestas:r.respuestas.map(a=>({...a,subrespuestas:a.subrespuestas}))}))})),console.log("Foros cargados:",this.foros)},t=>console.error("Error al cargar los foros",t))}selectForo(t,s,r){this.selectedForo=t,this.selectedRespuesta=r||s||null,this.newResponse=""}isExpired(t){return new Date>new Date(t)}cancelResponse(){this.selectedForo=null,this.selectedRespuesta=null,this.newResponse=""}submitResponse(){if(this.selectedForo&&this.newResponse){console.log(this.selectedRespuesta);const t={id_foro:this.selectedForo.id_foro,respuesta:this.newResponse,domain_id:this.helperService.getDominioId(),alumno_id:this.helperService.getAlumnoId(),docente_id:this.helperService.getDocenteId(),id_respuesta:this.selectedRespuesta?this.selectedRespuesta.id:null};this.foroService.sendResponse(t).subscribe(s=>{console.log("Respuesta enviada:",s),this.helperService.showSuccessMessage("Respuesta enviada correctamente"),this.getForos()}),this.newResponse="",this.selectedForo=null}}getDaysRemaining(t){const s=new Date,a=new Date(t).getTime()-s.getTime(),i=Math.ceil(a/864e5);return i<0?"Vencido":i.toString()+" d\xedas"}getDaysRemainingClass(t){const s=new Date,a=new Date(t).getTime()-s.getTime(),i=Math.ceil(a/864e5);return i<0?"days-remaining overdue":i<=7?"days-remaining due-soon":"days-remaining on-time"}static#e=this.\u0275fac=function(s){return new(s||o)(e.rXU(S.Y),e.rXU(k.V))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-foro-alumnos"]],decls:7,vars:13,consts:[["pTemplate","header"],["class","mb-8",4,"ngFor","ngForOf"],["header","Dejar una respuesta",3,"visible","modal","breakpoints","visibleChange"],["class","mb-4 p-3 bg-gray-100 rounded",4,"ngIf"],[3,"ngModel","ngModelChange"],["pTemplate","footer"],[1,"text-primary","font-semibold","text-2xl"],[1,"mb-8"],[1,"forum-header","bg-gray-100","p-4","rounded-t-lg"],[1,"text-xl","font-bold"],[1,"text-lg"],["class","forum-detail bg-white p-4 border border-gray-200 mb-4 rounded-b-lg shadow",4,"ngFor","ngForOf"],[1,"forum-detail","bg-white","p-4","border","border-gray-200","mb-4","rounded-b-lg","shadow"],[1,"text-xl","font-semibold","mb-4"],[1,"text-gray-700",3,"innerHTML"],[1,"forum-dates","flex","items-center","mb-4"],[1,"pi","pi-calendar","mr-2","text-blue-500"],[1,"mr-2"],[1,"font-semibold","px-2","py-1","rounded",3,"ngClass"],[1,"space-y-6"],["class","bg-gray-50 p-4 rounded shadow-sm",4,"ngFor","ngForOf"],["pButton","","type","button","label","Nueva respuesta","icon","pi pi-plus",1,"mt-6","p-button-outlined",3,"disabled","click"],[1,"bg-gray-50","p-4","rounded","shadow-sm"],[1,"flex","justify-between","items-center","mb-3",2,"align-items","center","column-gap","1em"],[1,"font-semibold","text-lg"],[1,"text-sm","text-gray-500"],[1,"mb-3","text-gray-700",3,"innerHTML"],["pButton","","type","button","label","Responder","icon","pi pi-reply",1,"p-button-text","p-button-sm",3,"disabled","click"],["class","mt-4 space-y-3 pl-6 border-l-2 border-gray-200",4,"ngIf"],[1,"mt-4","space-y-3","pl-6","border-l-2","border-gray-200"],["class","bg-gray-100 p-3 rounded",4,"ngFor","ngForOf"],[1,"bg-gray-100","p-3","rounded"],[1,"flex","justify-between","items-center","mb-2"],[1,"font-semibold","text-sm"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-600",3,"innerHTML"],[1,"mb-4","p-3","bg-gray-100","rounded"],[1,"font-semibold","mb-2"],[3,"innerHTML"],[1,"text-sm","text-gray-500","mt-2"],["pButton","","type","button","label","Enviar","icon","pi pi-send",1,"p-button-primary",3,"click"],["pButton","","type","button","label","Cancelar","icon","pi pi-times",1,"p-button-secondary","ml-2",3,"click"]],template:function(s,r){1&s&&(e.j41(0,"p-panel"),e.DNE(1,U,2,0,"ng-template",0),e.DNE(2,N,7,3,"div",1),e.k0s(),e.j41(3,"p-dialog",2),e.bIt("visibleChange",function(i){return r.selectedForo=i}),e.DNE(4,X,7,6,"div",3),e.j41(5,"p-editor",4),e.bIt("ngModelChange",function(i){return r.newResponse=i}),e.k0s(),e.DNE(6,w,2,0,"ng-template",5),e.k0s()),2&s&&(e.R7$(2),e.Y8G("ngForOf",r.foros),e.R7$(1),e.Aen(e.lJ4(10,J)),e.Y8G("visible",r.selectedForo)("modal",!0)("breakpoints",e.lJ4(11,K)),e.R7$(1),e.Y8G("ngIf",r.selectedRespuesta),e.R7$(1),e.Aen(e.lJ4(12,W)),e.Y8G("ngModel",r.newResponse))},dependencies:[Y.Ei,l._f,b.YU,b.Sq,b.bT,u.Z,c.BC,c.vS,y.KE,F.l,b.vh],styles:["p-panel[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;padding:1rem;background-color:#f5f5f5}p-panel[_ngcontent-%COMP%]   .text-primary[_ngcontent-%COMP%]{color:#007bff}p-panel[_ngcontent-%COMP%]   .ui-panel-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;border-bottom:1px solid #ddd;padding-bottom:.5rem;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:1rem}.forum-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .forum-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.forum-detail[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #ddd;border-radius:4px;padding:1rem;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}.forum-dates[_ngcontent-%COMP%]   i.pi-calendar[_ngcontent-%COMP%]{font-size:1.2rem;margin-right:.5rem}.forum-dates[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:1rem}.days-remaining[_ngcontent-%COMP%]{font-weight:700}.days-remaining.due-soon[_ngcontent-%COMP%]{color:#ff5722}.days-remaining.on-time[_ngcontent-%COMP%]{color:#4caf50}.days-remaining.overdue[_ngcontent-%COMP%]{color:#f44336}button[_ngcontent-%COMP%]{background-color:#007bff;border:none;color:#fff;padding:.5rem 1rem;border-radius:4px;cursor:pointer;font-size:1rem;transition:background-color .3s,opacity .3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button.disabled[_ngcontent-%COMP%]{background-color:#6c757d;cursor:not-allowed;opacity:.6}button[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed;opacity:.6}p-dialog[_ngcontent-%COMP%]{max-width:600px;border-radius:8px}.p-editor[_ngcontent-%COMP%]{margin-bottom:1rem}ul[_ngcontent-%COMP%]{list-style-type:none}"]})}return o})(),Q=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.$C({type:o});static#n=this.\u0275inj=e.G2t({imports:[p.iI.forChild([{path:"",component:z}]),p.iI,u.b,c.YN,y.sv,v.rO,m.bG,C.wZ,l.tm,g.SW,c.X1,f.u,_.f,M.d0,x.Z,O.iV,$.kr,T.d,E.MB,j.H,D.e,P.S,I.F,y.sv,F.P,A.k_,G.h]})}return o})()},7064:(R,h,n)=>{n.d(h,{Y:()=>v});var p=n(1626),u=n(3587),c=n(7019);let v=(()=>{class m{constructor(l,g,f){this.http=l,this.httpClientFormData=g,this.handler=f,this.baseUrl=`${u.c.API_BASE}`,this.urlparametro=`${u.c.API_BASE}`,this.httpOptions={headers:new p.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new p.Qq(this.handler)}saveForo(l){return this.http.post(`${this.baseUrl}foros`,l)}getForos(l,g,f){return this.http.get(`${this.baseUrl}foros/${l}/${g}/${f}`)}sendResponse(l){return this.http.post(`${this.baseUrl}foros/message`,l)}static#e=this.\u0275fac=function(g){return new(g||m)(c.KVO(p.Qq),c.KVO(p.Qq),c.KVO(p.JV))};static#t=this.\u0275prov=c.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);