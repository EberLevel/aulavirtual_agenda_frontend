"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[3459],{3459:(mt,b,a)=>{a.r(b),a.d(b,{MantenimientoMaestroModule:()=>lt});var d=a(177),x=a(9998),p=a(9417),g=a(9280),h=a(1141),_=a(2242),I=a(3973),y=a(563),F=a(6296),v=a(8150),c=a(5473),T=a(612),k=a(1579),P=a(9266),B=a(4714),M=a(320),C=a(7835),S=a(1305),w=a(8542),L=a(4799),X=a(1142),V=a(6781),u=a(2100),$=a(9664),f=a(8763),t=a(7019),O=a(8032),l=a.n(O),j=a(3088),D=a(8774),N=a(8537),E=a(5779),R=a(9240);function A(n,s){if(1&n&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(1),t.SpI(" ",e.esNuevo?"Registrar Parametros":"Editar Parametro"," ")}}function U(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",18),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.guardarParametro())}),t.k0s()}}function z(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",19),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.updateParametros())}),t.k0s()}}const Y=function(){return{width:"100%"}};function J(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6)(4,"p-autoComplete",7),t.bIt("completeMethod",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.filterItems(o))})("ngModelChange",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.parametroDatos.tx_nombre=o)})("keydown",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.onKeydown(o))})("onSelect",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.onItemSelect(o))}),t.k0s(),t.j41(5,"label",8),t.EFF(6,"Grupo"),t.k0s()()(),t.j41(7,"div",5)(8,"span",6)(9,"input",9),t.bIt("ngModelChange",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.parametroDatos.txAbreviatura=o)}),t.k0s(),t.j41(10,"label",8),t.EFF(11,"Abreviatura"),t.k0s()()()()(),t.j41(12,"div",3)(13,"div",4)(14,"div",5)(15,"span",6)(16,"input",10),t.bIt("ngModelChange",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.parametroDatos.txNombre=o)}),t.k0s(),t.j41(17,"label",8),t.EFF(18,"Nombre"),t.k0s()()()(),t.j41(19,"div",5)(20,"label",11),t.EFF(21,"Color"),t.k0s(),t.j41(22,"p-colorPicker",12),t.bIt("ngModelChange",function(o){t.eBV(e);const i=t.XpG();return t.Njj(i.parametroDatos.color=o)}),t.k0s()()(),t.j41(23,"div",3)(24,"div",13)(25,"div",14),t.DNE(26,U,1,0,"button",15),t.DNE(27,z,1,0,"button",16),t.j41(28,"button",17),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.closeModal())}),t.k0s()()()()}if(2&n){const e=t.XpG();t.R7$(4),t.Y8G("suggestions",e.filteredItems)("ngModel",e.parametroDatos.tx_nombre)("dropdown",!0)("forceSelection",!1),t.R7$(5),t.Y8G("ngModel",e.parametroDatos.txAbreviatura)("readonly",e.parametroDatos.nativo),t.R7$(7),t.Y8G("ngModel",e.parametroDatos.txNombre),t.R7$(6),t.Aen(t.lJ4(12,Y)),t.Y8G("ngModel",e.parametroDatos.color),t.R7$(4),t.Y8G("ngIf",e.esNuevo),t.R7$(1),t.Y8G("ngIf",!e.esNuevo)}}let G=(()=>{class n{constructor(e,r,o,i){this.parametroService=e,this.config=r,this.ref=o,this.helpersService=i,this.parametroGroupItemList=[],this.filteredItems=[],this.parametroDatos={},this.descripcionParametro="",this.esNuevo=!0,this.acciones="register",this.domain_id=1}ngOnInit(){if(this.domain_id=this.helpersService.getDominioId(),"update"===this.config.data.acciones){const e={tx_nombre:this.config.data.data.tx_nombre,txAbreviatura:this.config.data.data.tx_abreviatura,txNombre:this.config.data.data.tx_item_description,domain_id:this.domain_id,nuItemNro:this.config.data.data.nu_item,color:this.config.data.data.color};console.log(this.config.data.data),this.parametroDatos=e}this.esNuevo="update"!=this.config.data.acciones,this.listarEstados()}listarEstados(){this.parametroService.getMaestros(this.domain_id).subscribe(e=>{this.parametroGroupItemList=e}),console.log("listarEstados:",this.parametroGroupItemList)}filterItems(e){const r=e.query.toLowerCase();console.log("parametroGroupItemList:",this.parametroGroupItemList),this.filteredItems=this.parametroGroupItemList.filter(o=>o.tx_nombre.toLowerCase().includes(r)),console.log("filterItems:",this.filteredItems)}onKeydown(e){if("Enter"===e.key){console.log("entreaqui:",e.key),this.parametroDatos.txAbreviatura="";const r=e.target.value.trim();if(r&&!this.parametroGroupItemList.some(o=>o.tx_nombre.toLowerCase()===r.toLowerCase())){const o={tx_nombre:r,nativo:!0};this.parametroGroupItemList.push(o),this.parametroDatos.e=o}}}onItemSelect(e){this.parametroDatos.txAbreviatura=e.value.tx_abreviatura}guardarParametro(){console.log("parametroDatos:",this.parametroDatos),this.parametroService.guardarParametro({tx_nombre:"string"==typeof this.parametroDatos.tx_nombre?this.parametroDatos.tx_nombre:"string"==typeof this.parametroDatos.e?this.parametroDatos.e:this.parametroDatos.e?.tx_nombre||this.parametroDatos.tx_nombre?.tx_nombre||"",tx_abreviatura:this.parametroDatos.txAbreviatura,tx_item_description:this.parametroDatos.txNombre,domain_id:this.domain_id,nu_item:this.parametroDatos.nuItemNro,color:this.parametroDatos.color}).subscribe(o=>{console.log("response:",o),this.ref?.close(),l().fire({title:"\xa1Registro guardado!",text:"El par\xe1metro ha sido guardado correctamente.",icon:"success",confirmButtonText:"OK"}).then(i=>{})},o=>{this.parametroDatos={},console.error("Error al registrar el parametro",o),l().fire({title:"Error!",text:"Hubo un error al registrar el par\xe1metro.",icon:"error",confirmButtonText:"OK"})})}updateParametros(){console.log("parametroDatos:",this.parametroDatos),this.parametroService.updateParametro({tx_nombre:"string"==typeof this.parametroDatos.tx_nombre?this.parametroDatos.tx_nombre:"string"==typeof this.parametroDatos.e?this.parametroDatos.e:this.parametroDatos.e?.tx_nombre||this.parametroDatos.tx_nombre?.tx_nombre||"",tx_abreviatura:this.parametroDatos.txAbreviatura,tx_item_description:this.parametroDatos.txNombre,domain_id:this.domain_id,nu_item:this.parametroDatos.nuItemNro,id:this.config.data.data.nu_id_parametro,color:this.parametroDatos.color}).subscribe(o=>{console.log("response:",o),this.ref?.close(),l().fire("Actualizado!","El par\xe1metro ha sido actualizado.","success")},o=>{this.parametroDatos={},console.error("Error al registrar el parametro",o),l().fire("Error!","Hubo un error al actualizar el par\xe1metro.","error")})}closeModal(){this.ref?.close()}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(j.O),t.rXU(u.sb),t.rXU(u.Pw),t.rXU(D.V))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-reg-maestros"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12","md:col-6"],[1,"p-float-label"],["inputId","tx_nombre","field","tx_nombre",3,"suggestions","ngModel","dropdown","forceSelection","completeMethod","ngModelChange","keydown","onSelect"],[1,"required"],["type","text","id","inputtext","pInputText","",3,"ngModel","readonly","ngModelChange"],["type","text","pInputText","",3,"ngModel","ngModelChange"],["for","colorPicker",1,"required"],["id","colorPicker",3,"ngModel","ngModelChange"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","class","p-button-success p-button-sm",3,"click",4,"ngIf"],["pButton","","icon","pi pi-pencil","label","Guardar Cambios","iconPos","right","class","p-button-success p-button-sm",3,"click",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right",1,"p-button-success","p-button-sm",3,"click"],["pButton","","icon","pi pi-pencil","label","Guardar Cambios","iconPos","right",1,"p-button-success","p-button-sm",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"p-panel"),t.DNE(1,A,2,1,"ng-template",0),t.DNE(2,J,29,13,"ng-template",1),t.k0s())},dependencies:[N.j9,E.Ei,d.bT,p.me,p.BC,p.vS,h._f,_.S,c.Z,R.sk],styles:[".swal2-custom-class[_ngcontent-%COMP%], .swal2-container[_ngcontent-%COMP%], .swal2-center[_ngcontent-%COMP%], .swal2-backdrop-show[_ngcontent-%COMP%], .swal2-popup[_ngcontent-%COMP%]{z-index:9999!important}"]})}return n})();const H=["filter"],K=["dt1"];function Z(n,s){1&n&&(t.j41(0,"span",2),t.EFF(1,"Bandeja de Maestro"),t.k0s())}function Q(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"span",14)(3,"input",15,16),t.bIt("input",function(o){t.eBV(e);const i=t.XpG(2);return t.Njj(i.onGlobalFilter(o))}),t.k0s()()(),t.j41(5,"div",17)(6,"button",18),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.navigateToNuevo())}),t.k0s()()()}}function W(n,s){1&n&&(t.j41(0,"tr")(1,"th",19)(2,"div",20),t.EFF(3," Item "),t.k0s()(),t.j41(4,"th",19)(5,"div",20),t.EFF(6," Nombre "),t.k0s()(),t.j41(7,"th",19)(8,"div",20),t.EFF(9," Abreviatura "),t.k0s()(),t.j41(10,"th",19)(11,"div",20),t.EFF(12," Grupo "),t.k0s()(),t.j41(13,"th",19)(14,"div",20),t.EFF(15," Dominio "),t.k0s()(),t.j41(16,"th",19)(17,"div",20),t.EFF(18," Acciones "),t.k0s()()())}const q=function(){return{color:"var(--primary-color)","font-size":"1.5rem"}},tt=function(){return{color:"var(--error-color)","font-size":"1.5rem"}};function et(n,s){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td",21)(12,"button",22),t.bIt("click",function(){const i=t.eBV(e).$implicit,m=t.XpG(2);return t.Njj(m.editarParametro(i))}),t.nrm(13,"i",23),t.k0s(),t.j41(14,"button",24),t.bIt("click",function(){const i=t.eBV(e).$implicit,m=t.XpG(2);return t.Njj(m.eliminarParametro(i.nu_id_parametro))}),t.nrm(15,"i",25),t.k0s()()()}if(2&n){const e=s.$implicit;t.R7$(2),t.JRh(e.nu_item),t.R7$(2),t.JRh(e.tx_item_description),t.R7$(2),t.JRh(e.tx_abreviatura),t.R7$(2),t.JRh(e.tx_nombre),t.R7$(2),t.JRh(e.nombre),t.R7$(3),t.Aen(t.lJ4(8,q)),t.R7$(2),t.Y8G("ngStyle",t.lJ4(9,tt))}}function ot(n,s){1&n&&(t.j41(0,"tr")(1,"td",26),t.EFF(2,"No se encontraron registros"),t.k0s()())}function rt(n,s){1&n&&(t.j41(0,"tr")(1,"td",26),t.EFF(2,"Cargando registros. Por favor espere."),t.k0s()())}const nt=function(){return["nu_item","nombre","tx_abreviatura","tx_nombre","dominio"]};function at(n,s){if(1&n&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),t.DNE(5,Q,7,0,"ng-template",8),t.DNE(6,W,19,0,"ng-template",0),t.DNE(7,et,16,10,"ng-template",9),t.DNE(8,ot,3,0,"ng-template",10),t.DNE(9,rt,3,0,"ng-template",11),t.k0s()()()()),2&n){const e=t.XpG();t.R7$(3),t.Y8G("value",e.parametrosList)("rows",10)("loading",e.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",t.lJ4(6,nt))}}let it=(()=>{class n{constructor(e,r,o,i,m){this.dialogService=e,this.maestroService=r,this.router=o,this.cdr=i,this.helpersService=m,this.loading=!1,this.parametrosList=[],this.originalParametrosList=[],this.domain_id=1,this.miembro=[],this.miembrosActualizados=new t.bkB}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),this.listarmiembros()}listarmiembros(){this.maestroService.getMaestrosRecursive(this.domain_id).subscribe(e=>{console.log("Lista de Miembros creados",e),this.parametrosList=e,this.originalParametrosList=[...this.parametrosList],this.cdr.detectChanges()})}navigateToNuevo(){this.ref=this.dialogService.open(G,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"register"}}),this.ref.onClose.subscribe(e=>{this.listarmiembros(),this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})}onGlobalFilter(e){const r=e.target.value.toLowerCase();console.log("Filtro Global",r),this.parametrosList=r?this.originalParametrosList.filter(o=>o.nu_item&&o.nu_item.toString().toLowerCase().includes(r)||o.tx_item_description&&o.tx_item_description.toLowerCase().includes(r)||o.tx_abreviatura&&o.tx_abreviatura.toLowerCase().includes(r)||o.tx_nombre&&o.tx_nombre.toLowerCase().includes(r)||o.nombre&&o.nombre.toLowerCase().includes(r)):[...this.originalParametrosList]}editarParametro(e){this.ref=this.dialogService.open(G,{width:"60%",styleClass:"custom-dialog-header",data:{data:e,acciones:"update"}}),this.ref.onClose.subscribe(r=>{this.listarmiembros(),this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})}eliminarParametro(e){l().fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminarlo"}).then(r=>{r.isConfirmed&&this.maestroService.eliminarParametro(e).subscribe(o=>{l().fire("Eliminado","El par\xe1metro ha sido eliminado.","success"),this.listarmiembros()},o=>{l().fire("Error","Hubo un problema al eliminar el par\xe1metro.","error")})})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(u.o3),t.rXU(j.O),t.rXU(f.Ix),t.rXU(t.gRc),t.rXU(D.V))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-mantenimiento-maestro"]],viewQuery:function(r,o){if(1&r&&(t.GBs(H,5),t.GBs(K,5)),2&r){let i;t.mGM(i=t.lsd())&&(o.filter=i.first),t.mGM(i=t.lsd())&&(o.tabledt1=i.first)}},inputs:{miembro:"miembro"},outputs:{miembrosActualizados:"miembrosActualizados"},decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["dataKey","nu_item","styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"w-full","custom-search-input",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar par\xe1metro",1,"w-full",3,"input"],["filter",""],[1,"mb-2"],["pButton","","label","Nuevo","icon","pi pi-user-plus","id","btnNuevo",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],["scope","col",2,"min-width","10rem"],[1,"flex","justify-content-between","align-items-center"],[1,"text-center"],["pButton","","title","Editar par\xe1metro",1,"p-button-rounded","p-button-text","custom-edit-button",3,"click"],["aria-hidden","true",1,"pi","pi-user-edit"],["pButton","","title","Eliminar par\xe1metro",1,"p-button-danger","p-button-rounded",3,"click"],["aria-hidden","true",1,"pi","pi-trash",3,"ngStyle"],["colspan","6"]],template:function(r,o){1&r&&(t.j41(0,"p-panel"),t.DNE(1,Z,2,0,"ng-template",0),t.DNE(2,at,10,7,"ng-template",1),t.k0s())},dependencies:[E.Ei,d.B3,h._f,g.XI,_.S,c.Z],styles:[".swal2-custom-class[_ngcontent-%COMP%], .swal2-container[_ngcontent-%COMP%], .swal2-center[_ngcontent-%COMP%], .swal2-backdrop-show[_ngcontent-%COMP%], .swal2-popup[_ngcontent-%COMP%]{z-index:9999!important}"]})}return n})(),st=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#o=this.\u0275inj=t.G2t({imports:[f.iI.forChild([{path:"",component:it}]),f.iI]})}return n})(),lt=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#o=this.\u0275inj=t.G2t({imports:[N.$$,d.MD,st,p.YN,T.rO,g.bG,B.wZ,h.tm,P.SW,_.u,S.f,I.d0,y.Z,F.iV,v.kr,c.b,k.d,x.MB,C.H,M.e,w.S,x.MB,c.b,g.bG,C.H,L.F,M.e,X.sv,V.P,u.k_,$.h,v.kr,R.YG]})}return n})()}}]);