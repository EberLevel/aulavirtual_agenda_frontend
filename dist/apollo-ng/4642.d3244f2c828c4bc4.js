"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[4642],{4642:(H,c,l)=>{l.r(c),l.d(c,{CalendarAppModule:()=>B});var p=l(177),r=l(9417),h=l(8763),M=l(9423),j=l(5833),F=l(1710),e=l(7019),g=l(6653),k=l(8774),m=l(6064),v=l(6781),T=l(5779),u=l(1305),f=l(612),C=l(2242),E=l(8150);function D(a,d){if(1&a&&(e.j41(0,"span",7),e.EFF(1),e.k0s()),2&a){const t=e.XpG();e.R7$(1),e.JRh("display"===t.view?t.changedEvent.title:"new"===t.view?"Nuevo Evento":"Editar Evento")}}const _=function(){return[]},x=function(){return{hour:"2-digit",minute:"2-digit"}};function S(a,d){if(1&a&&(e.j41(0,"div")(1,"div",9)(2,"div",10)(3,"div",11),e.EFF(4,"Inicio"),e.k0s(),e.j41(5,"p",12),e.nrm(6,"i",13),e.j41(7,"span"),e.EFF(8),e.k0s()()(),e.j41(9,"div",10)(10,"div",11),e.EFF(11,"Fin"),e.k0s(),e.j41(12,"p",12),e.nrm(13,"i",13),e.j41(14,"span"),e.EFF(15),e.k0s()()()(),e.j41(16,"div",9)(17,"div",10)(18,"div",11),e.EFF(19,"Docente"),e.k0s(),e.j41(20,"p",14),e.nrm(21,"i",15),e.j41(22,"span"),e.EFF(23),e.k0s()()(),e.j41(24,"div",10)(25,"div",11),e.EFF(26,"Aula"),e.k0s(),e.j41(27,"p",16)(28,"span"),e.EFF(29),e.k0s(),e.j41(30,"small"),e.nrm(31,"i",17),e.EFF(32),e.k0s()()()()()),2&a){const t=e.XpG(2);e.R7$(8),e.JRh(t.changedEvent.start.toLocaleTimeString(e.lJ4(5,_),e.lJ4(6,x))),e.R7$(7),e.JRh(t.changedEvent.end.toLocaleTimeString(e.lJ4(7,_),e.lJ4(8,x))),e.R7$(8),e.JRh(t.changedEvent.docente),e.R7$(6),e.JRh(t.changedEvent.aulaName),e.R7$(3),e.SpI(" ",t.changedEvent.aulaUbicacion,"")}}function A(a,d){if(1&a&&(e.j41(0,"div",39),e.nrm(1,"div",40),e.j41(2,"div"),e.EFF(3),e.k0s()()),2&a){const t=e.XpG(4);e.R7$(1),e.xc7("background-color",t.changedEvent.tag.color),e.R7$(2),e.JRh(t.changedEvent.tag.name)}}function I(a,d){if(1&a&&e.DNE(0,A,4,3,"div",38),2&a){const t=e.XpG(3);e.Y8G("ngIf",t.changedEvent.tag)}}function G(a,d){if(1&a&&(e.j41(0,"div",39),e.nrm(1,"div",40),e.j41(2,"div"),e.EFF(3),e.k0s()()),2&a){const t=d.$implicit;e.R7$(1),e.xc7("background-color",t.color),e.R7$(2),e.JRh(t.name)}}function R(a,d){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"div",18)(2,"div",19)(3,"label",20),e.EFF(4,"T\xedtulo"),e.k0s(),e.j41(5,"span",21),e.nrm(6,"i",22),e.j41(7,"input",23),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.title=i)}),e.k0s()()(),e.j41(8,"div",19)(9,"label",24),e.EFF(10,"Ubicaci\xf3n"),e.k0s(),e.j41(11,"span",21),e.nrm(12,"i",25),e.j41(13,"input",26),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.location=i)}),e.k0s()()(),e.j41(14,"div",27)(15,"label",28),e.EFF(16,"Descripci\xf3n del evento"),e.k0s(),e.j41(17,"textarea",29),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.description=i)}),e.k0s()(),e.j41(18,"div",19)(19,"label",30),e.EFF(20,"Fecha de Inicio"),e.k0s(),e.j41(21,"p-calendar",31),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.start=i)}),e.k0s()(),e.j41(22,"div",19)(23,"label",32),e.EFF(24,"Fecha Fin"),e.k0s(),e.j41(25,"p-calendar",33),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.end=i)}),e.k0s()(),e.j41(26,"div",27)(27,"label",34),e.EFF(28,"Color"),e.k0s(),e.j41(29,"p-dropdown",35),e.bIt("ngModelChange",function(i){e.eBV(t);const o=e.XpG(2);return e.Njj(o.changedEvent.tag=i)}),e.DNE(30,I,1,1,"ng-template",36),e.DNE(31,G,4,3,"ng-template",37),e.k0s()()()()}if(2&a){const t=e.XpG(2),n=e.sdS(3);e.R7$(7),e.Y8G("ngModel",t.changedEvent.title),e.R7$(6),e.Y8G("ngModel",t.changedEvent.location),e.R7$(4),e.Y8G("rows",5)("ngModel",t.changedEvent.description),e.R7$(4),e.Y8G("appendTo",n)("maxDate",t.changedEvent.end)("showTime",!0)("required",!0)("ngModel",t.changedEvent.start),e.R7$(4),e.Y8G("appendTo",n)("minDate",t.changedEvent.start)("showTime",!0)("required",!0)("ngModel",t.changedEvent.end),e.R7$(4),e.Y8G("appendTo",n)("options",t.tags)("ngModel",t.changedEvent.tag)}}function w(a,d){if(1&a&&(e.DNE(0,S,33,9,"div",8),e.DNE(1,R,32,17,"div",8)),2&a){const t=e.XpG();e.Y8G("ngIf","display"===t.view),e.R7$(1),e.Y8G("ngIf","display"!==t.view)}}function $(a,d){}const N=function(){return{width:"36rem"}},O=function(){return{"960px":"75vw","640px":"90vw"}};let J=(()=>{class a{constructor(t,n){this.eventService=t,this.helpersService=n,this.events=[],this.today="",this.calendarOptions={initialView:"dayGridMonth"},this.showDialog=!1,this.clickedEvent=null,this.dateClicked=!1,this.edit=!1,this.tags=[],this.view="",this.courseStyles={}}ngOnInit(){this.today=(new Date).toISOString().split("T")[0];const t={alumno_id:this.helpersService.getAlumnoId()??1,domain_id:this.helpersService.getDominioId()};this.eventService.getEventsAlumno(t).subscribe(n=>{this.events=this.getEventsAlumno(n),this.calendarOptions={...this.calendarOptions,events:this.events},this.tags=this.events.map(i=>{if(!this.tags.includes(i.tag))return i.tag})}),this.calendarOptions={plugins:[M.A,F.A,j.Ay],height:720,initialDate:this.today,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:n=>this.onEventClick(n),select:n=>this.onDateSelect(n),events:this.events}}getEventsAlumno(t){const n=t.map(i=>{const o=JSON.parse(i.horarios);return this.generateEventDetails(o,i.nombre)});return console.log(n.flat()),n.flat()}generateEventDetails(t,n){console.log("Nombre del curso:",n);const i=[],o=this.getCourseStyles(n);return t.forEach(s=>{const y=new Date(`${s.fecha_inicio}T${s.hora_inicio}`),U=new Date(`${s.fecha_fin}T${s.hora_fin}`),b=s.day_id;i.push({day_name:this.getDayName(b),date:this.addDays(y,b).toISOString().split("T")[0],start:y,end:U,tag:{color:o.backgroundColor,name:n},title:n,borderColor:o.borderColor,backgroundColor:o.backgroundColor,textColor:o.textColor,extendedProps:{docente:s.docente_name,aulaUbicacion:s.aula_ubication,aulaName:s.aula_name}})}),i}getCourseStyles(t){if(this.courseStyles[t])return this.courseStyles[t];const n=this.generateStyles();return this.courseStyles[t]=n,n}getDayName(t){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t%7]}addDays(t,n){const i=new Date(t);return i.setDate(i.getDate()+n),i}generateStyles(){const n=["#f9e79f","#a3e4d7","#abebc6","#f5b041","#ec7063","#cacfd2"],i=["#000000"],o=n[Math.floor(Math.random()*n.length)];return{backgroundColor:o,borderColor:o,textColor:i[Math.floor(Math.random()*i.length)]}}onEventClick(t){this.clickedEvent=t.event;let n=t.event.toPlainObject({collapseExtendedProps:!0,collapseColor:!0});this.view="display",this.showDialog=!0,console.log(n),this.changedEvent={...n,...this.clickedEvent},this.changedEvent.start=this.clickedEvent.start,this.changedEvent.end=this.clickedEvent.end?this.clickedEvent.end:this.clickedEvent.start}onDateSelect(t){}handleSave(){this.validate()&&(this.showDialog=!1,this.clickedEvent={...this.changedEvent,backgroundColor:this.changedEvent.tag.color,borderColor:this.changedEvent.tag.color,textColor:"#212121"},this.events=this.clickedEvent.hasOwnProperty("id")?this.events.map(t=>t.id.toString()===this.clickedEvent.id.toString()?t=this.clickedEvent:t):[...this.events,{...this.clickedEvent,id:Math.floor(1e4*Math.random())}],this.calendarOptions={...this.calendarOptions,events:this.events},this.clickedEvent=null)}onEditClick(){this.view="edit"}delete(){this.events=this.events.filter(t=>t.id.toString()!==this.clickedEvent.id.toString()),this.calendarOptions={...this.calendarOptions,events:this.events},this.showDialog=!1}validate(){let{start:t,end:n}=this.changedEvent;return t&&n}static#e=this.\u0275fac=function(n){return new(n||a)(e.rXU(g.U),e.rXU(k.V))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ng-component"]],decls:7,vars:9,consts:[[1,"card"],[3,"options"],[3,"visible","breakpoints","modal","closable","visibleChange","onHide"],["dd",""],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"text-900","font-semibold","text-xl"],[4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"text-900","font-semibold","mb-2"],[1,"flex","align-items-center","m-0"],[1,"pi","pi-fw","pi-clock","text-700","mr-2"],[1,"flex","align","-items-center","m-0"],[1,"pi","pi-fw","pi-user","text-700","mr-2"],[1,"flex","flex-column","m-0"],[1,"pi","pi-fw","pi-map-marker","text-700","mr-2"],[1,"grid","p-fluid","formgrid"],[1,"col-12","md:col-6","field"],["for","title",1,"text-900","font-semibold"],[1,"p-input-icon-left"],[1,"pi","pi-pencil"],["id","title","type","text","pInputText","","placeholder","T\xedtulo",3,"ngModel","ngModelChange"],["for","location",1,"text-900","font-semibold"],[1,"pi","pi-map-marker"],["id","location","type","text","pInputText","","placeholder","Ubicaci\xf3n",3,"ngModel","ngModelChange"],[1,"col-12","field"],["for","description",1,"text-900","font-semibold"],["id","description","type","text","pInputTextarea","",2,"resize","none",3,"rows","ngModel","ngModelChange"],["for","start",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","start",3,"appendTo","maxDate","showTime","required","ngModel","ngModelChange"],["for","end",1,"text-900","font-semibold"],["dateFormat","dd-mm-yy","inputId","end",3,"appendTo","minDate","showTime","required","ngModel","ngModelChange"],["for","company-color",1,"text-900","font-semibold"],["inputId","company-color","optionLabel","name",3,"appendTo","options","ngModel","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex-shrink-0","w-1rem","h-1rem","mr-2","border-circle"]],template:function(n,i){1&n&&(e.j41(0,"div",0),e.nrm(1,"full-calendar",1),e.j41(2,"p-dialog",2,3),e.bIt("visibleChange",function(s){return i.showDialog=s})("onHide",function(){return i.view=""}),e.DNE(4,D,2,1,"ng-template",4),e.DNE(5,w,2,2,"ng-template",5),e.DNE(6,$,0,0,"ng-template",6),e.k0s()()),2&n&&(e.R7$(1),e.Y8G("options",i.calendarOptions),e.R7$(1),e.Aen(e.lJ4(7,N)),e.Y8G("visible",i.showDialog)("breakpoints",e.lJ4(8,O))("modal",!0)("closable",!0))},dependencies:[p.bT,r.me,r.BC,r.YS,r.vS,m.x,v.l,T.Ei,u.Z,f.Vv,C.S,E.ms],styles:["@media screen and (max-width: 768px){[_nghost-%COMP%]     .fc .fc-toolbar{justify-content:center}[_nghost-%COMP%]     .fc-header-toolbar{display:flex;align-items:center;gap:1rem;justify-content:center;text-align:center;flex-wrap:wrap}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(2){width:100%;order:0}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(1){order:1}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3){order:2}[_nghost-%COMP%]     .fc-header-toolbar .fc-toolbar-chunk:nth-child(3) .fc-button-group .fc-today-button{margin-left:2rem}}"]})}return a})(),X=(()=>{class a{static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275mod=e.$C({type:a});static#n=this.\u0275inj=e.G2t({imports:[h.iI.forChild([{path:"",component:J}]),h.iI]})}return a})();var Y=l(1141),P=l(563),V=l(9998);let B=(()=>{class a{static#e=this.\u0275fac=function(n){return new(n||a)};static#t=this.\u0275mod=e.$C({type:a});static#n=this.\u0275inj=e.G2t({providers:[g.U],imports:[p.MD,r.YN,X,m.E,v.P,u.f,Y.tm,f.rO,C.u,E.kr,V.MB,P.Z]})}return a})()}}]);