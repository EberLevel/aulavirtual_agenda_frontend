"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[3887],{3887:(S,v,n)=>{n.r(v),n.d(v,{BandejaUsuariosModule:()=>rt});var d=n(177),c=n(8763),g=n(950),r=n(9417),t=n(7019),D=n(7693),a=n(5779),h=n(9664),m=n(2100),_=n(4789),y=n(3587),T=n(1626);let C=(()=>{class i{constructor(e){this.http=e,this.baseUrl=`${y.c.API_BASE}`}getUsuarios(e){return this.http.get(null===e?`${this.baseUrl}usuarios/0`:`${this.baseUrl}usuarios/${e}`)}getUsuario(e){return console.log(e),this.http.get(`${this.baseUrl}usuario/${e}`)}saveUsuario(e){return this.http.post(`${this.baseUrl}usuarios`,e)}deleteUsuario(e){return this.http.delete(`${this.baseUrl}usuarios/${e}`)}static#t=this.\u0275fac=function(o){return new(o||i)(t.KVO(T.Qq))};static#e=this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var f=n(6554),F=n(8774),b=n(1141),U=n(2242),I=n(8150),j=n(5473);function R(i,p){1&i&&(t.j41(0,"span",3),t.EFF(1,"Registrar Usuarios"),t.k0s())}function w(i,p){if(1&i&&(t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",25),t.EFF(4,"Instituci\xf3n"),t.k0s(),t.nrm(5,"p-dropdown",26),t.k0s()()()),2&i){const e=t.XpG(2);t.R7$(5),t.Y8G("options",e.institutionsList)}}function B(i,p){if(1&i){const e=t.RV6();t.j41(0,"form",4),t.bIt("ngSubmit",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.saveUsuario())}),t.j41(1,"div",5)(2,"div",6)(3,"div",7)(4,"label",8),t.EFF(5,"Nombres"),t.k0s(),t.nrm(6,"input",9),t.k0s(),t.j41(7,"div",7)(8,"label",10),t.EFF(9,"Apellidos"),t.k0s(),t.nrm(10,"input",11),t.k0s()()(),t.j41(11,"div",5)(12,"div",6)(13,"div",7)(14,"label",12),t.EFF(15,"Email"),t.k0s(),t.nrm(16,"input",13),t.k0s(),t.j41(17,"div",7)(18,"label",14),t.EFF(19,"Contrase\xf1a"),t.k0s(),t.nrm(20,"input",15),t.k0s()()(),t.j41(21,"div",5)(22,"div",6)(23,"div",7)(24,"label",16),t.EFF(25,"DNI"),t.k0s(),t.nrm(26,"input",17),t.k0s(),t.j41(27,"div",7)(28,"label",18),t.EFF(29,"Rol"),t.k0s(),t.j41(30,"span",19),t.nrm(31,"p-dropdown",20),t.k0s()()()(),t.DNE(32,w,6,1,"div",21),t.j41(33,"div",22),t.nrm(34,"button",23),t.j41(35,"button",24),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.closeModal())}),t.k0s()()()}if(2&i){const e=t.XpG();t.Y8G("formGroup",e.userForm),t.R7$(31),t.Y8G("options",e.listciclos),t.R7$(1),t.Y8G("ngIf",e.isSuperAdmin)}}function N(i,p){1&i&&t.nrm(0,"ngx-spinner",27)}let x=(()=>{class i{constructor(e,o,s,l,u,at,lt,pt,dt,ut,mt,ct){this.layoutService=e,this.router=o,this.primengConfig=s,this.translate=l,this.ref=u,this.config=at,this.translateService=lt,this.commonService=pt,this.userServicio=dt,this.fb=ut,this.spinner=mt,this.helpersService=ct,this.contsylabus="",this.calendarOptions={initialView:"dayGridMonth",locale:g.A},this.loading=!1,this.dialogVisible=!1,this.visible=!1,this.isSuperAdmin=!1,this.institutionsList=[],this.selectedInstitution=null,this.dominioId=0,this.userForm=this.fb.group({name:["",r.k0.required],lastname:["",r.k0.required],email:["",r.k0.required],password:["",r.k0.required],dni:["",r.k0.required],rolId:["",r.k0.required],dominioId:null})}ngOnInit(){this.config.data&&this.userServicio.getUsuario(this.config.data.idUsuario).subscribe(e=>{this.userForm.patchValue({name:e.name,lastname:e.lastname,email:e.email,dni:e.dni,rolId:e.rol_id,dominioId:e.domain_id})},e=>{console.error("Error obteniendo usuario",e)}),this.isSuperAdmin=this.helpersService.isSuperAdmin(),this.listciclos=[],this.dominioId=this.helpersService.getDominioId(),this.listcarrera=[{name:"DNI",value:1,code:"NY"},{name:"PASAPORTE",value:2,code:"RM"}],this.listareaformativa=[{name:"\xc1rea de formaci\xf3n 1",value:1,code:"NY"},{name:"\xc1rea de formaci\xf3n 2",value:2,code:"RM"},{name:"\xc1rea de formaci\xf3n 3",value:2,code:"RM"}],this.lsitadocente=[{name:"Docente 1",value:1,code:"NY"},{name:"Docente 2",value:2,code:"RM"},{name:"Docente 3",value:2,code:"RM"}],this.translate?this.translateChange("es"):console.error("TranslateService is not initialized."),this.getRolesDropdown(),this.isSuperAdmin&&this.getInstitutionsDropdown()}cambiarIdioma(){this.translateService.use("es")}getInstitutionsDropdown(){this.commonService.getInstitutionsDropdown().subscribe(e=>{this.institutionsList=e.map(o=>({name:o.name,value:o.domain_id}))},e=>{console.error("Error obteniendo instituciones",e)})}getRolesDropdown(){this.commonService.getRolesDropdown().subscribe(e=>{this.listciclos=e.map(o=>({name:o.nombre,value:o.id}))},e=>{console.error("Error obteniendo carreras",e)})}translateChange(e){this.translate?this.translate.use(e):console.error("TranslateService is not initialized.")}onDropdownChangetipoDni(e){console.log("Dropdown value changed:",e)}saveUsuario(){if(this.userForm.valid){const e=new FormData;e.append("name",this.userForm.get("name")?.value+" "+this.userForm.get("lastname")?.value),e.append("email",this.userForm.get("email")?.value),e.append("dni",this.userForm.get("dni")?.value),e.append("password",this.userForm.get("password")?.value),e.append("rol_id",this.userForm.get("rolId")?.value),e.append("lastname",this.userForm.get("lastname")?.value),e.append("domain_id",this.isSuperAdmin?this.userForm.get("dominioId")?.value:this.dominioId.toString()),this.config.data&&this.config.data.idUsuario&&e.append("id",this.config.data.idUsuario),this.spinner.show(),this.loading=!0,this.userServicio.saveUsuario(e).subscribe(o=>{this.spinner.hide(),this.loading=!1,this.helpersService.showSuccessMessage("Usuario registrado correctamente"),this.ref.close({register:!0})},o=>{this.spinner.hide(),this.loading=!1,console.error("Error registrando usuario",o.error),this.helpersService.showErrorMessage(o.error.message)})}}closeDialog(){this.visible=!1}closeModal(){this.ref.close({register:!1})}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(D.Y),t.rXU(c.Ix),t.rXU(a.r1),t.rXU(h.c$),t.rXU(m.Pw),t.rXU(m.sb),t.rXU(h.c$),t.rXU(_.h),t.rXU(C),t.rXU(r.ok),t.rXU(f.ex),t.rXU(F.V))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-registra-usuario"]],decls:4,vars:1,consts:[["pTemplate","header"],["pTemplate","content"],["bdColor","rgba(0,0,0,0.5)","size","large","color","white","type","ball-spin",4,"ngIf"],[1,"text-primary","font-semibold","text-xl"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"grid","p-fluid"],[1,"field","md:col-6"],["for","name"],["id","name","type","text","pInputText","","formControlName","name",1,"w-full"],["for","lastname"],["id","lastname","type","text","pInputText","","formControlName","lastname",1,"w-full"],["for","email"],["id","email","type","text","pInputText","","formControlName","email",1,"w-full"],["for","password"],["id","password","type","password","pInputText","","formControlName","password",1,"w-full"],["for","dni"],["id","dni","type","text","pInputText","","formControlName","dni",1,"w-full"],["for","rolId"],[1,"p-float-label"],["inputId","rolId","formControlName","rolId","optionLabel","name","optionValue","value","placeholder","Selecciona una Rol",3,"options"],["class","row",4,"ngIf"],[1,"row","mb-5","text-right"],["pButton","","label","Guardar","icon","pi pi-plus","type","submit"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["for","institucion"],["inputId","dominioId","formControlName","dominioId","optionLabel","name","optionValue","value","placeholder","Selecciona una opci\xf3n","appendTo","body",3,"options"],["bdColor","rgba(0,0,0,0.5)","size","large","color","white","type","ball-spin"]],template:function(o,s){1&o&&(t.j41(0,"p-panel"),t.DNE(1,R,2,0,"ng-template",0),t.DNE(2,B,36,3,"ng-template",1),t.DNE(3,N,1,0,"ngx-spinner",2),t.k0s()),2&o&&(t.R7$(3),t.Y8G("ngIf",s.loading))},dependencies:[d.bT,r.qT,r.me,r.BC,r.cb,b._f,a.Ei,U.S,I.ms,j.Z,r.j4,r.JD,f.et],styles:[".swal2-custom-class[_ngcontent-%COMP%]{z-index:9999!important}"]})}return i})();var E=n(9280);const $=["filter"],G=["dt1"];function X(i,p){1&i&&(t.j41(0,"span",2),t.EFF(1,"Buscar Usuarios"),t.k0s())}function k(i,p){if(1&i){const e=t.RV6();t.j41(0,"div",13)(1,"div",14)(2,"span",15)(3,"input",16,17),t.bIt("input",function(s){t.eBV(e),t.XpG();const l=t.sdS(4),u=t.XpG();return t.Njj(u.onGlobalFilter(l,s))}),t.k0s()()(),t.j41(5,"div",18)(6,"button",19),t.bIt("click",function(){t.eBV(e);const s=t.XpG(2);return t.Njj(s.navigateToNuevo())}),t.k0s()()()}}function M(i,p){1&i&&(t.j41(0,"tr")(1,"th",20)(2,"div",21),t.EFF(3," Nombres y Apellidos "),t.k0s()(),t.j41(4,"th",20)(5,"div",21),t.EFF(6," Email "),t.k0s()(),t.j41(7,"th",20)(8,"div",21),t.EFF(9," Cargo "),t.k0s()(),t.j41(10,"th",20)(11,"div",21),t.EFF(12," Configuraciones "),t.k0s()()())}function V(i,p){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td")(8,"button",22),t.bIt("click",function(){const l=t.eBV(e).$implicit,u=t.XpG(2);return t.Njj(u.navigateToEditar(l.id))}),t.k0s(),t.j41(9,"button",23),t.bIt("click",function(){const l=t.eBV(e).$implicit,u=t.XpG(2);return t.Njj(u.eliminar(l.id))}),t.k0s()()()}if(2&i){const e=p.$implicit;t.R7$(2),t.JRh(e.name),t.R7$(2),t.JRh(e.email),t.R7$(2),t.SpI("",e.nombre," ")}}function A(i,p){1&i&&(t.j41(0,"tr")(1,"td",24),t.EFF(2,"No se encontraron registros"),t.k0s()())}function O(i,p){1&i&&(t.j41(0,"tr")(1,"td",24),t.EFF(2,"Cargando registros. Por favor espere."),t.k0s()())}function P(i,p){1&i&&t.nrm(0,"ngx-spinner",25)}function Y(i,p){if(1&i&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),t.DNE(5,k,7,0,"ng-template",8),t.DNE(6,M,13,0,"ng-template",0),t.DNE(7,V,10,3,"ng-template",9),t.DNE(8,A,3,0,"ng-template",10),t.DNE(9,O,3,0,"ng-template",11),t.k0s()()()(),t.DNE(10,P,1,0,"ngx-spinner",12)),2&i){const e=t.XpG();t.R7$(3),t.Y8G("value",e.usuarios)("rows",10)("loading",e.loading)("rowHover",!0)("paginator",!0),t.R7$(7),t.Y8G("ngIf",e.loading)}}let L=(()=>{class i{constructor(e,o,s,l,u){this.router=e,this.dialogService=o,this.userServicio=s,this.helpersService=l,this.spinner=u,this.usuarios=[],this.loading=!1}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),this.cargaInicial()}eliminar(e){this.spinner.show(),this.loading=!0,this.userServicio.deleteUsuario(e).subscribe(o=>{this.helpersService.showSuccessMessage("Usuario eliminado correctamente"),this.loading=!1,this.spinner.hide(),this.cargaInicial()},o=>{this.helpersService.showErrorMessage("Error al eliminar el usuario"),this.loading=!1,this.spinner.hide(),console.log(o)})}cargaInicial(){this.loading=!0,this.userServicio.getUsuarios(this.domain_id).subscribe(e=>{this.usuarios=e,this.loading=!1},e=>{console.log(e),this.loading=!1})}navigateToNuevo(){this.ref=this.dialogService.open(x,{width:"60%",styleClass:"custom-dialog-header"}),this.ref.onClose.subscribe(e=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})}navigateToEditar(e){this.ref=this.dialogService.open(x,{width:"60%",styleClass:"custom-dialog-header",data:{idUsuario:e}}),this.ref.onClose.subscribe(o=>{this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.router.onSameUrlNavigation="reload"})}onGlobalFilter(e,o){e.filterGlobal(o.target.value,"contains")}onRowSelect(e){console.log("Organo-colegaido-sect")}onRowUnselect(e){}static#t=this.\u0275fac=function(o){return new(o||i)(t.rXU(c.Ix),t.rXU(m.o3),t.rXU(C),t.rXU(F.V),t.rXU(f.ex))};static#e=this.\u0275cmp=t.VBU({type:i,selectors:[["app-bandeja-usuarios"]],viewQuery:function(o,s){if(1&o&&(t.GBs($,5),t.GBs(G,5)),2&o){let l;t.mGM(l=t.lsd())&&(s.filter=l.first),t.mGM(l=t.lsd())&&(s.tabledt1=l.first)}},decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["bdColor","rgba(0,0,0,0.5)","size","large","color","white","type","ball-spin",4,"ngIf"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar Usuario",1,"w-full",3,"input"],["filter",""],[1,"mb-2"],["pButton","","label","Nuevo","icon","pi pi-user-plus","id","btnNuevo",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],["scope","col",2,"min-width","10rem"],[1,"flex","justify-content-between","align-items-center"],["pButton","","icon","pi pi-user-edit","title","Editar",1,"p-button-rounded","p-button-text","p-button-action",3,"click"],["pButton","","icon","pi pi-trash","title","Eliminar",1,"p-button-rounded","p-button-text","p-button-action",3,"click"],["colspan","8"],["bdColor","rgba(0,0,0,0.5)","size","large","color","white","type","ball-spin"]],template:function(o,s){1&o&&(t.j41(0,"p-panel"),t.DNE(1,X,2,0,"ng-template",0),t.DNE(2,Y,11,6,"ng-template",1),t.k0s())},dependencies:[d.bT,b._f,a.Ei,E.XI,U.S,j.Z,f.et]})}return i})(),z=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.$C({type:i});static#i=this.\u0275inj=t.G2t({imports:[c.iI.forChild([{path:"",component:L}]),c.iI]})}return i})();var K=n(612),Q=n(4714),H=n(9266),J=n(1305),W=n(3973),Z=n(563),q=n(6296),tt=n(1579),et=n(8542),it=n(320),ot=n(9998),nt=n(7835),st=n(4799);let rt=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.$C({type:i});static#i=this.\u0275inj=t.G2t({providers:[m.o3,m.Pw],imports:[d.MD,z,r.YN,K.rO,E.bG,Q.wZ,b.tm,H.SW,U.u,J.f,W.d0,Z.Z,q.iV,I.kr,j.b,tt.d,ot.MB,nt.H,it.e,et.S,st.F,m.k_,h.h,r.X1,f.PO]})}return i})()},4789:(S,v,n)=>{n.d(v,{h:()=>r});var d=n(1626),c=n(3587),g=n(7019);let r=(()=>{class t{constructor(a,h,m){this.http=a,this.httpClientFormData=h,this.handler=m,this.baseUrl=`${c.c.API_BASE}`,this.urlparametro=`${c.c.API_BASE}`,this.httpOptions={headers:new d.Lr({"Content-Type":"application/json"})},this.httpClientFormData=new d.Qq(this.handler)}getCarrerasDropdown(a){return this.http.get(`${this.baseUrl}carreras-dropdown/${a}`)}getCarrerasDropdownByPlanDeEstudio(a){return this.http.get(`${this.baseUrl}carreras-dropdown/${a}`)}getCiclosDropdown(a){return this.http.get(`${this.baseUrl}ciclos-dropdown/${a}`)}getRolesDropdown(){return this.http.get(`${this.baseUrl}roles-dropdown`)}getDocentesDropdown(a){return this.http.get(`${this.baseUrl}docentes-dropdown/${a}`)}getInstitutionsDropdown(){return this.http.get(`${this.baseUrl}institutions-dropdown`)}static#t=this.\u0275fac=function(h){return new(h||t)(g.KVO(d.Qq),g.KVO(d.Qq),g.KVO(d.JV))};static#e=this.\u0275prov=g.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()}}]);