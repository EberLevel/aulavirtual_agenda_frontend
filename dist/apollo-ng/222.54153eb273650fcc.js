"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[222],{222:(M,F,s)=>{s.d(F,{r:()=>Y});var m=s(8763),x=s(8032),u=s.n(x),c=s(9417),t=s(7019),p=s(2100),I=s(3587),C=s(1626);let g=(()=>{class e{constructor(i){this.http=i,this.baseUrl=`${I.c.API_BASE}`}getInstituciones(i){return this.http.get(`${this.baseUrl}instituciones?domain_id=${i}`)}guardarInstitucion(i){return this.http.post(`${this.baseUrl}instituciones`,i)}actualizarInstitucion(i,n){return this.http.put(`${this.baseUrl}instituciones/${i}`,n)}eliminarInstitucion(i){return this.http.delete(`${this.baseUrl}instituciones/${i}`)}static#t=this.\u0275fac=function(n){return new(n||e)(t.KVO(C.Qq))};static#i=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var f=s(8774),j=s(177),_=s(5473),h=s(5779),b=s(1141),v=s(2242);function E(e,r){if(1&e&&(t.j41(0,"span",2),t.EFF(1),t.k0s()),2&e){const i=t.XpG();t.R7$(1),t.SpI(" ","add"===i.acciones?"Agregar Instituci\xf3n":"ver"===i.acciones?"Ver Instituci\xf3n":"Editar Instituci\xf3n"," ")}}function k(e,r){1&e&&(t.j41(0,"small",23),t.EFF(1,"El nombre es obligatorio"),t.k0s())}function T(e,r){1&e&&(t.j41(0,"small",23),t.EFF(1,"El c\xf3digo es obligatorio"),t.k0s())}function R(e,r){1&e&&(t.j41(0,"small",23),t.EFF(1,"La direcci\xf3n es obligatoria"),t.k0s())}function y(e,r){1&e&&(t.j41(0,"small",23),t.EFF(1," Las siglas son obligatorias "),t.k0s())}function N(e,r){1&e&&t.nrm(0,"button",24)}function $(e,r){1&e&&t.nrm(0,"button",25)}function L(e,r){if(1&e){const i=t.RV6();t.j41(0,"form",3),t.bIt("ngSubmit",function(){t.eBV(i);const o=t.XpG();return t.Njj(o.guardarInstitucion())}),t.j41(1,"div",4)(2,"div",5)(3,"div",6)(4,"span",7),t.nrm(5,"input",8),t.j41(6,"label",9),t.EFF(7,"Nombre"),t.k0s()(),t.DNE(8,k,2,0,"small",10),t.k0s()()(),t.j41(9,"div",4)(10,"div",5)(11,"div",11)(12,"span",7),t.nrm(13,"input",12),t.j41(14,"label",9),t.EFF(15,"C\xf3digo"),t.k0s()(),t.DNE(16,T,2,0,"small",10),t.k0s(),t.j41(17,"div",11)(18,"span",7),t.nrm(19,"input",13),t.j41(20,"label"),t.EFF(21,"Nivel"),t.k0s()()()()(),t.j41(22,"div",4)(23,"div",5)(24,"div",11)(25,"span",7),t.nrm(26,"input",14),t.j41(27,"label",9),t.EFF(28,"Direcci\xf3n"),t.k0s()(),t.DNE(29,R,2,0,"small",10),t.k0s(),t.j41(30,"div",11)(31,"span",7),t.nrm(32,"input",15),t.j41(33,"label"),t.EFF(34,"Tel\xe9fono"),t.k0s()()()()(),t.j41(35,"div",4)(36,"div",5)(37,"div",11)(38,"span",7),t.nrm(39,"input",16),t.j41(40,"label",9),t.EFF(41,"Siglas"),t.k0s()(),t.DNE(42,y,2,0,"small",10),t.k0s(),t.j41(43,"div",11)(44,"span",7),t.nrm(45,"input",17),t.j41(46,"label"),t.EFF(47,"Ubigeo"),t.k0s()()()()(),t.j41(48,"div",4)(49,"div",18)(50,"div",19),t.DNE(51,N,1,0,"button",20),t.DNE(52,$,1,0,"button",21),t.j41(53,"button",22),t.bIt("click",function(o){t.eBV(i);const a=t.XpG();return t.Njj(a.closeModal(o))}),t.k0s()()()()()}if(2&e){const i=t.XpG();let n,o,a,l;t.Y8G("formGroup",i.institucionForm),t.R7$(5),t.Y8G("disabled","ver"===i.acciones),t.R7$(3),t.Y8G("ngIf",(null==(n=i.institucionForm.get("nombre"))?null:n.invalid)&&(null==(n=i.institucionForm.get("nombre"))?null:n.touched)),t.R7$(5),t.Y8G("disabled","ver"===i.acciones),t.R7$(3),t.Y8G("ngIf",(null==(o=i.institucionForm.get("codigo"))?null:o.invalid)&&(null==(o=i.institucionForm.get("codigo"))?null:o.touched)),t.R7$(3),t.Y8G("disabled","ver"===i.acciones),t.R7$(7),t.Y8G("disabled","ver"===i.acciones),t.R7$(3),t.Y8G("ngIf",(null==(a=i.institucionForm.get("direccion"))?null:a.invalid)&&(null==(a=i.institucionForm.get("direccion"))?null:a.touched)),t.R7$(3),t.Y8G("disabled","ver"===i.acciones),t.R7$(7),t.Y8G("disabled","ver"===i.acciones),t.R7$(3),t.Y8G("ngIf",(null==(l=i.institucionForm.get("siglas"))?null:l.invalid)&&(null==(l=i.institucionForm.get("siglas"))?null:l.touched)),t.R7$(3),t.Y8G("disabled","ver"===i.acciones),t.R7$(6),t.Y8G("ngIf","add"===i.acciones),t.R7$(1),t.Y8G("ngIf","actualizar"===i.acciones)}}let d=(()=>{class e{constructor(i,n,o,a,l){this.fb=i,this.ref=n,this.config=o,this.institucionService=a,this.helpersService=l,this.acciones=this.config.data.acciones,this.institucionForm=this.fb.group({codigo:["",c.k0.required],nivel:[""],nombre:["",c.k0.required],direccion:["",c.k0.required],siglas:["",c.k0.required],ubigeo:[""],telefono:[""],domain_id:[""]})}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),("ver"===this.acciones||"actualizar"===this.acciones)&&this.institucionForm.patchValue({codigo:this.config.data.data.codigo,nombre:this.config.data.data.nombre,nivel:this.config.data.data.nivel,siglas:this.config.data.data.siglas,direccion:this.config.data.data.direccion,telefono:this.config.data.data.telefono,ubigeo:this.config.data.data.ubigeo})}guardarInstitucion(){if(this.institucionForm.valid){const i={...this.institucionForm.value,domain_id:this.domain_id};"actualizar"===this.acciones?this.institucionService.actualizarInstitucion(this.config.data.data.id,i).subscribe(o=>{this.ref?.close(),u().fire({title:"\xa1\xc9xito!",text:"Los Datos se actualizaron correctamente",icon:"success",confirmButtonText:"Aceptar"})},o=>{console.error("Error al actualizar la instituci\xf3n",o)}):this.institucionService.guardarInstitucion(i).subscribe(n=>{this.ref?.close(),u().fire({title:"\xa1\xc9xito!",text:"Los Datos se registraron correctamente",icon:"success",confirmButtonText:"Aceptar"})},n=>{console.error("Error al guardar la instituci\xf3n",n)})}else console.error("Formulario inv\xe1lido")}closeModal(i){i.preventDefault(),this.ref?.close()}static#t=this.\u0275fac=function(n){return new(n||e)(t.rXU(c.ok),t.rXU(p.Pw),t.rXU(p.sb),t.rXU(g),t.rXU(f.V))};static#i=this.\u0275cmp=t.VBU({type:e,selectors:[["app-registra-usuario"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12"],[1,"p-float-label"],["type","text","pInputText","","formControlName","nombre",3,"disabled"],[1,"required"],["class","p-error",4,"ngIf"],[1,"field","col-6"],["type","text","pInputText","","formControlName","codigo",3,"disabled"],["type","text","pInputText","","formControlName","nivel",3,"disabled"],["type","text","pInputText","","formControlName","direccion",3,"disabled"],["type","text","pInputText","","formControlName","telefono",3,"disabled"],["type","text","pInputText","","formControlName","siglas",3,"disabled"],["type","text","pInputText","","formControlName","ubigeo",3,"disabled"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","class","p-button-success p-button-sm","type","submit",4,"ngIf"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","class","p-button-warning p-button-sm","type","submit",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],[1,"p-error"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","type","submit",1,"p-button-success","p-button-sm"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","type","submit",1,"p-button-warning","p-button-sm"]],template:function(n,o){1&n&&(t.j41(0,"p-panel"),t.DNE(1,E,2,1,"ng-template",0),t.DNE(2,L,54,14,"ng-template",1),t.k0s())},dependencies:[j.bT,_.Z,h.Ei,c.qT,c.me,c.BC,c.cb,b._f,c.j4,c.JD,v.S],styles:[".swal2-custom-class[_ngcontent-%COMP%]{z-index:9999!important}"]})}return e})();var G=s(9280);function D(e,r){1&e&&(t.j41(0,"span",2),t.EFF(1,"Listado de Instituciones"),t.k0s())}function U(e,r){if(1&e){const i=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"span",14)(3,"input",15,16),t.bIt("input",function(o){t.eBV(i);const a=t.XpG(2);return t.Njj(a.onGlobalFilter(o))}),t.k0s()()(),t.j41(5,"div",17)(6,"button",18),t.bIt("click",function(){t.eBV(i);const o=t.XpG(2);return t.Njj(o.navigateAddInstitucion())}),t.k0s()()()}}function B(e,r){1&e&&(t.j41(0,"tr")(1,"th",19),t.EFF(2,"Acciones"),t.k0s(),t.j41(3,"th",19),t.EFF(4,"C\xf3digo"),t.k0s(),t.j41(5,"th",19),t.EFF(6,"Nivel"),t.k0s(),t.j41(7,"th",19),t.EFF(8,"Siglas"),t.k0s(),t.j41(9,"th",19),t.EFF(10,"Nombre"),t.k0s(),t.j41(11,"th",19),t.EFF(12,"Ubigeo"),t.k0s(),t.j41(13,"th",19),t.EFF(14,"Direcci\xf3n"),t.k0s(),t.j41(15,"th",19),t.EFF(16,"Tel\xe9fono"),t.k0s()())}function w(e,r){if(1&e){const i=t.RV6();t.j41(0,"tr")(1,"td")(2,"button",20),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG(2);return t.Njj(l.navigateToDetalle(a))}),t.k0s(),t.j41(3,"button",21),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG(2);return t.Njj(l.navigateToEdit(a))}),t.k0s(),t.j41(4,"button",22),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG(2);return t.Njj(l.navigateToDelete(a.id))}),t.k0s()(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s()()}if(2&e){const i=r.$implicit;t.R7$(6),t.JRh(i.codigo),t.R7$(2),t.JRh(i.nivel),t.R7$(2),t.JRh(i.siglas),t.R7$(2),t.JRh(i.nombre),t.R7$(2),t.JRh(i.ubigeo),t.R7$(2),t.JRh(i.direccion),t.R7$(2),t.JRh(i.telefono)}}function S(e,r){1&e&&(t.j41(0,"tr")(1,"td",23),t.EFF(2,"No se encontraron registros"),t.k0s()())}function V(e,r){1&e&&(t.j41(0,"tr")(1,"td",23),t.EFF(2,"Cargando registros. Por favor espere."),t.k0s()())}function X(e,r){if(1&e&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),t.DNE(5,U,7,0,"ng-template",8),t.DNE(6,B,17,0,"ng-template",0),t.DNE(7,w,19,7,"ng-template",9),t.DNE(8,S,3,0,"ng-template",10),t.DNE(9,V,3,0,"ng-template",11),t.k0s()()()()),2&e){const i=t.XpG();t.R7$(3),t.Y8G("value",i.institucionList)("rows",10)("loading",i.loading)("rowHover",!0)("paginator",!0)}}let P=(()=>{class e{constructor(i,n,o){this.dialogService=i,this.helpersService=n,this.institucionService=o,this.loading=!1,this.institucionList=[],this.originalInstitucionList=[]}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),this.listarInstituciones()}listarInstituciones(){this.loading=!0,this.institucionService.getInstituciones(this.domain_id).subscribe(i=>{console.log("Response:",i),Array.isArray(i)?(this.institucionList=i,this.originalInstitucionList=[...i]):console.error("La respuesta no tiene el formato esperado"),this.loading=!1},i=>{this.loading=!1,console.error("Error al obtener instituciones",i)})}navigateAddInstitucion(){this.ref=this.dialogService.open(d,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"add"}}),this.ref.onClose.subscribe(()=>{this.listarInstituciones()})}navigateToDetalle(i){this.ref=this.dialogService.open(d,{width:"80%",styleClass:"custom-dialog-header",data:{acciones:"ver",data:i}}),this.ref.onClose.subscribe(()=>{this.listarInstituciones()})}navigateToEdit(i){this.ref=this.dialogService.open(d,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"actualizar",data:i}}),this.ref.onClose.subscribe(()=>{this.listarInstituciones()})}navigateToDelete(i){u().fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminarlo"}).then(n=>{n.isConfirmed&&this.institucionService.eliminarInstitucion(i).subscribe(()=>{u().fire("Eliminado","El registro ha sido eliminado.","success"),this.listarInstituciones()},o=>{u().fire("Error","Hubo un problema al eliminar el registro.","error")})})}onGlobalFilter(i){const n=i.target.value.toLowerCase();this.institucionList=n?this.originalInstitucionList.filter(o=>o.nombre.toLowerCase().includes(n)):[...this.originalInstitucionList]}static#t=this.\u0275fac=function(n){return new(n||e)(t.rXU(p.o3),t.rXU(f.V),t.rXU(g))};static#i=this.\u0275cmp=t.VBU({type:e,selectors:[["app-lista-instituciones"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar Instituciones",1,"w-full",3,"input"],["filter",""],[1,"mb-2"],["pButton","","label","Nuevo","icon","pi pi-plus","id","btnNuevo",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],["scope","col",2,"min-width","10rem"],["pButton","","icon","pi pi-eye","title","Ver",1,"p-button-rounded","p-button-text","p-button-success",2,"width","70px","border-radius","30px",3,"click"],["pButton","","icon","pi pi-pencil","title","Editar",1,"p-button-rounded","p-button-text","p-button-warning",2,"width","70px","border-radius","30px",3,"click"],["pButton","","icon","pi pi-trash","title","Eliminar",1,"p-button-rounded","p-button-text","p-button-danger",2,"width","70px","border-radius","30px",3,"click"],["colspan","8"]],template:function(n,o){1&n&&(t.j41(0,"p-panel"),t.DNE(1,D,2,0,"ng-template",0),t.DNE(2,X,10,5,"ng-template",1),t.k0s())},dependencies:[_.Z,h.Ei,b._f,G.XI,v.S],styles:[".selects_content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}.selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%], .selects_content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid rgb(136,133,133);border-radius:10px;margin-top:.4rem;width:14.5rem;padding:.8rem 1rem;outline:none}"]})}return e})(),Y=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#i=this.\u0275mod=t.$C({type:e});static#e=this.\u0275inj=t.G2t({imports:[m.iI.forChild([{path:"",component:P}]),m.iI]})}return e})()}}]);