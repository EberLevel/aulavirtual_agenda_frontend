"use strict";(self.webpackChunkapollo_ng=self.webpackChunkapollo_ng||[]).push([[8356],{8356:(Q,C,i)=>{i.r(C),i.d(C,{AreaPromocionesModule:()=>q});var d=i(177),h=i(9998),e=i(9417),T=i(9280),b=i(1141),v=i(2242),D=i(3973),N=i(563),I=i(6296),R=i(8150),x=i(5473),y=i(612),O=i(1579),S=i(9266),$=i(4714),Y=i(320),k=i(7835),E=i(1305),A=i(8542),L=i(4799),X=i(8713),U=i(1142),V=i(6781),j=i(8763),w=i(8032),_=i.n(w),t=i(7019),P=i(2100),B=i(5046),G=i(8774);function n(a,f){1&a&&t.nrm(0,"button",14)}function p(a,f){1&a&&t.nrm(0,"button",15)}let o=(()=>{class a{constructor(s,r,c,u,F){this.fb=s,this.ref=r,this.config=c,this.promocionesService=u,this.helpersService=F,this.acciones="",this.parametroForm=this.fb.group({nombre:["",e.k0.required],descripcion:[""],fecha_inscripcion:["",e.k0.required]}),this.acciones=this.config.data.acciones}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),console.log(this.domain_id),"actualizar"===this.acciones&&this.parametroForm.patchValue({nombre:this.config.data.data.nombre_promocion,descripcion:this.config.data.data.descripcion,fecha_inscripcion:this.config.data.data.fecha_inscripcion})}guardarPromocion(){if(this.parametroForm.valid){const s=new Date(this.parametroForm.get("fecha_inscripcion")?.value).toISOString().split("T")[0],r={nombre_promocion:this.parametroForm.get("nombre")?.value,descripcion:this.parametroForm.get("descripcion")?.value,fecha_inscripcion:s,domain_id:this.domain_id};if(console.log("Datos que se enviar\xe1n al backend:",r),"actualizar"===this.acciones){const c=this.config.data.data.id;c?this.promocionesService.actualizarPromocion(r,c).subscribe(u=>{_().fire({title:"\xa1\xc9xito!",text:"Promoci\xf3n actualizada correctamente",icon:"success",confirmButtonText:"Aceptar"}),this.ref?.close()},u=>{console.error("Error al actualizar la promoci\xf3n",u),_().fire("Error","No se pudo actualizar la promoci\xf3n.","error")}):console.error("No se encontr\xf3 el id de la promoci\xf3n.")}else this.promocionesService.guardarPromocion(r).subscribe(c=>{_().fire({title:"\xa1\xc9xito!",text:"Promoci\xf3n guardada correctamente",icon:"success",confirmButtonText:"Aceptar"}),this.ref?.close()},c=>{console.error("Error al guardar la promoci\xf3n",c),_().fire("Error","No se pudo guardar la promoci\xf3n.","error")})}else console.error("Formulario inv\xe1lido")}closeModal(s){s.preventDefault(),this.ref?.close()}static#e=this.\u0275fac=function(r){return new(r||a)(t.rXU(e.ok),t.rXU(P.Pw),t.rXU(P.sb),t.rXU(B.C),t.rXU(G.V))};static#t=this.\u0275cmp=t.VBU({type:a,selectors:[["app-ae-area-promociones"]],decls:24,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"grid","p-fluid"],[1,"field","col-12"],[1,"p-float-label"],["type","text","pInputText","","formControlName","nombre"],[1,"required"],["pInputTextarea","","formControlName","descripcion"],["formControlName","fecha_inscripcion","dateFormat","yy-mm-dd"],[1,"flex","justify-content-end","flex-column","sm:flex-row"],[1,"flex","flex-wrap","gap-2"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","class","p-button-success p-button-sm","type","submit",4,"ngIf"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","class","p-button-warning p-button-sm","type","submit",4,"ngIf"],["pButton","","label","Cerrar","icon","pi pi-times","iconPos","right",1,"p-button-close-clean",3,"click"],["pButton","","icon","pi pi-plus","label","Guardar","iconPos","right","type","submit",1,"p-button-success","p-button-sm"],["pButton","","icon","pi pi-refresh","label","Actualizar","iconPos","right","type","submit",1,"p-button-warning","p-button-sm"]],template:function(r,c){1&r&&(t.j41(0,"form",0),t.bIt("ngSubmit",function(){return c.guardarPromocion()}),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),t.nrm(5,"input",5),t.j41(6,"label",6),t.EFF(7,"Nombre de la Promoci\xf3n"),t.k0s()()(),t.j41(8,"div",3)(9,"span",4),t.nrm(10,"textarea",7),t.j41(11,"label",6),t.EFF(12,"Descripci\xf3n"),t.k0s()()(),t.j41(13,"div",3)(14,"span",4),t.nrm(15,"p-calendar",8),t.j41(16,"label",6),t.EFF(17,"Fecha de Inscripci\xf3n"),t.k0s()()()()(),t.j41(18,"div",1)(19,"div",9)(20,"div",10),t.DNE(21,n,1,0,"button",11),t.DNE(22,p,1,0,"button",12),t.j41(23,"button",13),t.bIt("click",function(F){return c.closeModal(F)}),t.k0s()()()()()),2&r&&(t.Y8G("formGroup",c.parametroForm),t.R7$(21),t.Y8G("ngIf","add"===c.acciones),t.R7$(1),t.Y8G("ngIf","actualizar"===c.acciones))},dependencies:[d.bT,e.qT,e.me,e.BC,e.cb,y.Vv,b._f,v.S,E.Z,e.j4,e.JD]})}return a})();var m=i(5779);function l(a,f){1&a&&(t.j41(0,"span",2),t.EFF(1,"Listado de Promociones"),t.k0s())}function g(a,f){if(1&a){const s=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"span",14)(3,"input",15,16),t.bIt("input",function(c){t.eBV(s);const u=t.XpG(2);return t.Njj(u.onGlobalFilter(c))}),t.k0s()()(),t.j41(5,"div",17)(6,"button",18),t.bIt("click",function(){t.eBV(s);const c=t.XpG(2);return t.Njj(c.navigateAddPromocion())}),t.k0s()()()}}function M(a,f){1&a&&(t.j41(0,"tr")(1,"th",19),t.EFF(2,"Acciones"),t.k0s(),t.j41(3,"th",19),t.EFF(4,"Nombre"),t.k0s(),t.j41(5,"th",19),t.EFF(6,"Descripci\xf3n"),t.k0s(),t.j41(7,"th",19),t.EFF(8,"Fecha de Inscripci\xf3n"),t.k0s()())}function z(a,f){if(1&a){const s=t.RV6();t.j41(0,"tr")(1,"td")(2,"button",20),t.bIt("click",function(){const u=t.eBV(s).$implicit,F=t.XpG(2);return t.Njj(F.navigateToEdit(u))}),t.k0s()(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s()()}if(2&a){const s=f.$implicit;t.R7$(4),t.JRh(s.nombre_promocion),t.R7$(2),t.JRh(s.descripcion),t.R7$(2),t.JRh(s.fecha_inscripcion)}}function K(a,f){1&a&&(t.j41(0,"tr")(1,"td",21),t.EFF(2,"No se encontraron promociones"),t.k0s()())}function W(a,f){1&a&&(t.j41(0,"tr")(1,"td",21),t.EFF(2,"Cargando registros. Por favor espere."),t.k0s()())}function H(a,f){if(1&a&&(t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-table",6,7),t.DNE(5,g,7,0,"ng-template",8),t.DNE(6,M,9,0,"ng-template",0),t.DNE(7,z,9,3,"ng-template",9),t.DNE(8,K,3,0,"ng-template",10),t.DNE(9,W,3,0,"ng-template",11),t.k0s()()()()),2&a){const s=t.XpG();t.R7$(3),t.Y8G("value",s.promocionesList)("rows",10)("loading",s.loading)("rowHover",!0)("paginator",!0)}}let Z=(()=>{class a{constructor(s,r,c){this.dialogService=s,this.promocionesService=r,this.helpersService=c,this.loading=!1,this.promocionesList=[],this.originalPromocionesList=[]}ngOnInit(){this.domain_id=this.helpersService.getDominioId(),console.log(this.domain_id),this.domain_id?this.listarPromocionesPorDominio(this.domain_id):_().fire("Error","No se encontr\xf3 un dominio v\xe1lido.","error")}listarPromocionesPorDominio(s){this.loading=!0,this.promocionesService.getPromocionesByDomainId(s).subscribe(r=>{this.promocionesList=r.data,this.originalPromocionesList=[...r.data],this.loading=!1},r=>{this.loading=!1,_().fire("Error","Hubo un problema al cargar las promociones.","error")})}navigateAddPromocion(){this.ref=this.dialogService.open(o,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"add"}}),this.ref.onClose.subscribe(s=>{this.listarPromocionesPorDominio(this.domain_id)})}navigateToEdit(s){this.ref=this.dialogService.open(o,{width:"60%",styleClass:"custom-dialog-header",data:{acciones:"actualizar",data:s}}),this.ref.onClose.subscribe(r=>{this.listarPromocionesPorDominio(this.domain_id)})}onGlobalFilter(s){const r=s.target.value.toLowerCase();this.promocionesList=r?this.originalPromocionesList.filter(c=>c.nombre_promocion.toLowerCase().includes(r)):[...this.originalPromocionesList]}static#e=this.\u0275fac=function(r){return new(r||a)(t.rXU(P.o3),t.rXU(B.C),t.rXU(G.V))};static#t=this.\u0275cmp=t.VBU({type:a,selectors:[["app-area-promociones"]],decls:3,vars:0,consts:[["pTemplate","header"],["pTemplate","content"],[1,"text-primary","font-semibold","text-xl"],[1,"row","mb-4"],[1,"grid","p-fluid"],[1,"field","md:col-12"],["styleClass","p-datatable-gridlines","responsiveLayout","scroll",1,"custom-search-input",3,"value","rows","loading","rowHover","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex-grow-1","mb-2","mr-2"],[1,"p-input-icon-left","w-full"],["pInputText","","type","text","placeholder","Buscar promociones",1,"w-full",3,"input"],["filter",""],[1,"mb-2"],["pButton","","label","Nueva Promoci\xf3n","icon","pi pi-plus","id","btnNuevo",1,"p-button-primary","mr-2",2,"border-radius","30px",3,"click"],["scope","col",2,"min-width","10rem"],["pButton","","icon","pi pi-pencil","title","Editar",1,"p-button-rounded","p-button-text","p-button-warning",2,"width","70px","border-radius","30px",3,"click"],["colspan","4"]],template:function(r,c){1&r&&(t.j41(0,"p-panel"),t.DNE(1,l,2,0,"ng-template",0),t.DNE(2,H,10,5,"ng-template",1),t.k0s())},dependencies:[b._f,m.Ei,v.S,x.Z,T.XI]})}return a})(),J=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275mod=t.$C({type:a});static#n=this.\u0275inj=t.G2t({imports:[j.iI.forChild([{path:"",component:Z}]),j.iI]})}return a})(),q=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275mod=t.$C({type:a});static#n=this.\u0275inj=t.G2t({imports:[d.MD,J,e.YN,y.rO,$.wZ,b.tm,S.SW,v.u,E.f,D.d0,N.Z,I.iV,R.kr,x.b,O.d,Y.e,A.S,h.MB,T.bG,k.H,L.F,I.iV,E.f,v.u,X.P,U.sv,V.P,A.S,e.X1]})}return a})()},8713:(Q,C,i)=>{i.d(C,{L:()=>B,P:()=>G});var d=i(9969),h=i(177),e=i(7019),T=i(5779),b=i(5434),v=i(6018),D=i(563),N=i(4420);function I(n,p){1&n&&e.nrm(0,"PlusIcon",11),2&n&&(e.Y8G("styleClass","p-fieldset-toggler"),e.BMQ("data-pc-section","togglericon"))}function R(n,p){1&n&&e.eu8(0)}function x(n,p){if(1&n&&(e.j41(0,"span",12),e.DNE(1,R,1,0,"ng-container",6),e.k0s()),2&n){const o=e.XpG(3);e.BMQ("data-pc-section","togglericon"),e.R7$(1),e.Y8G("ngTemplateOutlet",o.expandIconTemplate)}}function y(n,p){if(1&n&&(e.qex(0),e.DNE(1,I,1,2,"PlusIcon",9),e.DNE(2,x,2,2,"span",10),e.bVm()),2&n){const o=e.XpG(2);e.R7$(1),e.Y8G("ngIf",!o.expandIconTemplate),e.R7$(1),e.Y8G("ngIf",o.expandIconTemplate)}}function O(n,p){1&n&&e.nrm(0,"MinusIcon",11),2&n&&(e.Y8G("styleClass","p-fieldset-toggler"),e.BMQ("aria-hidden",!0)("data-pc-section","togglericon"))}function S(n,p){1&n&&e.eu8(0)}function $(n,p){if(1&n&&(e.j41(0,"span",12),e.DNE(1,S,1,0,"ng-container",6),e.k0s()),2&n){const o=e.XpG(3);e.BMQ("data-pc-section","togglericon"),e.R7$(1),e.Y8G("ngTemplateOutlet",o.collapseIconTemplate)}}function Y(n,p){if(1&n&&(e.qex(0),e.DNE(1,O,1,3,"MinusIcon",9),e.DNE(2,$,2,2,"span",10),e.bVm()),2&n){const o=e.XpG(2);e.R7$(1),e.Y8G("ngIf",!o.collapseIconTemplate),e.R7$(1),e.Y8G("ngIf",o.collapseIconTemplate)}}function k(n,p){1&n&&e.eu8(0)}function E(n,p){if(1&n){const o=e.RV6();e.qex(0),e.j41(1,"a",7),e.bIt("click",function(l){e.eBV(o);const g=e.XpG();return e.Njj(g.toggle(l))})("keydown",function(l){e.eBV(o);const g=e.XpG();return e.Njj(g.onKeyDown(l))}),e.DNE(2,y,3,2,"ng-container",8),e.DNE(3,Y,3,2,"ng-container",8),e.DNE(4,k,1,0,"ng-container",6),e.k0s(),e.bVm()}if(2&n){const o=e.XpG(),m=e.sdS(4);e.R7$(1),e.BMQ("id",o.id+"_header")("aria-controls",o.id+"_content")("aria-expanded",!o.collapsed)("aria-label",o.buttonAriaLabel),e.R7$(1),e.Y8G("ngIf",o.collapsed),e.R7$(1),e.Y8G("ngIf",!o.collapsed),e.R7$(1),e.Y8G("ngTemplateOutlet",m)}}function A(n,p){1&n&&e.eu8(0)}function L(n,p){if(1&n&&(e.j41(0,"span",13),e.EFF(1),e.k0s(),e.SdG(2,1),e.DNE(3,A,1,0,"ng-container",6)),2&n){const o=e.XpG();e.BMQ("data-pc-section","legendtitle"),e.R7$(1),e.JRh(o.legend),e.R7$(2),e.Y8G("ngTemplateOutlet",o.headerTemplate)}}function X(n,p){1&n&&e.eu8(0)}const U=["*",[["p-header"]]],V=function(n,p){return{"p-fieldset p-component":!0,"p-fieldset-toggleable":n,"p-fieldset-expanded":p}},j=function(n){return{transitionParams:n,height:"0"}},w=function(n){return{value:"hidden",params:n}},_=function(n){return{transitionParams:n,height:"*"}},t=function(n){return{value:"visible",params:n}},P=["*","p-header"];let B=(()=>{class n{el;legend;toggleable;collapsed=!1;style;styleClass;transitionOptions="400ms cubic-bezier(0.86, 0, 0.07, 1)";collapsedChange=new e.bkB;onBeforeToggle=new e.bkB;onAfterToggle=new e.bkB;templates;get id(){return(0,N._Y)()}get buttonAriaLabel(){return this.legend}animating;headerTemplate;contentTemplate;collapseIconTemplate;expandIconTemplate;constructor(o){this.el=o}ngAfterContentInit(){this.templates.forEach(o=>{switch(o.getType()){case"header":this.headerTemplate=o.template;break;case"expandicon":this.expandIconTemplate=o.template;break;case"collapseicon":this.collapseIconTemplate=o.template;break;case"content":this.contentTemplate=o.template}})}toggle(o){if(this.animating)return!1;this.animating=!0,this.onBeforeToggle.emit({originalEvent:o,collapsed:this.collapsed}),this.collapsed?this.expand():this.collapse(),this.onAfterToggle.emit({originalEvent:o,collapsed:this.collapsed}),o.preventDefault()}onKeyDown(o){("Enter"===o.code||"Space"===o.code)&&(this.toggle(o),o.preventDefault())}expand(){this.collapsed=!1,this.collapsedChange.emit(this.collapsed)}collapse(){this.collapsed=!0,this.collapsedChange.emit(this.collapsed)}getBlockableElement(){return this.el.nativeElement.children[0]}onToggleDone(){this.animating=!1}static \u0275fac=function(m){return new(m||n)(e.rXU(e.aKT))};static \u0275cmp=e.VBU({type:n,selectors:[["p-fieldset"]],contentQueries:function(m,l,g){if(1&m&&e.wni(g,T.Ei,4),2&m){let M;e.mGM(M=e.lsd())&&(l.templates=M)}},hostAttrs:[1,"p-element"],inputs:{legend:"legend",toggleable:"toggleable",collapsed:"collapsed",style:"style",styleClass:"styleClass",transitionOptions:"transitionOptions"},outputs:{collapsedChange:"collapsedChange",onBeforeToggle:"onBeforeToggle",onAfterToggle:"onAfterToggle"},ngContentSelectors:P,decls:9,vars:28,consts:[[3,"ngClass","ngStyle"],[1,"p-fieldset-legend"],[4,"ngIf","ngIfElse"],["legendContent",""],["role","region",1,"p-toggleable-content"],[1,"p-fieldset-content"],[4,"ngTemplateOutlet"],["pRipple","","tabindex","0","role","button",3,"click","keydown"],[4,"ngIf"],[3,"styleClass",4,"ngIf"],["class","p-fieldset-toggler",4,"ngIf"],[3,"styleClass"],[1,"p-fieldset-toggler"],[1,"p-fieldset-legend-text"]],template:function(m,l){if(1&m&&(e.NAR(U),e.j41(0,"fieldset",0)(1,"legend",1),e.DNE(2,E,5,7,"ng-container",2),e.DNE(3,L,4,3,"ng-template",null,3,e.C5r),e.k0s(),e.j41(5,"div",4),e.bIt("@fieldsetContent.done",function(){return l.onToggleDone()}),e.j41(6,"div",5),e.SdG(7),e.DNE(8,X,1,0,"ng-container",6),e.k0s()()()),2&m){const g=e.sdS(4);e.HbH(l.styleClass),e.Y8G("ngClass",e.l_i(17,V,l.toggleable,!l.collapsed&&l.toggleable))("ngStyle",l.style),e.BMQ("id",l.id)("data-pc-name","fieldset")("data-pc-section","root"),e.R7$(1),e.BMQ("data-pc-section","legend"),e.R7$(1),e.Y8G("ngIf",l.toggleable)("ngIfElse",g),e.R7$(3),e.Y8G("@fieldsetContent",l.collapsed?e.eq3(22,w,e.eq3(20,j,l.transitionOptions)):e.eq3(26,t,e.eq3(24,_,l.animating?l.transitionOptions:"0ms"))),e.BMQ("id",l.id+"_content")("aria-labelledby",l.id+"_header")("aria-hidden",l.collapsed)("data-pc-section","toggleablecontent"),e.R7$(1),e.BMQ("data-pc-section","content"),e.R7$(2),e.Y8G("ngTemplateOutlet",l.contentTemplate)}},dependencies:function(){return[h.YU,h.bT,h.T3,h.B3,D.n,b.Q,v.c]},styles:["@layer primeng{.p-fieldset-legend>a,.p-fieldset-legend>span{display:flex;align-items:center;justify-content:center}.p-fieldset-toggleable .p-fieldset-legend a{cursor:pointer;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-fieldset-legend-text{line-height:1}.p-fieldset-toggleable.p-fieldset-expanded>.p-toggleable-content:not(.ng-animating){overflow:visible}.p-fieldset-toggleable .p-toggleable-content{overflow:hidden}}\n"],encapsulation:2,data:{animation:[(0,d.hZ)("fieldsetContent",[(0,d.wk)("hidden",(0,d.iF)({height:"0"})),(0,d.wk)("visible",(0,d.iF)({height:"*"})),(0,d.kY)("visible <=> hidden",[(0,d.i0)("{{transitionParams}}")]),(0,d.kY)("void => *",(0,d.i0)(0))])]},changeDetection:0})}return n})(),G=(()=>{class n{static \u0275fac=function(m){return new(m||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({imports:[h.MD,D.Z,b.Q,v.c,T.Gg]})}return n})()}}]);